!function(e){var h,O,c,o,a,p,f,m,g,y,b,r,n,x,t;function C(e,t){return r.call(e,t)}function s(e,t){var r,n,i,o,a,s,l,h,d,u,c=t&&t.split("/"),p=y.map,f=p&&p["*"]||{};if(e){for(t=(e=e.split("/")).length-1,y.nodeIdCompat&&x.test(e[t])&&(e[t]=e[t].replace(x,"")),"."===e[0].charAt(0)&&c&&(e=c.slice(0,c.length-1).concat(e)),h=0;h<e.length;h++)"."===(u=e[h])?(e.splice(h,1),--h):".."===u&&(0===h||1===h&&".."===e[2]||".."===e[h-1]||0<h&&(e.splice(h-1,2),h-=2));e=e.join("/")}if((c||f)&&p){for(h=(r=e.split("/")).length;0<h;--h){if(n=r.slice(0,h).join("/"),c)for(d=c.length;0<d;--d)if(i=p[c.slice(0,d).join("/")],i=i&&i[n]){o=i,a=h;break}if(o)break;!s&&f&&f[n]&&(s=f[n],l=h)}!o&&s&&(o=s,a=l),o&&(r.splice(0,a,o),e=r.join("/"))}return e}function v(t,r){return function(){var e=n.call(arguments,0);return"string"!=typeof e[0]&&1===e.length&&e.push(null),a.apply(c,e.concat([t,r]))}}function w(e){var t;if(C(g,e)&&(t=g[e],delete g[e],b[e]=!0,o.apply(c,t)),!C(m,e)&&!C(b,e))throw new Error("No "+e);return m[e]}function l(e){var t,r=e?e.indexOf("!"):-1;return-1<r&&(t=e.substring(0,r),e=e.substring(r+1,e.length)),[t,e]}function S(e){return e?l(e):[]}m={},g={},y={},b={},r=Object.prototype.hasOwnProperty,n=[].slice,x=/\.js$/,p=function(e,t){var r,n,i=l(e),o=i[0],t=t[1];return e=i[1],o&&(r=w(o=s(o,t))),o?e=r&&r.normalize?r.normalize(e,(n=t,function(e){return s(e,n)})):s(e,t):(o=(i=l(e=s(e,t)))[0],e=i[1],o&&(r=w(o))),{f:o?o+"!"+e:e,n:e,pr:o,p:r}},f={require:function(e){return v(e)},exports:function(e){var t=m[e];return void 0!==t?t:m[e]={}},module:function(e){return{id:e,uri:"",exports:m[e],config:(t=e,function(){return y&&y.config&&y.config[t]||{}})};var t}},o=function(e,t,r,n){var i,o,a,s,l,h=[],d=typeof r,u=S(n=n||e);if("undefined"==d||"function"==d){for(t=!t.length&&r.length?["require","exports","module"]:t,s=0;s<t.length;s+=1)if("require"===(o=(a=p(t[s],u)).f))h[s]=f.require(e);else if("exports"===o)h[s]=f.exports(e),l=!0;else if("module"===o)i=h[s]=f.module(e);else if(C(m,o)||C(g,o)||C(b,o))h[s]=w(o);else{if(!a.p)throw new Error(e+" missing "+o);a.p.load(a.n,v(n,!0),function(t){return function(e){m[t]=e}}(o),{}),h[s]=m[o]}d=r?r.apply(m[e],h):void 0,e&&(i&&i.exports!==c&&i.exports!==m[e]?m[e]=i.exports:d===c&&l||(m[e]=d))}else e&&(m[e]=r)},t=h=a=function(e,t,r,n,i){if("string"==typeof e)return f[e]?f[e](t):w(p(e,S(t)).f);if(!e.splice){if((y=e).deps&&a(y.deps,y.callback),!t)return;t.splice?(e=t,t=r,r=null):e=c}return t=t||function(){},"function"==typeof r&&(r=n,n=i),n?o(c,e,t,r):setTimeout(function(){o(c,e,t,r)},4),a},a.config=function(e){return a(e)},t._defined=m,(O=function(e,t,r){if("string"!=typeof e)throw new Error("See almond README: incorrect module build, no module name");t.splice||(r=t,t=[]),C(m,e)||C(g,e)||(g[e]=[e,t,r])}).amd={jQuery:!0},function(){var e=this,t=e._,a={},i=Array.prototype,r=Object.prototype,n=Function.prototype,o=i.push,s=i.slice,l=i.concat,u=r.toString,h=r.hasOwnProperty,d=i.forEach,c=i.map,p=i.reduce,f=i.reduceRight,m=i.filter,g=i.every,y=i.some,b=i.indexOf,x=i.lastIndexOf,r=Array.isArray,C=Object.keys,v=n.bind,w=function(e){return e instanceof w?e:this instanceof w?void(this._wrapped=e):new w(e)};"undefined"!=typeof exports?(exports="undefined"!=typeof module&&module.exports?module.exports=w:exports)._=w:e._=w,w.VERSION="1.6.0";var S=w.each=w.forEach=function(e,t,r){if(null==e)return e;if(d&&e.forEach===d)e.forEach(t,r);else if(e.length===+e.length){for(var n=0,i=e.length;n<i;n++)if(t.call(r,e[n],n,e)===a)return}else for(var o=w.keys(e),n=0,i=o.length;n<i;n++)if(t.call(r,e[o[n]],o[n],e)===a)return;return e};w.map=w.collect=function(e,n,i){var o=[];return null==e?o:c&&e.map===c?e.map(n,i):(S(e,function(e,t,r){o.push(n.call(i,e,t,r))}),o)};var E="Reduce of empty array with no initial value";w.reduce=w.foldl=w.inject=function(e,n,i,o){var a=2<arguments.length;if(null==e&&(e=[]),p&&e.reduce===p)return o&&(n=w.bind(n,o)),a?e.reduce(n,i):e.reduce(n);if(S(e,function(e,t,r){a?i=n.call(o,i,e,t,r):(i=e,a=!0)}),!a)throw new TypeError(E);return i},w.reduceRight=w.foldr=function(n,i,o,a){var s=2<arguments.length;if(null==n&&(n=[]),f&&n.reduceRight===f)return a&&(i=w.bind(i,a)),s?n.reduceRight(i,o):n.reduceRight(i);var l,h=n.length;if(h!==+h&&(l=w.keys(n),h=l.length),S(n,function(e,t,r){t=l?l[--h]:--h,s?o=i.call(a,o,n[t],t,r):(o=n[t],s=!0)}),!s)throw new TypeError(E);return o},w.find=w.detect=function(e,n,i){var o;return k(e,function(e,t,r){if(n.call(i,e,t,r))return o=e,!0}),o},w.filter=w.select=function(e,n,i){var o=[];return null==e?o:m&&e.filter===m?e.filter(n,i):(S(e,function(e,t,r){n.call(i,e,t,r)&&o.push(e)}),o)},w.reject=function(e,n,i){return w.filter(e,function(e,t,r){return!n.call(i,e,t,r)},i)},w.every=w.all=function(e,n,i){n=n||w.identity;var o=!0;return null==e?o:g&&e.every===g?e.every(n,i):(S(e,function(e,t,r){if(!(o=o&&n.call(i,e,t,r)))return a}),!!o)};var k=w.some=w.any=function(e,n,i){n=n||w.identity;var o=!1;return null==e?o:y&&e.some===y?e.some(n,i):(S(e,function(e,t,r){if(o=o||n.call(i,e,t,r))return a}),!!o)};w.contains=w.include=function(e,t){return null!=e&&(b&&e.indexOf===b?-1!=e.indexOf(t):k(e,function(e){return e===t}))},w.invoke=function(e,t){var r=s.call(arguments,2),n=w.isFunction(t);return w.map(e,function(e){return(n?t:e[t]).apply(e,r)})},w.pluck=function(e,t){return w.map(e,w.property(t))},w.where=function(e,t){return w.filter(e,w.matches(t))},w.findWhere=function(e,t){return w.find(e,w.matches(t))},w.max=function(e,n,i){if(!n&&w.isArray(e)&&e[0]===+e[0]&&e.length<65535)return Math.max.apply(Math,e);var o=-1/0,a=-1/0;return S(e,function(e,t,r){r=n?n.call(i,e,t,r):e;a<r&&(o=e,a=r)}),o},w.min=function(e,n,i){if(!n&&w.isArray(e)&&e[0]===+e[0]&&e.length<65535)return Math.min.apply(Math,e);var o=1/0,a=1/0;return S(e,function(e,t,r){r=n?n.call(i,e,t,r):e;r<a&&(o=e,a=r)}),o},w.shuffle=function(e){var t,r=0,n=[];return S(e,function(e){t=w.random(r++),n[r-1]=n[t],n[t]=e}),n},w.sample=function(e,t,r){return null==t||r?(e=e.length!==+e.length?w.values(e):e)[w.random(e.length-1)]:w.shuffle(e).slice(0,Math.max(0,t))};function T(e){return null==e?w.identity:w.isFunction(e)?e:w.property(e)}w.sortBy=function(e,n,i){return n=T(n),w.pluck(w.map(e,function(e,t,r){return{value:e,index:t,criteria:n.call(i,e,t,r)}}).sort(function(e,t){var r=e.criteria,n=t.criteria;if(r!==n){if(n<r||void 0===r)return 1;if(r<n||void 0===n)return-1}return e.index-t.index}),"value")};n=function(a){return function(r,n,i){var o={};return n=T(n),S(r,function(e,t){t=n.call(i,e,t,r);a(o,t,e)}),o}};w.groupBy=n(function(e,t,r){w.has(e,t)?e[t].push(r):e[t]=[r]}),w.indexBy=n(function(e,t,r){e[t]=r}),w.countBy=n(function(e,t){w.has(e,t)?e[t]++:e[t]=1}),w.sortedIndex=function(e,t,r,n){for(var i=(r=T(r)).call(n,t),o=0,a=e.length;o<a;){var s=o+a>>>1;r.call(n,e[s])<i?o=1+s:a=s}return o},w.toArray=function(e){return e?w.isArray(e)?s.call(e):e.length===+e.length?w.map(e,w.identity):w.values(e):[]},w.size=function(e){return null==e?0:(e.length===+e.length?e:w.keys(e)).length},w.first=w.head=w.take=function(e,t,r){if(null!=e)return null==t||r?e[0]:t<0?[]:s.call(e,0,t)},w.initial=function(e,t,r){return s.call(e,0,e.length-(null==t||r?1:t))},w.last=function(e,t,r){if(null!=e)return null==t||r?e[e.length-1]:s.call(e,Math.max(e.length-t,0))},w.rest=w.tail=w.drop=function(e,t,r){return s.call(e,null==t||r?1:t)},w.compact=function(e){return w.filter(e,w.identity)};var I=function(e,t,r){return t&&w.every(e,w.isArray)?l.apply(r,e):(S(e,function(e){w.isArray(e)||w.isArguments(e)?t?o.apply(r,e):I(e,t,r):r.push(e)}),r)};w.flatten=function(e,t){return I(e,t,[])},w.without=function(e){return w.difference(e,s.call(arguments,1))},w.partition=function(e,t){var r=[],n=[];return S(e,function(e){(t(e)?r:n).push(e)}),[r,n]},w.uniq=w.unique=function(r,n,e,t){w.isFunction(n)&&(t=e,e=n,n=!1);var t=e?w.map(r,e,t):r,i=[],o=[];return S(t,function(e,t){(n?t&&o[o.length-1]===e:w.contains(o,e))||(o.push(e),i.push(r[t]))}),i},w.union=function(){return w.uniq(w.flatten(arguments,!0))},w.intersection=function(e){var r=s.call(arguments,1);return w.filter(w.uniq(e),function(t){return w.every(r,function(e){return w.contains(e,t)})})},w.difference=function(e){var t=l.apply(i,s.call(arguments,1));return w.filter(e,function(e){return!w.contains(t,e)})},w.zip=function(){for(var e=w.max(w.pluck(arguments,"length").concat(0)),t=new Array(e),r=0;r<e;r++)t[r]=w.pluck(arguments,""+r);return t},w.object=function(e,t){if(null==e)return{};for(var r={},n=0,i=e.length;n<i;n++)t?r[e[n]]=t[n]:r[e[n][0]]=e[n][1];return r},w.indexOf=function(e,t,r){if(null==e)return-1;var n=0,i=e.length;if(r){if("number"!=typeof r)return e[n=w.sortedIndex(e,t)]===t?n:-1;n=r<0?Math.max(0,i+r):r}if(b&&e.indexOf===b)return e.indexOf(t,r);for(;n<i;n++)if(e[n]===t)return n;return-1},w.lastIndexOf=function(e,t,r){if(null==e)return-1;var n=null!=r;if(x&&e.lastIndexOf===x)return n?e.lastIndexOf(t,r):e.lastIndexOf(t);for(var i=n?r:e.length;i--;)if(e[i]===t)return i;return-1},w.range=function(e,t,r){arguments.length<=1&&(t=e||0,e=0),r=arguments[2]||1;for(var n=Math.max(Math.ceil((t-e)/r),0),i=0,o=new Array(n);i<n;)o[i++]=e,e+=r;return o};function A(){}w.bind=function(r,n){var i,o;if(v&&r.bind===v)return v.apply(r,s.call(arguments,1));if(!w.isFunction(r))throw new TypeError;return i=s.call(arguments,2),o=function(){if(!(this instanceof o))return r.apply(n,i.concat(s.call(arguments)));A.prototype=r.prototype;var e=new A;A.prototype=null;var t=r.apply(e,i.concat(s.call(arguments)));return Object(t)===t?t:e}},w.partial=function(i){var o=s.call(arguments,1);return function(){for(var e=0,t=o.slice(),r=0,n=t.length;r<n;r++)t[r]===w&&(t[r]=arguments[e++]);for(;e<arguments.length;)t.push(arguments[e++]);return i.apply(this,t)}},w.bindAll=function(t){var e=s.call(arguments,1);if(0===e.length)throw new Error("bindAll must be passed function names");return S(e,function(e){t[e]=w.bind(t[e],t)}),t},w.memoize=function(t,r){var n={};return r=r||w.identity,function(){var e=r.apply(this,arguments);return w.has(n,e)?n[e]:n[e]=t.apply(this,arguments)}},w.delay=function(e,t){var r=s.call(arguments,2);return setTimeout(function(){return e.apply(null,r)},t)},w.defer=function(e){return w.delay.apply(w,[e,1].concat(s.call(arguments,1)))},w.throttle=function(r,n,i){var o,a,s,l=null,h=0;i=i||{};function d(){h=!1===i.leading?0:w.now(),l=null,s=r.apply(o,a),o=a=null}return function(){var e=w.now();h||!1!==i.leading||(h=e);var t=n-(e-h);return o=this,a=arguments,t<=0?(clearTimeout(l),l=null,h=e,s=r.apply(o,a),o=a=null):l||!1===i.trailing||(l=setTimeout(d,t)),s}},w.debounce=function(t,r,n){var i,o,a,s,l,h=function(){var e=w.now()-s;e<r?i=setTimeout(h,r-e):(i=null,n||(l=t.apply(a,o),a=o=null))};return function(){a=this,o=arguments,s=w.now();var e=n&&!i;return i=i||setTimeout(h,r),e&&(l=t.apply(a,o),a=o=null),l}},w.once=function(e){var t,r=!1;return function(){return r||(r=!0,t=e.apply(this,arguments),e=null),t}},w.wrap=function(e,t){return w.partial(t,e)},w.compose=function(){var r=arguments;return function(){for(var e=arguments,t=r.length-1;0<=t;t--)e=[r[t].apply(this,e)];return e[0]}},w.after=function(e,t){return function(){if(--e<1)return t.apply(this,arguments)}},w.keys=function(e){if(!w.isObject(e))return[];if(C)return C(e);var t,r=[];for(t in e)w.has(e,t)&&r.push(t);return r},w.values=function(e){for(var t=w.keys(e),r=t.length,n=new Array(r),i=0;i<r;i++)n[i]=e[t[i]];return n},w.pairs=function(e){for(var t=w.keys(e),r=t.length,n=new Array(r),i=0;i<r;i++)n[i]=[t[i],e[t[i]]];return n},w.invert=function(e){for(var t={},r=w.keys(e),n=0,i=r.length;n<i;n++)t[e[r[n]]]=r[n];return t},w.functions=w.methods=function(e){var t,r=[];for(t in e)w.isFunction(e[t])&&r.push(t);return r.sort()},w.extend=function(r){return S(s.call(arguments,1),function(e){if(e)for(var t in e)r[t]=e[t]}),r},w.pick=function(t){var r={},e=l.apply(i,s.call(arguments,1));return S(e,function(e){e in t&&(r[e]=t[e])}),r},w.omit=function(e){var t,r={},n=l.apply(i,s.call(arguments,1));for(t in e)w.contains(n,t)||(r[t]=e[t]);return r},w.defaults=function(r){return S(s.call(arguments,1),function(e){if(e)for(var t in e)void 0===r[t]&&(r[t]=e[t])}),r},w.clone=function(e){return w.isObject(e)?w.isArray(e)?e.slice():w.extend({},e):e},w.tap=function(e,t){return t(e),e};var P=function(e,t,r,n){if(e===t)return 0!==e||1/e==1/t;if(null==e||null==t)return e===t;e instanceof w&&(e=e._wrapped),t instanceof w&&(t=t._wrapped);var i=u.call(e);if(i!=u.call(t))return!1;switch(i){case"[object String]":return e==String(t);case"[object Number]":return e!=+e?t!=+t:0==e?1/e==1/t:e==+t;case"[object Date]":case"[object Boolean]":return+e==+t;case"[object RegExp]":return e.source==t.source&&e.global==t.global&&e.multiline==t.multiline&&e.ignoreCase==t.ignoreCase}if("object"!=typeof e||"object"!=typeof t)return!1;for(var o=r.length;o--;)if(r[o]==e)return n[o]==t;var a=e.constructor,s=t.constructor;if(a!==s&&!(w.isFunction(a)&&a instanceof a&&w.isFunction(s)&&s instanceof s)&&"constructor"in e&&"constructor"in t)return!1;r.push(e),n.push(t);var l=0,h=!0;if("[object Array]"==i){if(h=(l=e.length)==t.length)for(;l--&&(h=P(e[l],t[l],r,n)););}else{for(var d in e)if(w.has(e,d)&&(l++,!(h=w.has(t,d)&&P(e[d],t[d],r,n))))break;if(h){for(d in t)if(w.has(t,d)&&!l--)break;h=!l}}return r.pop(),n.pop(),h};w.isEqual=function(e,t){return P(e,t,[],[])},w.isEmpty=function(e){if(null==e)return!0;if(w.isArray(e)||w.isString(e))return 0===e.length;for(var t in e)if(w.has(e,t))return!1;return!0},w.isElement=function(e){return!(!e||1!==e.nodeType)},w.isArray=r||function(e){return"[object Array]"==u.call(e)},w.isObject=function(e){return e===Object(e)},S(["Arguments","Function","String","Number","Date","RegExp"],function(t){w["is"+t]=function(e){return u.call(e)=="[object "+t+"]"}}),w.isArguments(arguments)||(w.isArguments=function(e){return!(!e||!w.has(e,"callee"))}),"function"!=typeof/./&&(w.isFunction=function(e){return"function"==typeof e}),w.isFinite=function(e){return isFinite(e)&&!isNaN(parseFloat(e))},w.isNaN=function(e){return w.isNumber(e)&&e!=+e},w.isBoolean=function(e){return!0===e||!1===e||"[object Boolean]"==u.call(e)},w.isNull=function(e){return null===e},w.isUndefined=function(e){return void 0===e},w.has=function(e,t){return h.call(e,t)},w.noConflict=function(){return e._=t,this},w.identity=function(e){return e},w.constant=function(e){return function(){return e}},w.property=function(t){return function(e){return e[t]}},w.matches=function(r){return function(e){if(e===r)return!0;for(var t in r)if(r[t]!==e[t])return!1;return!0}},w.times=function(e,t,r){for(var n=Array(Math.max(0,e)),i=0;i<e;i++)n[i]=t.call(r,i);return n},w.random=function(e,t){return null==t&&(t=e,e=0),e+Math.floor(Math.random()*(t-e+1))},w.now=Date.now||function(){return(new Date).getTime()};var F={escape:{"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#x27;"}};F.unescape=w.invert(F.escape);var R={escape:new RegExp("["+w.keys(F.escape).join("")+"]","g"),unescape:new RegExp("("+w.keys(F.unescape).join("|")+")","g")};w.each(["escape","unescape"],function(t){w[t]=function(e){return null==e?"":(""+e).replace(R[t],function(e){return F[t][e]})}}),w.result=function(e,t){if(null!=e){t=e[t];return w.isFunction(t)?t.call(e):t}},w.mixin=function(r){S(w.functions(r),function(e){var t=w[e]=r[e];w.prototype[e]=function(){var e=[this._wrapped];return o.apply(e,arguments),M.call(this,t.apply(w,e))}})};var D=0;w.uniqueId=function(e){var t=++D+"";return e?e+t:t},w.templateSettings={evaluate:/<%([\s\S]+?)%>/g,interpolate:/<%=([\s\S]+?)%>/g,escape:/<%-([\s\S]+?)%>/g};var L=/(.)^/,B={"'":"'","\\":"\\","\r":"r","\n":"n","\t":"t","\u2028":"u2028","\u2029":"u2029"},_=/\\|'|\r|\n|\t|\u2028|\u2029/g;w.template=function(o,e,t){var r;t=w.defaults({},t,w.templateSettings);var n=new RegExp([(t.escape||L).source,(t.interpolate||L).source,(t.evaluate||L).source].join("|")+"|$","g"),a=0,s="__p+='";o.replace(n,function(e,t,r,n,i){return s+=o.slice(a,i).replace(_,function(e){return"\\"+B[e]}),t&&(s+="'+\n((__t=("+t+"))==null?'':_.escape(__t))+\n'"),r&&(s+="'+\n((__t=("+r+"))==null?'':__t)+\n'"),n&&(s+="';\n"+n+"\n__p+='"),a=i+e.length,e}),s+="';\n",s="var __t,__p='',__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,'');};\n"+(s=!t.variable?"with(obj||{}){\n"+s+"}\n":s)+"return __p;\n";try{r=new Function(t.variable||"obj","_",s)}catch(e){throw e.source=s,e}if(e)return r(e,w);e=function(e){return r.call(this,e,w)};return e.source="function("+(t.variable||"obj")+"){\n"+s+"}",e},w.chain=function(e){return w(e).chain()};var M=function(e){return this._chain?w(e).chain():e};w.mixin(w),S(["pop","push","reverse","shift","sort","splice","unshift"],function(t){var r=i[t];w.prototype[t]=function(){var e=this._wrapped;return r.apply(e,arguments),"shift"!=t&&"splice"!=t||0!==e.length||delete e[0],M.call(this,e)}}),S(["concat","join","slice"],function(e){var t=i[e];w.prototype[e]=function(){return M.call(this,t.apply(this._wrapped,arguments))}}),w.extend(w.prototype,{chain:function(){return this._chain=!0,this},value:function(){return this._wrapped}}),O.amd&&O("underscore",[],function(){return w})}.call(this),O("Excel/XMLDOM",["underscore"],function(a){"use strict";function n(e,t){this.documentElement=this.createElement(t),this.documentElement.setAttribute("xmlns",e)}return a.extend(n.prototype,{createElement:function(e){return new n.XMLNode({nodeName:e})},createTextNode:function(e){return new n.TextNode(e)},toString:function(){return this.documentElement.toString()}}),(n.Node=function(){}).Create=function(e){switch(e.type){case"XML":return new n.XMLNode(e);case"TEXT":return new n.TextNode(e.nodeValue)}},n.TextNode=function(e){this.nodeValue=e},a.extend(n.TextNode.prototype,{toJSON:function(){return{nodeValue:this.nodeValue,type:"TEXT"}},toString:function(){return a.escape(this.nodeValue)}}),n.XMLNode=function(e){if(this.nodeName=e.nodeName,this.children=[],this.nodeValue=e.nodeValue||"",this.attributes={},e.children)for(var t=0;t<e.children.length;t++)this.appendChild(n.Node.Create(e.children[t]));if(e.attributes)for(var r in e.attributes)e.attributes.hasOwnProperty(r)&&this.setAttribute(r,e.attributes[r])},a.extend(n.XMLNode.prototype,{toString:function(){var e,t,r,n,i=this.nodeName,o="<"+i;for(e in this.attributes)this.attributes.hasOwnProperty(e)&&(o=o+" "+e+'="'+a.escape(this.attributes[e])+'"');for(n="",t=0,r=this.children.length;t<r;t++)n+=this.children[t].toString();return o+=n?">"+n+"</"+i+">":"/>"},toJSON:function(){for(var e=[],t=0,r=this.children.length;t<r;t++)e.push(this.children[t].toJSON());return{nodeName:this.nodeName,children:e,nodeValue:this.nodeValue,attributes:this.attributes,type:"XML"}},setAttribute:function(e,t){if(null===t)return delete this.attributes[e],void delete this[e];this.attributes[e]=t,this[e]=t},setAttributeNS:function(e,t,r){this.setAttribute(t,r)},appendChild:function(e){this.children.push(e),this.firstChild=this.children[0]},cloneNode:function(){return new n.XMLNode(this.toJSON())}}),n}),O("Excel/util",["./XMLDOM"],function(r){"use strict";return{_idSpaces:{},uniqueId:function(e){return this._idSpaces[e]||(this._idSpaces[e]=2),this._idSpaces[e]++},createXmlDoc:function(e,t){return new r(e||null,t,null)},createElement:function(e,t,r){for(var n=e.createElement(t),i=(r=r||[]).length;i--;)n.setAttribute(r[i][0],r[i][1]);return n},createElements:function(e,t){var r,n,i,o=t.name,a=t.attrs,s=t.childs,l=this.createElement(e,o,a);if(s&&(i=s.length))for(n=0;n<i;n++)r=this.createElements(e,s[n]),l.appendChild(r);return l},LETTER_REFS:{},positionToLetterRef:function(e,t){var r,n=1,i=e,o="";if(this.LETTER_REFS[e])return this.LETTER_REFS[e].concat(t);for(;0<i;)i-=Math.pow(26,n-1),i-=r=i%Math.pow(26,n),r/=Math.pow(26,n-1),o="ABCDEFGHIJKLMNOPQRSTUVWXYZ".charAt(r)+o,n+=1;return(this.LETTER_REFS[e]=o).concat(t)},schemas:{worksheet:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/worksheet",sharedStrings:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sharedStrings",stylesheet:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/styles",relationships:"http://schemas.openxmlformats.org/officeDocument/2006/relationships",relationshipPackage:"http://schemas.openxmlformats.org/package/2006/relationships",contentTypes:"http://schemas.openxmlformats.org/package/2006/content-types",spreadsheetml:"http://schemas.openxmlformats.org/spreadsheetml/2006/main",markupCompat:"http://schemas.openxmlformats.org/markup-compatibility/2006",x14ac:"http://schemas.microsoft.com/office/spreadsheetml/2009/9/ac",officeDocument:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/officeDocument",package:"http://schemas.openxmlformats.org/package/2006/relationships",table:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/table",spreadsheetDrawing:"http://schemas.openxmlformats.org/drawingml/2006/spreadsheetDrawing",drawing:"http://schemas.openxmlformats.org/drawingml/2006/main",drawingRelationship:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/drawing",image:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/image",chart:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/chart",hyperlink:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/hyperlink"}}}),O("Excel/Paths",{}),O("Excel/RelationshipManager",["underscore","./util","./Paths"],function(i,o,a){"use strict";function e(){this.relations={},this.lastId=1}return i.uniqueId("rId"),i.extend(e.prototype,{importData:function(e){this.relations=e.relations,this.lastId=e.lastId},exportData:function(){return{relations:this.relations,lastId:this.lastId}},addRelation:function(e,t){return this.relations[e.id]={id:i.uniqueId("rId"),schema:o.schemas[t]},this.relations[e.id].id},getRelationshipId:function(e){return this.relations[e.id]?this.relations[e.id].id:null},toXML:function(){var r=o.createXmlDoc(o.schemas.relationshipPackage,"Relationships"),n=r.documentElement;return i.each(this.relations,function(e,t){t=o.createElement(r,"Relationship",[["Id",e.id],["Type",e.schema],["Target",a[t]]]);void 0!==t.Target&&n.appendChild(t)}),r}}),e}),O("Excel/Drawings",["underscore","./RelationshipManager","./util"],function(e,t,o){"use strict";function r(){this.drawings=[],this.relations=new t,this.id=e.uniqueId("Drawings")}return e.extend(r.prototype,{addDrawing:function(e){this.drawings.push(e)},getCount:function(){return this.drawings.length},toXML:function(){var e=o.createXmlDoc(o.schemas.spreadsheetDrawing,"xdr:wsDr"),t=e.documentElement;t.setAttribute("xmlns:a",o.schemas.drawing),t.setAttribute("xmlns:r",o.schemas.relationships),t.setAttribute("xmlns:xdr",o.schemas.spreadsheetDrawing);for(var r=0,n=this.drawings.length;r<n;r++){var i=(i=this.relations.getRelationshipId(this.drawings[r].getMediaData()))||this.relations.addRelation(this.drawings[r].getMediaData(),this.drawings[r].getMediaType());this.drawings[r].setRelationshipId(i),t.appendChild(this.drawings[r].toXML(e))}return e}}),r}),O("Excel/Drawings/AbsoluteAnchor",["underscore","../util"],function(e,i){"use strict";function t(e){this.x=null,this.y=null,this.width=null,this.height=null,e&&(this.setPos(e.x,e.y),this.setDimensions(e.width,e.height))}return e.extend(t.prototype,{setPos:function(e,t){this.x=e,this.y=t},setDimensions:function(e,t){this.width=e,this.height=t},toXML:function(e,t){var r=i.createElement(e,"xdr:absoluteAnchor"),n=i.createElement(e,"xdr:pos");n.setAttribute("x",this.x),n.setAttribute("y",this.y),r.appendChild(n);n=i.createElement(e,"xdr:ext");return n.setAttribute("cx",this.width),n.setAttribute("cy",this.height),r.appendChild(n),r.appendChild(t),r.appendChild(i.createElement(e,"xdr:clientData")),r}}),t}),O("Excel/Drawings/Chart",["underscore","../util"],function(e){"use strict";function t(){}return e.extend(t.prototype,{}),t}),O("Excel/Drawings/OneCellAnchor",["underscore","../util"],function(e,l){"use strict";function t(e){this.x=null,this.y=null,this.xOff=null,this.yOff=null,this.width=null,this.height=null,e&&(this.setPos(e.x,e.y,e.xOff,e.yOff),this.setDimensions(e.width,e.height))}return e.extend(t.prototype,{setPos:function(e,t,r,n){this.x=e,this.y=t,void 0!==r&&(this.xOff=r),void 0!==n&&(this.yOff=n)},setDimensions:function(e,t){this.width=e,this.height=t},toXML:function(e,t){var r=l.createElement(e,"xdr:oneCellAnchor"),n=l.createElement(e,"xdr:from"),i=l.createElement(e,"xdr:col");i.appendChild(e.createTextNode(this.x));var o=l.createElement(e,"xdr:colOff");o.appendChild(e.createTextNode(this.xOff||0));var a=l.createElement(e,"xdr:row");a.appendChild(e.createTextNode(this.y));var s=l.createElement(e,"xdr:rowOff");s.appendChild(e.createTextNode(this.yOff||0)),n.appendChild(i),n.appendChild(o),n.appendChild(a),n.appendChild(s),r.appendChild(n);n=l.createElement(e,"xdr:ext");return n.setAttribute("cx",this.width),n.setAttribute("cy",this.height),r.appendChild(n),r.appendChild(t),r.appendChild(l.createElement(e,"xdr:clientData")),r}}),t}),O("Excel/Drawings/TwoCellAnchor",["underscore","../util"],function(e,h){"use strict";function t(e){this.from={xOff:0,yOff:0},this.to={xOff:0,yOff:0},e&&(this.setFrom(e.from.x,e.from.y,e.to.xOff,e.to.yOff),this.setTo(e.to.x,e.to.y,e.to.xOff,e.to.yOff))}return e.extend(t.prototype,{setFrom:function(e,t,r,n){this.from.x=e,this.from.y=t,void 0!==r&&(this.from.xOff=r),void 0!==n&&(this.from.yOff=r)},setTo:function(e,t,r,n){this.to.x=e,this.to.y=t,void 0!==r&&(this.to.xOff=r),void 0!==n&&(this.to.yOff=r)},toXML:function(e,t){var r=h.createElement(e,"xdr:twoCellAnchor"),n=h.createElement(e,"xdr:from"),i=h.createElement(e,"xdr:col");i.appendChild(e.createTextNode(this.from.x));var o=h.createElement(e,"xdr:colOff");o.appendChild(e.createTextNode(this.from.xOff));var a=h.createElement(e,"xdr:row");a.appendChild(e.createTextNode(this.from.y));var s=h.createElement(e,"xdr:rowOff");s.appendChild(e.createTextNode(this.from.yOff)),n.appendChild(i),n.appendChild(o),n.appendChild(a),n.appendChild(s);var l=h.createElement(e,"xdr:to"),i=h.createElement(e,"xdr:col");i.appendChild(e.createTextNode(this.to.x));o=h.createElement(e,"xdr:colOff");o.appendChild(e.createTextNode(this.from.xOff));a=h.createElement(e,"xdr:row");a.appendChild(e.createTextNode(this.to.y));s=h.createElement(e,"xdr:rowOff");return s.appendChild(e.createTextNode(this.from.yOff)),l.appendChild(i),l.appendChild(o),l.appendChild(a),l.appendChild(s),r.appendChild(n),r.appendChild(l),r.appendChild(t),r.appendChild(h.createElement(e,"xdr:clientData")),r}}),t}),O("Excel/Drawings/Drawing",["underscore","./AbsoluteAnchor","./OneCellAnchor","./TwoCellAnchor"],function(e,r,n,i){"use strict";function t(){this.id=e.uniqueId("Drawing"),this.props={}}return e.extend(t.prototype,{createAnchor:function(e,t){switch((t=t||{}).drawing=this,e){case"absoluteAnchor":this.anchor=new r(t);break;case"oneCellAnchor":this.anchor=new n(t);break;case"twoCellAnchor":this.anchor=new i(t)}return this.anchor},setProps:function(e){this.props=e}}),t}),O("Excel/Positioning",[],function(){"use strict";return{pixelsToEMUs:function(e){return Math.round(914400*e/96)},emusToPixels:function(e){return Math.round(e/914400*96)}}}),O("Excel/Drawings/Connector",["./Drawing","underscore","../Positioning","../util"],function(e,n,t,i){"use strict";function r(e){var t,r;this.media=null,this.xfrm=null,this.id=n.uniqueId("Connector"),this.connectId=i.uniqueId("Drawing"),this.mediaData={},this.isNotOrthogonal=void 0!==e.isNotOrthogonal&&e.isNotOrthogonal,this.isLinkDecorator=void 0!==e.isLinkDecorator&&e.isLinkDecorator,this.from=e.from||"",this.to=e.to||"",this.x=e.x,this.y=e.y,this.fromPresetType=e.fromPresetType,this.toPresetType=e.toPresetType,this.rotation=void 0===e.rotation?162e5:e.rotation,this.rotation+="",this.direction=e.direction||"down",this.flipH=void 0!==e.flipH&&e.flipH,this.flipV=void 0!==e.flipV&&e.flipV,this.fill=e.fill&&"transparent"!==e.fill?e.fill:null,this.isLinkDecorator||this.isNotOrthogonal||("left"===this.direction||"leftCenter"===this.direction||"right"===this.direction||"rightCenter"===this.direction?(this.rotation="0",this.flipH=!this.flipH):this.flipV=!1),this.adjust=e.adjust||"50000",this.adjust2=e.adjust2,this.adjust3=e.adjust3,this.isCorner=void 0!==e.corner&&!!e.corner,this.curve=e.curve||"none",this.dash=e.dash||"solid",this.lnW=e.lnW||"",this.flipH||(this.adjust3?(t=this.adjust,r=this.adjust3,this.adjust=1e5-+r+"",this.adjust2=1e5-+this.adjust2+"",this.adjust3=1e5-+t+""):this.adjust=1e5-+this.adjust+""),this.isNotOrthogonal?this.presetShapeGeometry="line":"bezier"===this.curve?this.presetShapeGeometry="curvedConnector3":this.presetShapeGeometry=this.adjust3?"bentConnector5":"bentConnector3",this.fromPort=e.fromPort||"Bottom",this.toPort=e.toPort||"Top"}return r.prototype=new e,n.extend(r.prototype,{setMedia:function(e){this.mediaData=e},getMediaType:function(){return"spreadsheetDrawing"},getMediaData:function(){return this.mediaData},setRelationshipId:function(e){this.mediaData.rId=e},setTransform:function(e){return this.xfrm=e,this},getNonConnectShapeProperty:function(e){var t={roundRect:{Top:0,Left:1,Bottom:2,Right:3},round2SameRect:{Right:0,Bottom:1,Left:2,Top:3}};return this.startConnectIdx=t[this.fromPresetType][this.fromPort],this.endConnectIdx=t[this.toPresetType][this.toPort],i.createElements(e,{name:"xdr:nvCxnSpPr",childs:[{name:"xdr:cNvPr",attrs:[["id",this.connectId],["name","Straight Arrow Connector 8"]]},{name:"xdr:cNvCxnSpPr",childs:[{name:"a:stCxn",attrs:[["id",this.from],["idx",this.startConnectIdx]]},{name:"a:endCxn",attrs:[["id",this.to],["idx",this.endConnectIdx]]}]}]})},getShapeProperty:function(e){var t=i.createElement(e,"xdr:spPr"),r=i.createElements(e,{name:"a:xfrm",attrs:this.isNotOrthogonal?[["flipH",this.flipH],["flipV",this.flipV]]:[["rot",this.rotation],["flipH",this.flipH],["flipV",this.flipV]]});t.appendChild(r),n=this.isNotOrthogonal?i.createElements(e,{name:"a:prstGeom",attrs:[["prst",this.presetShapeGeometry]]}):((n=[]).push({name:"a:gd",attrs:[["name","adj1"],["fmla","val "+this.adjust]]}),this.adjust2&&n.push({name:"a:gd",attrs:[["name","adj2"],["fmla","val "+this.adjust2]]}),this.adjust3&&n.push({name:"a:gd",attrs:[["name","adj3"],["fmla","val "+this.adjust3]]}),i.createElements(e,{name:"a:prstGeom",attrs:[["prst",this.presetShapeGeometry]],childs:[{name:"a:avLst",childs:n}]})),t.appendChild(n);var n=[];return n.push({name:"a:solidFill",childs:[{name:"a:srgbClr",attrs:[["val",this.fill||"000000"]],childs:[{name:"a:alpha",attrs:[["val",this.fill?"100000":"0"]]}]}]}),n.push({name:"a:prstDash",attrs:[["val",this.dash]]}),this.isCorner&&n.push({name:"a:round"}),this.isLinkDecorator&&n.push({name:"a:tailEnd",attrs:[["type","triangle"]]}),n=i.createElements(e,{name:"a:ln",attrs:[["w",this.lnW]],childs:n}),t.appendChild(n),t},getStyle:function(e){var t=i.createElement(e,"xdr:style"),r=i.createElements(e,{name:"a:lnRef",attrs:[["idx","2"]],childs:[{name:"a:schemeClr",attrs:[["val","accent1"]],childs:[{name:"a:shade",attrs:[["val","50000"]]}]}]});return t.appendChild(r),r=i.createElements(e,{name:"a:fillRef",attrs:[["idx","1"]],childs:[{name:"a:scrgbClr",attrs:[["r","0"],["g","0"],["b","0"]]}]}),t.appendChild(r),r=i.createElements(e,{name:"a:effectRef",attrs:[["idx","0"]],childs:[{name:"a:schemeClr",attrs:[["val","accent2"]]}]}),t.appendChild(r),e=i.createElements(e,{name:"a:fontRef",attrs:[["idx","minor"]],childs:[{name:"a:srgbClr",attrs:[["val","00B0F0"]]}]}),t.appendChild(e),t},toXML:function(e){var t=i.createElement(e,"xdr:cxnSp",[["macro",""]]);return t.appendChild(this.getNonConnectShapeProperty(e)),t.appendChild(this.getShapeProperty(e)),t.appendChild(this.getStyle(e)),this.anchor.toXML(e,t)}}),r}),O("Excel/Drawings/Group",["./Drawing","underscore","../util"],function(e,t,u){"use strict";function r(e){this.media=null,this.id=t.uniqueId("Group"),this.groupId=u.uniqueId("Drawing"),this.fill={},this.mediaData={},this.name=this.id,this.members=[],this.xfrm={},e&&(this.members=e.member||[],this.xfrm=e.xfrm||{},this.isShadowed=e.isShadowed||!1)}return r.prototype=new e,t.extend(r.prototype,{setMedia:function(e){this.mediaData=e},getMediaType:function(){return"spreadsheetDrawing"},getMediaData:function(){return this.mediaData},setRelationshipId:function(e){this.mediaData.rId=e},addMember:function(e){this.members.push(e)},setTransform:function(e){this.xfrm=e},updateTransform:function(e){var t,r;e&&(this.xfrm.hasOwnProperty("offX")?(t=parseFloat(this.xfrm.offX),r=parseFloat(e.xfrm.offX),this.xfrm.offX=(t<r?t:r)+"",t=parseFloat(this.xfrm.offY),r=parseFloat(e.xfrm.offY),this.xfrm.offY=(t<r?t:r)+"",t=parseFloat(this.xfrm.extCx),r=parseFloat(e.xfrm.extCx),this.xfrm.extCx=(r<t?t:r)+"",t=parseFloat(this.xfrm.extCy),r=parseFloat(e.xfrm.extCy),this.xfrm.extCy=(r<t?t:r)+""):(this.xfrm.offX=parseFloat(e.xfrm.offX)+"",this.xfrm.offY=parseFloat(e.xfrm.offY)+"",this.xfrm.extCx=parseFloat(e.xfrm.extCx)+"",this.xfrm.extCy=parseFloat(e.xfrm.extCy)+""))},toXML:function(e,t){var r=u.createElement(e,"xdr:grpSp"),n=u.createElement(e,"xdr:nvGrpSpPr"),i=u.createElement(e,"xdr:cNvPr",[["id",this.groupId],["name",this.name]]),o=u.createElement(e,"xdr:cNvGrpSpPr");n.appendChild(i),n.appendChild(o),r.appendChild(n);var a=u.createElement(e,"xdr:grpSpPr"),i=u.createElement(e,"a:xfrm");a.appendChild(i),this.isShadowed&&(d=u.createElements(e,{name:"a:effectLst",childs:[{name:"a:outerShdw",attrs:[["blurRad","50800"],["dist","38100"],["dir","2700000"],["algn","tl"],["rotWithShape","0"]],childs:[{name:"a:prstClr",attrs:[["val","black"]],childs:[{name:"a:alpha",attrs:[["val","40000"]]}]}]}]}),a.appendChild(d)),r.appendChild(a);for(var s=0,l=this.members.length;s<l;s++){var h=this.members[s].toXML(e,!0);r.appendChild(h),this.updateTransform(this.members[s])}var o=u.createElement(e,"a:off",[["x",this.xfrm.offX],["y",this.xfrm.offY]]),n=u.createElement(e,"a:ext",[["cx",this.xfrm.extCx],["cy",this.xfrm.extCy]]),d=u.createElement(e,"a:chOff",[["x",this.xfrm.offX],["y",this.xfrm.offY]]),a=u.createElement(e,"a:chExt",[["cx",this.xfrm.extCx],["cy",this.xfrm.extCy]]);return i.appendChild(o),i.appendChild(n),i.appendChild(d),i.appendChild(a),t?r:this.anchor.toXML(e,r)}}),r}),O("Excel/Drawings/LineShape",["./Drawing","underscore","../Positioning","../util"],function(e,t,r,d){"use strict";function n(e){this.media=null,this.xfrm=null,this.id=t.uniqueId("LineShape"),this.connectId=d.uniqueId("Drawing"),this.mediaData={},this.fill="transparent",this.lnW=""}return n.prototype=new e,t.extend(n.prototype,{setMedia:function(e){this.mediaData=e},getMediaType:function(){return"spreadsheetDrawing"},getMediaData:function(){return this.mediaData},setRelationshipId:function(e){this.mediaData.rId=e},setTransform:function(e){return this.xfrm=e,this},getNonConnectShapeProperties:function(e){return d.createElements(e,{name:"xdr:nvCxnSpPr",childs:[{name:"xdr:cNvPr",attrs:[["id",this.connectId],["name","Straight Arrow Connector 8"]]},{name:"xdr:cNvCxnSpPr"}]})},getLineProperties:function(e){var t,r,n,i,o,a,s,l,h;if(0===this.props.borderWidth&&(this.props.borderWidth=9525,this.props.borderColor="transparent"),0===this.props.borderWidth)t=d.createElement(e,"a:ln"),s=d.createElement(e,"a:noFill");else if(n="transparent"===(r=this.props.borderColor),t=d.createElement(e,"a:ln",[["w",this.props.borderWidth]]),"string"==typeof r)s=d.createElement(e,"a:solidFill"),r=d.createElement(e,"a:srgbClr",[["val",n?"000000":r]]),n&&(n=d.createElement(e,"a:alpha",[["val","0"]]),r.appendChild(n)),s.appendChild(r);else{for(s=d.createElement(e,"a:gradFill"),o=d.createElement(e,"a:gsLst"),l=0,h=this.props.borderColor.colorStops.length;l<h;l++)a=d.createElements(e,{name:"a:gs",attrs:[["pos",100*this.props.borderColor.colorStops[l].key*1e3]],childs:[{name:"a:srgbClr",attrs:[["val",this.props.borderColor.colorStops[l].value]]}]}),o.appendChild(a);s.appendChild(o),this.props.borderColor.angle=this.props.borderColor.angle||0,"linear"===this.props.borderColor.type?0<this.props.borderColor.angle&&(i=d.createElement(e,"a:lin",[["ang",6e4*this.props.borderColor.angle]]),s.appendChild(i)):"radial"===this.props.borderColor.type&&(i=d.createElements(e,{name:"a:path",attrs:[["path","circle"]],childs:[{name:"a:fillToRect",attrs:[["l","50000"],["t","50000"],["r","50000"],["b","50000"]]}]}),s.appendChild(i))}return t.appendChild(s),s=d.createElements(e,{name:"a:prstDash",attrs:[["val",this.props.dash]]}),t.appendChild(s),t},getShapeProperties:function(e){var t,r,n=this.props.borderColor,i=this.props.borderWidth;return this.fill=n&&"transparent"!==n?n:null,this.lnW=i||"",t=d.createElement(e,"xdr:spPr"),r=d.createElement(e,"a:xfrm"),this.xfrm&&(n=d.createElement(e,"a:off",[["x",this.xfrm.offX],["y",this.xfrm.offY]]),i=d.createElement(e,"a:ext",[["cx",this.xfrm.extCx],["cy",this.xfrm.extCy]]),r.appendChild(n),r.appendChild(i)),t.appendChild(r),r=d.createElements(e,{name:"a:prstGeom",attrs:[["prst","line"]]}),t.appendChild(r),e=this.getLineProperties(e),t.appendChild(e),t},getStyle:function(e){var t=d.createElement(e,"xdr:style"),r=d.createElements(e,{name:"a:lnRef",attrs:[["idx","2"]],childs:[{name:"a:schemeClr",attrs:[["val","accent1"]],childs:[{name:"a:shade",attrs:[["val","50000"]]}]}]});return t.appendChild(r),r=d.createElements(e,{name:"a:fillRef",attrs:[["idx","1"]],childs:[{name:"a:scrgbClr",attrs:[["r","0"],["g","0"],["b","0"]]}]}),t.appendChild(r),r=d.createElements(e,{name:"a:effectRef",attrs:[["idx","0"]],childs:[{name:"a:schemeClr",attrs:[["val","accent2"]]}]}),t.appendChild(r),e=d.createElements(e,{name:"a:fontRef",attrs:[["idx","minor"]],childs:[{name:"a:srgbClr",attrs:[["val","00B0F0"]]}]}),t.appendChild(e),t},toXML:function(e,t){var r=d.createElement(e,"xdr:cxnSp",[["macro",""]]);return r.appendChild(this.getNonConnectShapeProperties(e)),r.appendChild(this.getShapeProperties(e)),r.appendChild(this.getStyle(e)),t?r:this.anchor.toXML(e,r)}}),n}),O("Excel/Drawings/Picture",["./Drawing","underscore","../util"],function(e,t,s){"use strict";function r(e){this.media=null,this.id=t.uniqueId("Picture"),this.pictureId=s.uniqueId("Drawing"),this.fill={},this.mediaData=null,this.xfrm=e||null}return r.prototype=new e,t.extend(r.prototype,{setMedia:function(e){return this.mediaData=e,this},setDescription:function(e){this.description=e},setFillType:function(e){this.fill.type=e},setFillConfig:function(e){t.extend(this.fill,e)},getMediaType:function(){return"image"},getMediaData:function(){return this.mediaData},setRelationshipId:function(e){this.mediaData.rId=e},setTransform:function(e){return this.xfrm=e,this},toXML:function(e,t){var r=s.createElement(e,"xdr:pic"),n=s.createElement(e,"xdr:nvPicPr"),i=s.createElement(e,"xdr:cNvPr",[["id",this.pictureId],["name",this.mediaData.fileName],["descr",this.description||""]]);n.appendChild(i);var o=s.createElement(e,"xdr:cNvPicPr");o.appendChild(s.createElement(e,"a:picLocks",[["noChangeAspect","1"],["noChangeArrowheads","1"]])),n.appendChild(o),r.appendChild(n);var a=s.createElement(e,"xdr:blipFill"),i=s.createElement(e,"a:blip",[["xmlns:r",s.schemas.relationships],["r:embed",this.mediaData.rId]]);i.msContentZoomFactor&&i.setAttribute("xmlns:r",s.schemas.relationships),a.appendChild(i),a.appendChild(s.createElement(e,"a:srcRect"));o=s.createElement(e,"a:stretch");o.appendChild(s.createElement(e,"a:fillRect")),a.appendChild(o),r.appendChild(a);n=s.createElement(e,"xdr:spPr",[["bwMode","auto"]]),i=s.createElement(e,"a:xfrm");this.xfrm&&(o=s.createElement(e,"a:off",[["x",this.xfrm.offX],["y",this.xfrm.offY]]),a=s.createElement(e,"a:ext",[["cx",this.xfrm.extCx],["cy",this.xfrm.extCy]]),i.appendChild(o),i.appendChild(a)),n.appendChild(i);i=s.createElement(e,"a:prstGeom",[["prst","rect"]]);return n.appendChild(i),r.appendChild(n),t?r:this.anchor.toXML(e,r)}}),r}),O("Excel/Drawings/PictureShape",["./Drawing","underscore","../util"],function(e,t,g){"use strict";function r(e){this.media=null,this.id=t.uniqueId("PictureShape"),this.shapeId=g.uniqueId("Drawing"),this.fill={},this.mediaData={},this.isBlipFill=!1,this.xfrm=e||null}return r.prototype=new e,t.extend(r.prototype,{setMedia:function(e){return this.mediaData=e,this},getMediaType:function(){return"image"},getMediaData:function(){return this.mediaData},setRelationshipId:function(e){this.mediaData.rId=e},setTransform:function(e){return this.xfrm=e,this},getNonVisibleShapeProperties:function(e){var t=g.createElement(e,"xdr:nvSpPr"),r=g.createElement(e,"xdr:cNvPr",[["id",this.shapeId],["name","roundRect "+this.shapeId]]),e=g.createElement(e,"xdr:cNvSpPr");return t.appendChild(r),t.appendChild(e),t},getShapeProperties:function(e){var t,r,n,i,o,a,s,l,h,d,u,c,p,f,m;if(this.props.backgroundColor=this.props.backgroundColor||"transparent",this.props.borderColor=this.props.borderColor||"transparent",t=g.createElement(e,"xdr:spPr"),n=g.createElement(e,"a:xfrm"),this.xfrm&&(r=g.createElement(e,"a:off",[["x",this.xfrm.offX],["y",this.xfrm.offY]]),p=g.createElement(e,"a:ext",[["cx",this.xfrm.extCx],["cy",this.xfrm.extCy]]),n.appendChild(r),n.appendChild(p)),t.appendChild(n),p=g.createElement(e,"a:prstGeom",[["prst",this.props.presetType]]),n=this.props.cornerType?g.createElements(e,{name:"a:avLst",childs:[{name:"a:gd",attrs:[["name","adj1"],["fmla","val "+("top"===this.props.cornerType?this.props.corner:0)]]},{name:"a:gd",attrs:[["name","adj2"],["fmla","val "+("bottom"===this.props.cornerType?this.props.corner:0)]]}]}):g.createElements(e,{name:"a:avLst",childs:[{name:"a:gd",attrs:[["name","adj"],["fmla","val "+this.props.corner]]}]}),p.appendChild(n),t.appendChild(p),this.isBlipFill=!!(this.mediaData&&this.mediaData.contentType&&this.mediaData.rId),this.isBlipFill&&(m=[{name:"a:blip",attrs:[["xmlns:r",g.schemas.relationships],["r:embed",this.mediaData.rId]]},{name:"a:srcRect"}],"uniform2fill"===this.props.imageStretch&&(0<this.props.fillRectWRatio||0<this.props.fillRectHRatio)?(p=[],0<this.props.fillRectWRatio&&(f=Math.round(this.props.unitW/this.xfrm.extCx*100)/100,f=Math.round(1e3*(100-this.props.fillRectWRatio)*f/2),p.push(["l",-f]),p.push(["r",-f])),0<this.props.fillRectHRatio&&(f=Math.round(this.props.unitH/this.xfrm.extCy*100)/100,f=Math.round(1e3*(100-this.props.fillRectHRatio)*f/2),p.push(["t",-f]),p.push(["b",-f])),m.push({name:"a:stretch",childs:[{name:"a:fillRect",attrs:p}]})):m.push({name:"a:stretch",childs:[{name:"a:fillRect"}]}),m=g.createElements(e,{name:"a:blipFill",attrs:[["dpi","0"],["rotWithShape","1"]],childs:m}),t.appendChild(m)),"string"==typeof this.props.backgroundColor)s=g.createElement(e,"a:solidFill"),l=g.createElement(e,"a:srgbClr",[["val",this.props.backgroundColor]]),s.appendChild(l);else{for(s=g.createElement(e,"a:gradFill"),i=g.createElement(e,"a:gsLst"),h=0,d=this.props.backgroundColor.colorStops.length;h<d;h++)u=g.createElements(e,{name:"a:gs",attrs:[["pos",100*this.props.backgroundColor.colorStops[h].key*1e3]],childs:[{name:"a:srgbClr",attrs:[["val",this.props.backgroundColor.colorStops[h].value]]}]}),i.appendChild(u);s.appendChild(i),this.props.backgroundColor.angle=this.props.backgroundColor.angle||0,"linear"===this.props.backgroundColor.type?0<this.props.backgroundColor.angle&&(c=g.createElement(e,"a:lin",[["ang",6e4*this.props.backgroundColor.angle]]),s.appendChild(c)):"radial"===this.props.backgroundColor.type&&(c=g.createElements(e,{name:"a:path",attrs:[["path","circle"]],childs:[{name:"a:fillToRect",attrs:[["l","50000"],["t","50000"],["r","50000"],["b","50000"]]}]}),s.appendChild(c))}if(0===this.props.borderWidth)o=g.createElement(e,"a:ln"),a=g.createElement(e,"a:noFill");else if(l="transparent"===(m=this.props.borderColor),o=g.createElement(e,"a:ln",[["w",this.props.borderWidth]]),"string"==typeof m)a=g.createElement(e,"a:solidFill"),m=g.createElement(e,"a:srgbClr",[["val",l?"000000":m]]),l&&(l=g.createElement(e,"a:alpha",[["val","0"]]),m.appendChild(l)),a.appendChild(m);else{for(a=g.createElement(e,"a:gradFill"),i=g.createElement(e,"a:gsLst"),h=0,d=this.props.borderColor.colorStops.length;h<d;h++)u=g.createElements(e,{name:"a:gs",attrs:[["pos",100*this.props.borderColor.colorStops[h].key*1e3]],childs:[{name:"a:srgbClr",attrs:[["val",this.props.borderColor.colorStops[h].value]]}]}),i.appendChild(u);a.appendChild(i),this.props.borderColor.angle=this.props.borderColor.angle||0,"linear"===this.props.borderColor.type?0<this.props.borderColor.angle&&(c=g.createElement(e,"a:lin",[["ang",6e4*this.props.borderColor.angle]]),a.appendChild(c)):"radial"===this.props.borderColor.type&&(c=g.createElements(e,{name:"a:path",attrs:[["path","circle"]],childs:[{name:"a:fillToRect",attrs:[["l","50000"],["t","50000"],["r","50000"],["b","50000"]]}]}),a.appendChild(c))}return o.appendChild(a),"transparent"===this.props.backgroundColor?s=g.createElement(e,"a:noFill"):(s=g.createElements(e,{name:"a:prstDash",attrs:[["val",this.props.dash]]}),o.appendChild(s)),t.appendChild(o),t},getStyle:function(e){var t=g.createElement(e,"xdr:style"),r=g.createElement(e,"a:lnRef",[["idx","2"]]),n=g.createElement(e,"a:schemeClr",[["val","accent1"]]),i=g.createElement(e,"a:shade",[["val","50000"]]);return n.appendChild(i),r.appendChild(n),t.appendChild(r),n=g.createElement(e,"a:fillRef",[["idx","1"]]),t.appendChild(n),r=g.createElement(e,"a:effectRef",[["idx","0"]]),n=g.createElement(e,"a:schemeClr",[["val","accent2"]]),r.appendChild(n),t.appendChild(r),r=g.createElement(e,"a:fontRef",[["idx","minor"]]),e=g.createElement(e,"a:srgbClr",[["val",this.props.fontColor||"000000"]]),r.appendChild(e),t.appendChild(r),t},toXML:function(e,t){var r=g.createElement(e,"xdr:sp",[["macro",""],["textlink",""]]);return r.appendChild(this.getNonVisibleShapeProperties(e)),r.appendChild(this.getShapeProperties(e)),r.appendChild(this.getStyle(e)),t?r:this.anchor.toXML(e,r)}}),r}),O("Excel/Drawings/Shape",["./Drawing","underscore","../util"],function(e,r,d){"use strict";function t(e,t){this.media=null,this.id=r.uniqueId("Shape"),this.shapeId=d.uniqueId("Drawing"),this.fill={},this.mediaData={},this.xfrm=e||null,this.isNotOrthogonal=void 0!==t&&t}return t.prototype=new e,r.extend(t.prototype,{setMedia:function(e){return this.mediaData=e,this},getMediaType:function(){return"spreadsheetDrawing"},getMediaData:function(){return this.mediaData},setRelationshipId:function(e){this.mediaData.rId=e},setTransform:function(e){return this.xfrm=e,this},getNonVisibleShapeProperties:function(e){var t=d.createElement(e,"xdr:nvSpPr"),r=d.createElement(e,"xdr:cNvPr",[["id",this.shapeId],["name","roundRect "+this.shapeId]]),e=d.createElement(e,"xdr:cNvSpPr");return t.appendChild(r),t.appendChild(e),t},getAdjustLst:function(e){e=this.props.cornerType?d.createElements(e,{name:"a:avLst",childs:[{name:"a:gd",attrs:[["name","adj1"],["fmla","val "+("top"===this.props.cornerType?this.props.corner:0)]]},{name:"a:gd",attrs:[["name","adj2"],["fmla","val "+("bottom"===this.props.cornerType?this.props.corner:0)]]}]}):d.createElements(e,{name:"a:avLst",childs:[{name:"a:gd",attrs:[["name","adj"],["fmla","val "+this.props.corner]]}]});return e},getShapeFill:function(e){var t,r,n,i,o,a,s,l;if("transparent"===this.props.backgroundColor)return t=d.createElement(e,"a:noFill");if("string"==typeof this.props.backgroundColor)t=d.createElement(e,"a:solidFill"),r=d.createElement(e,"a:srgbClr",[["val",this.props.backgroundColor]]),n=d.createElement(e,"a:alpha",[["val",this.props.opacity||1e5]]),r.appendChild(n),t.appendChild(r);else{for(t=d.createElement(e,"a:gradFill"),i=d.createElement(e,"a:gsLst"),s=0,l=this.props.backgroundColor.colorStops.length;s<l;s++)o=d.createElements(e,{name:"a:gs",attrs:[["pos",100*this.props.backgroundColor.colorStops[s].key*1e3]],childs:[{name:"a:srgbClr",attrs:[["val",this.props.backgroundColor.colorStops[s].value]]}]}),i.appendChild(o);t.appendChild(i),this.props.backgroundColor.angle=this.props.backgroundColor.angle||0,"linear"===this.props.backgroundColor.type?0<this.props.backgroundColor.angle&&(a=d.createElement(e,"a:lin",[["ang",6e4*this.props.backgroundColor.angle]]),t.appendChild(a)):"radial"===this.props.backgroundColor.type&&(a=d.createElements(e,{name:"a:path",attrs:[["path","circle"]],childs:[{name:"a:fillToRect",attrs:[["l","50000"],["t","50000"],["r","50000"],["b","50000"]]}]}),t.appendChild(a))}return t},getLineProperties:function(e){var t,r,n,i,o,a,s,l,h;if(0===this.props.borderWidth&&(this.props.borderWidth=9525,this.props.borderColor="transparent"),0===this.props.borderWidth)t=d.createElement(e,"a:ln"),s=d.createElement(e,"a:noFill");else if(n="transparent"===(r=this.props.borderColor),t=d.createElement(e,"a:ln",[["w",this.props.borderWidth]]),"string"==typeof r)s=d.createElement(e,"a:solidFill"),r=d.createElement(e,"a:srgbClr",[["val",n?"000000":r]]),n&&(n=d.createElement(e,"a:alpha",[["val","0"]]),r.appendChild(n)),s.appendChild(r);else{for(s=d.createElement(e,"a:gradFill"),o=d.createElement(e,"a:gsLst"),l=0,h=this.props.borderColor.colorStops.length;l<h;l++)a=d.createElements(e,{name:"a:gs",attrs:[["pos",100*this.props.borderColor.colorStops[l].key*1e3]],childs:[{name:"a:srgbClr",attrs:[["val",this.props.borderColor.colorStops[l].value]]}]}),o.appendChild(a);s.appendChild(o),this.props.borderColor.angle=this.props.borderColor.angle||0,"linear"===this.props.borderColor.type?0<this.props.borderColor.angle&&(i=d.createElement(e,"a:lin",[["ang",6e4*this.props.borderColor.angle]]),s.appendChild(i)):"radial"===this.props.borderColor.type&&(i=d.createElements(e,{name:"a:path",attrs:[["path","circle"]],childs:[{name:"a:fillToRect",attrs:[["l","50000"],["t","50000"],["r","50000"],["b","50000"]]}]}),s.appendChild(i))}return t.appendChild(s),s=d.createElements(e,{name:"a:prstDash",attrs:[["val",this.props.dash]]}),t.appendChild(s),t},getShapeProperties:function(e){var t,r,n,i;return this.props.backgroundColor=this.props.backgroundColor||"transparent",this.props.borderColor=this.props.borderColor||"transparent",t=d.createElement(e,"xdr:spPr"),i=d.createElement(e,"a:xfrm"),this.xfrm&&(r=d.createElement(e,"a:off",[["x",this.xfrm.offX],["y",this.xfrm.offY]]),n=d.createElement(e,"a:ext",[["cx",this.xfrm.extCx],["cy",this.xfrm.extCy]]),i.appendChild(r),i.appendChild(n)),t.appendChild(i),(i=d.createElement(e,"a:prstGeom",[["prst",this.props.presetType||"roundRect"]])).appendChild(this.getAdjustLst(e)),t.appendChild(i),i=this.getShapeFill(e),e=this.getLineProperties(e),t.appendChild(i),t.appendChild(e),t},getStyle:function(e){var t=d.createElement(e,"xdr:style"),r=d.createElement(e,"a:lnRef",[["idx","2"]]),n=d.createElement(e,"a:schemeClr",[["val","accent1"]]),i=d.createElement(e,"a:shade",[["val","50000"]]);return n.appendChild(i),r.appendChild(n),t.appendChild(r),n=d.createElement(e,"a:fillRef",[["idx","1"]]),t.appendChild(n),r=d.createElement(e,"a:effectRef",[["idx","0"]]),n=d.createElement(e,"a:schemeClr",[["val","accent2"]]),r.appendChild(n),t.appendChild(r),r=d.createElement(e,"a:fontRef",[["idx","minor"]]),e=d.createElement(e,"a:srgbClr",[["val","string"==typeof this.props.fontColor&&this.props.fontColor||"000000"]]),r.appendChild(e),t.appendChild(r),t},getRegularTextRun:function(e){var t,r=d.createElement(e,"a:r"),n=!1===this.props.allowPadForFitText?this.props.fontSize*(1<this.props.fitTextScale?1:+this.props.fitTextScale):this.props.fontSize*(1<this.props.fitTextScale?1:this.props.fitTextScale);return n=Math.round(n),t=d.createElement(e,"a:rPr",[["lang","ko-KR"],["altLang","en-US"],["sz",n],["b",this.props.fontBold]]),"string"!=typeof this.props.fontColor&&t.appendChild(this.getTextGradFill(e)),this.props.fontFamily&&(t.appendChild(d.createElement(e,"a:latin",[["typeface",this.props.fontFamily]])),t.appendChild(d.createElement(e,"a:ea",[["typeface",this.props.fontFamily]])),t.appendChild(d.createElement(e,"a:cs",[["typeface",this.props.fontFamily]]))),n=d.createElement(e,"a:t"),this.props.forceWrap?n.appendChild(e.createTextNode(this.props.text.split("").join("\n"))):n.appendChild(e.createTextNode(this.props.text)),r.appendChild(t),r.appendChild(n),r},getTextParagraphProperties:function(e){var t,r,n,i,o,a,s="100000",l=d.createElement(e,"a:pPr",[["algn",this.props.horizontalAlign||"ctr"]]),h=d.createElement(e,"a:lnSpc");return this.props.forceWrap?this.props.fitText?this.props.fitTextScale<1?(s=69e3,s-=this.props.text.length/s*100*100*100*10,n=d.createElement(e,"a:spcPct",[["val",Math.floor(s)]]),i=d.createElement(e,"a:spcPts",[["val",Math.floor(this.props.fontSize*this.props.fitTextScale)]]),h.appendChild(n),l.appendChild(h)):this.hasSpacing()?(n=d.createElement(e,"a:spcPct",[["val",s]]),i=d.createElement(e,"a:spcPts",[["val",+this.props.fontSize]]),h.appendChild(i),t=d.createElement(e,"a:spcBef"),r=d.createElement(e,"a:spcAft"),a=this.props.text.length,o=Math.floor(this.props.spacingTop?+this.props.spacingTop+this.props.fontSize/a:0),o=d.createElement(e,"a:spcPts",[["val",o]]),t.appendChild(o),a=Math.floor(this.props.spacingBottom?+this.props.spacingBottom+this.props.fontSize/a:0),a=d.createElement(e,"a:spcPts",[["val",a]]),r.appendChild(a),l.appendChild(h),l.appendChild(t),l.appendChild(r)):(s=69e3,s-=this.props.text.length/s*100*100*100*10,n=d.createElement(e,"a:spcPct",[["val",Math.floor(s)]]),h.appendChild(n),l.appendChild(h)):(s="70000",n=d.createElement(e,"a:spcPct",[["val",s]]),h.appendChild(n),l.appendChild(h)):(this.hasSpacing()&&(s=this.props.spacingTop+this.props.spacingBottom)?(s+=this.props.fontSize,i=d.createElement(e,"a:spcPts",[["val",s]]),h.appendChild(i)):(s="70000",n=d.createElement(e,"a:spcPct",[["val",s]]),h.appendChild(n)),l.appendChild(h)),l},hasSpacing:function(){var e=this.props.spacingTop,t=this.props.spacingBottom;return void 0!==e&&(void 0!==t&&0<this.props.spacingTop+this.props.spacingBottom)},getTextGradFill:function(e){for(var t,r,n=d.createElement(e,"a:gradFill"),i=d.createElement(e,"a:gsLst"),o=0,a=this.props.fontColor.colorStops.length;o<a;o++)r=d.createElements(e,{name:"a:gs",attrs:[["pos",100*this.props.fontColor.colorStops[o].key*1e3]],childs:[{name:"a:srgbClr",attrs:[["val",this.props.fontColor.colorStops[o].value]]}]}),i.appendChild(r);return n.appendChild(i),this.props.fontColor.angle=this.props.fontColor.angle||0,"linear"===this.props.fontColor.type?0<this.props.fontColor.angle&&(t=d.createElement(e,"a:lin",[["ang",6e4*this.props.fontColor.angle]]),n.appendChild(t)):"radial"===this.props.fontColor.type&&(t=d.createElements(e,{name:"a:path",attrs:[["path","circle"]],childs:[{name:"a:fillToRect",attrs:[["l","50000"],["t","50000"],["r","50000"],["b","50000"]]}]}),n.appendChild(t)),n},getTextBody:function(e){var t="0",r="0",n=this.hasSpacing(),t=this.props.paddingTop||"0",i=this.props.paddingLeft||"0",o=this.props.paddingRight||"0",r=this.props.paddingBottom||"0";return n?t="9575":this.props.forceWrap?this.props.fitText&&(t="0"):this.props.fitText,n=d.createElement(e,"xdr:txBody"),i=d.createElement(e,"a:bodyPr",[["vertOverflow","clip"],["tIns",t],["lIns",i],["rIns",o],["bIns",r],["rtlCol","0"],["anchor",this.props.verticalAlign||"ctr"]]),o=d.createElement(e,"a:lstStyle"),r=d.createElement(e,"a:p"),this.props.fitText&&!0===this.props.allowPadForFitText&&(this.props.horizontalAlign="dist"),r.appendChild(this.getTextParagraphProperties(e)),this.props.text&&r.appendChild(this.getRegularTextRun(e)),n.appendChild(i),n.appendChild(o),n.appendChild(r),n},toXML:function(e,t){var r=d.createElement(e,"xdr:sp",[["macro",""],["textlink",""]]);return r.appendChild(this.getNonVisibleShapeProperties(e)),r.appendChild(this.getShapeProperties(e)),r.appendChild(this.getStyle(e)),r.appendChild(this.getTextBody(e)),t?r:this.anchor.toXML(e,r)}}),t}),O("Excel/SharedStrings",["underscore","./util"],function(e,s){"use strict";function t(){this.strings={},this.stringArray=[],this.id=e.uniqueId("SharedStrings")}return e.extend(t.prototype,{addString:function(e){return this.strings[e]=this.stringArray.length,this.stringArray[this.stringArray.length]=e,this.strings[e]},exportData:function(){return this.strings},toXML:function(){var e=s.createXmlDoc(s.schemas.spreadsheetml,"sst"),t=e.documentElement;this.stringArray.reverse();var r=this.stringArray.length;t.setAttribute("count",r),t.setAttribute("uniqueCount",r);var n=e.createElement("si"),i=e.createElement("t");i.appendChild(e.createTextNode("--placeholder--")),n.appendChild(i);for(var o=this.stringArray;r--;){var a=n.cloneNode(!0);a.firstChild.firstChild.nodeValue=o[r],t.appendChild(a)}return e}}),t}),O("Excel/StyleSheet",["underscore","./util"],function(l,h){"use strict";function e(){this.id=l.uniqueId("StyleSheet"),this.cellStyles=[{name:"Normal",xfId:"0",builtinId:"0"}],this.defaultTableStyle=!1,this.differentialStyles=[{}],this.masterCellFormats=[{numFmtId:0,fontId:0,fillId:0,borderId:0,xfid:0}],this.masterCellStyles=[{numFmtId:0,fontId:0,fillId:0,borderId:0}],this.fonts=[{}],this.numberFormatters=[],this.fills=[{},{type:"pattern",patternType:"gray125",fgColor:"FF333333",bgColor:"FF333333"}],this.borders=[{top:{},left:{},right:{},bottom:{},diagonal:{}}],this.tableStyles=[]}return l.extend(e.prototype,{createSimpleFormatter:function(e){var t={id:this.masterCellFormats.length};return"date"===e&&(t.numFmtId=14),this.masterCellFormats.push(t),t},createFill:function(e){var t=this.fills.length,e=e;return e.id=t,this.fills.push(e),e},createNumberFormatter:function(e){e={id:this.numberFormatters.length+100,formatCode:e};return this.numberFormatters.push(e),e},createFormat:function(e){var t={id:this.masterCellFormats.length};if(e.font&&l.isObject(e.font))t.fontId=this.createFontStyle(e.font).id;else if(e.font){if(l.isNaN(parseInt(e.font,10)))throw"Passing a non-numeric font id is not supported";t.fontId=e.font}if(e.format&&l.isString(e.format))t.numFmtId=this.createNumberFormatter(e.format).id;else if(e.format){if(l.isNaN(parseInt(e.format,10)))throw"Invalid number formatter id";t.numFmtId=e.format}if(e.border&&l.isObject(e.border))t.borderId=this.createBorderFormatter(e.border).id;else if(e.border){if(l.isNaN(parseInt(e.border,10)))throw"Passing a non-numeric border id is not supported";t.borderId=e.border}if(e.fill&&l.isObject(e.fill))t.fillId=this.createFill(e.fill).id;else if(e.fill){if(l.isNaN(parseInt(e.fill,10)))throw"Passing a non-numeric fill id is not supported";t.fillId=e.fill}return e.alignment&&l.isObject(e.alignment)&&(t.alignment=l.pick(e.alignment,"horizontal","justifyLastLine","readingOrder","relativeIndent","shrinkToFit","textRotation","vertical","wrapText")),this.masterCellFormats.push(t),t},createDifferentialStyle:function(e){var t=this.differentialStyles.length,r={id:t};return e.font&&l.isObject(e.font)&&(r.font=e.font),e.border&&l.isObject(e.border)&&(r.border=l.defaults(e.border,{top:{},left:{},right:{},bottom:{},diagonal:{}})),e.fill&&l.isObject(e.fill)&&(r.fill=e.fill),e.alignment&&l.isObject(e.alignment)&&(r.alignment=e.alignment),e.format&&l.isString(e.format)&&(r.numFmt=e.format),this.differentialStyles[t]=r},createTableStyle:function(e){this.tableStyles.push(e)},createBorderFormatter:function(e){return l.defaults(e,{top:{},left:{},right:{},bottom:{},diagonal:{},id:this.borders.length}),this.borders.push(e),e},createFontStyle:function(e){var t={id:this.fonts.length};return e.bold&&(t.bold=!0),e.italic&&(t.italic=!0),e.superscript&&(t.vertAlign="superscript"),e.subscript&&(t.vertAlign="subscript"),e.underline&&(-1!==l.indexOf(["double","singleAccounting","doubleAccounting"],e.underline)?t.underline=e.underline:t.underline=!0),e.strike&&(t.strike=!0),e.outline&&(t.outline=!0),e.shadow&&(t.shadow=!0),e.size&&(t.size=e.size),e.color&&(t.color=e.color),e.fontName&&(t.fontName=e.fontName),this.fonts.push(t),t},exportBorders:function(e){var t=e.createElement("borders");t.setAttribute("count",this.borders.length);for(var r=0,n=this.borders.length;r<n;r++)t.appendChild(this.exportBorder(e,this.borders[r]));return t},exportBorder:function(r,n){function e(e){var t=r.createElement(e);return n[e].style&&t.setAttribute("style",n[e].style),n[e].color&&t.appendChild(i.exportColor(r,n[e].color)),t}var t=r.createElement("border"),i=this;return t.appendChild(e("left")),t.appendChild(e("right")),t.appendChild(e("top")),t.appendChild(e("bottom")),t.appendChild(e("diagonal")),t},exportColor:function(e,t){e=e.createElement("color");return l.isString(t)?e.setAttribute("rgb",t):(l.isUndefined(t.tint)||e.setAttribute("tint",t.tint),l.isUndefined(t.auto)||e.setAttribute("auto",!!t.auto),l.isUndefined(t.theme)||e.setAttribute("theme",t.theme)),e},exportMasterCellFormats:function(e){for(var t=h.createElement(e,"cellXfs",[["count",this.masterCellFormats.length]]),r=0,n=this.masterCellFormats.length;r<n;r++){var i=this.masterCellFormats[r];t.appendChild(this.exportCellFormatElement(e,i))}return t},exportMasterCellStyles:function(e){for(var t=h.createElement(e,"cellStyleXfs",[["count",this.masterCellStyles.length]]),r=0,n=this.masterCellStyles.length;r<n;r++){var i=this.masterCellStyles[r];t.appendChild(this.exportCellFormatElement(e,i))}return t},exportCellFormatElement:function(e,t){var r,n=e.createElement("xf"),i=["applyAlignment","applyBorder","applyFill","applyFont","applyNumberFormat","applyProtection","borderId","fillId","fontId","numFmtId","pivotButton","quotePrefix","xfId"],o=l.filter(l.keys(t),function(e){if(-1!==l.indexOf(i,e))return!0});t.alignment&&(r=t.alignment,n.appendChild(this.exportAlignment(e,r)));for(var a=o.length;a--;)n.setAttribute(o[a],t[o[a]]);return t.fillId&&n.setAttribute("applyFill","1"),n},exportAlignment:function(e,t){for(var r=e.createElement("alignment"),n=l.keys(t),i=0,o=n.length;i<o;i++)r.setAttribute(n[i],t[n[i]]);return r},exportFonts:function(e){var t=e.createElement("fonts");t.setAttribute("count",this.fonts.length);for(var r=0,n=this.fonts.length;r<n;r++){var i=this.fonts[r];t.appendChild(this.exportFont(e,i))}return t},exportFont:function(e,t){var r,n,i=e.createElement("font");return t.size&&((r=e.createElement("sz")).setAttribute("val",t.size),i.appendChild(r)),t.fontName&&((r=e.createElement("name")).setAttribute("val",t.fontName),i.appendChild(r)),t.bold&&i.appendChild(e.createElement("b")),t.italic&&i.appendChild(e.createElement("i")),t.vertAlign&&((n=e.createElement("vertAlign")).setAttribute("val",t.vertAlign),i.appendChild(n)),t.underline&&(n=e.createElement("u"),!0!==t.underline&&n.setAttribute("val",t.underline),i.appendChild(n)),t.strike&&i.appendChild(e.createElement("strike")),t.shadow&&i.appendChild(e.createElement("shadow")),t.outline&&i.appendChild(e.createElement("outline")),t.color&&i.appendChild(this.exportColor(e,t.color)),i},exportFills:function(e){var t=e.createElement("fills");t.setAttribute("count",this.fills.length);for(var r=0,n=this.fills.length;r<n;r++){var i=this.fills[r];t.appendChild(this.exportFill(e,i))}return t},exportFill:function(e,t){var r,n=e.createElement("fill");return"pattern"===t.type?(r=this.exportPatternFill(e,t),n.appendChild(r)):"gradient"===t.type&&(r=this.exportGradientFill(e,t),n.appendChild(r)),n},exportGradientFill:function(e,t){var r=e.createElement("gradientFill");t.degree?r.setAttribute("degree",t.degree):t.left&&(r.setAttribute("left",t.left),r.setAttribute("right",t.right),r.setAttribute("top",t.top),r.setAttribute("bottom",t.bottom));var n=e.createElement("stop");n.setAttribute("position",t.start.pureAt||0);var i=e.createElement("color");"string"==typeof t.start||t.start.color?i.setAttribute("rgb",t.start.color||t.start):(t.start.theme,i.setAttribute("theme",t.start.theme));var o=e.createElement("stop"),e=e.createElement("color");return o.setAttribute("position",t.end.pureAt||1),"string"==typeof t.start||t.end.color?e.setAttribute("rgb",t.end.color||t.end):(t.end.theme,e.setAttribute("theme",t.end.theme)),n.appendChild(i),o.appendChild(e),r.appendChild(n),r.appendChild(o),r},exportPatternFill:function(e,t){var r=h.createElement(e,"patternFill",[["patternType",t.patternType]]);t.bgColor||(t.bgColor="FFFFFFFF"),t.fgColor||(t.fgColor="FFFFFFFF");var n=e.createElement("bgColor");l.isString(t.bgColor)?n.setAttribute("rgb",t.bgColor):t.bgColor.theme?n.setAttribute("theme",t.bgColor.theme):n.setAttribute("rgb",t.bgColor.rbg);e=e.createElement("fgColor");return l.isString(t.fgColor)?e.setAttribute("rgb",t.fgColor):t.fgColor.theme?e.setAttribute("theme",t.fgColor.theme):e.setAttribute("rgb",t.fgColor.rbg),r.appendChild(e),r.appendChild(n),r},exportNumberFormatters:function(e){var t=e.createElement("numFmts");t.setAttribute("count",this.numberFormatters.length);for(var r=0,n=this.numberFormatters.length;r<n;r++){var i=this.numberFormatters[r];t.appendChild(this.exportNumberFormatter(e,i))}return t},exportNumberFormatter:function(e,t){e=e.createElement("numFmt");return e.setAttribute("numFmtId",t.id),e.setAttribute("formatCode",t.formatCode),e},exportCellStyles:function(e){var t=e.createElement("cellStyles");t.setAttribute("count",this.cellStyles.length);for(var r=0,n=this.cellStyles.length;r<n;r++){var i=this.cellStyles[r];delete i.id;var o=h.createElement(e,"cellStyle");t.appendChild(o);for(var a=l.keys(i),s=a.length;s--;)o.setAttribute(a[s],i[a[s]])}return t},exportDifferentialStyles:function(e){var t=e.createElement("dxfs");t.setAttribute("count",this.differentialStyles.length);for(var r=0,n=this.differentialStyles.length;r<n;r++){var i=this.differentialStyles[r];t.appendChild(this.exportDFX(e,i))}return t},exportDFX:function(e,t){var r=e.createElement("dxf");return t.font&&r.appendChild(this.exportFont(e,t.font)),t.fill&&r.appendChild(this.exportFill(e,t.fill)),t.border&&r.appendChild(this.exportBorder(e,t.border)),t.numFmt&&r.appendChild(this.exportNumberFormatter(e,t.numFmt)),t.alignment&&r.appendChild(this.exportAlignment(e,t.alignment)),r},exportTableStyles:function(e){var t=e.createElement("tableStyles");t.setAttribute("count",this.tableStyles.length),this.defaultTableStyle&&t.setAttribute("defaultTableStyle",this.defaultTableStyle);for(var r=0,n=this.tableStyles.length;r<n;r++)t.appendChild(this.exportTableStyle(e,this.tableStyles[r]));return t},exportTableStyle:function(n,e){var i=n.createElement("tableStyle");i.setAttribute("name",e.name),i.setAttribute("pivot",0);var o=0;return l.each(e,function(e,t){var r;"name"!==t&&(o++,(r=n.createElement("tableStyleElement")).setAttribute("type",t),r.setAttribute("dxfId",e),i.appendChild(r))}),i.setAttribute("count",o),i},toXML:function(){var e=h.createXmlDoc(h.schemas.spreadsheetml,"styleSheet"),t=e.documentElement;return t.appendChild(this.exportNumberFormatters(e)),t.appendChild(this.exportFonts(e)),t.appendChild(this.exportFills(e)),t.appendChild(this.exportBorders(e)),t.appendChild(this.exportMasterCellStyles(e)),t.appendChild(this.exportMasterCellFormats(e)),t.appendChild(this.exportCellStyles(e)),t.appendChild(this.exportDifferentialStyles(e)),this.tableStyles.length&&t.appendChild(this.exportTableStyles(e)),e}}),e}),O("Excel/Table",["underscore","./util"],function(t,i){"use strict";function e(e){t.defaults(this,{name:"",displayName:"",dataCellStyle:null,dataDfxId:null,headerRowBorderDxfId:null,headerRowCellStyle:null,headerRowCount:1,headerRowDxfId:null,insertRow:!1,insertRowShift:!1,ref:null,tableBorderDxfId:null,totalsRowBorderDxfId:null,totalsRowCellStyle:null,totalsRowCount:0,totalsRowDxfId:null,tableColumns:[],autoFilter:null,sortState:null,styleInfo:{}}),this.initialize(e)}return t.extend(e.prototype,{initialize:function(e){this.displayName=t.uniqueId("Table"),this.name=this.displayName,this.id=this.name,this.tableId=this.id.replace("Table",""),t.extend(this,e)},setReferenceRange:function(e,t){this.ref=[e,t]},setTableColumns:function(e){t.each(e,function(e){this.addTableColumn(e)},this)},addTableColumn:function(e){if(!(e=t.isString(e)?{name:e}:e).name)throw"Invalid argument for addTableColumn - minimum requirement is a name property";this.tableColumns.push(e)},setSortState:function(e){this.sortState=e},toXML:function(){var e=i.createXmlDoc(i.schemas.spreadsheetml,"table"),t=e.documentElement;t.setAttribute("id",this.tableId),t.setAttribute("name",this.name),t.setAttribute("displayName",this.displayName);var r=this.ref[0],n=this.ref[1];if(t.setAttribute("ref",i.positionToLetterRef(r[0],r[1])+":"+i.positionToLetterRef(n[0],n[1])),t.setAttribute("totalsRowCount",this.totalsRowCount),t.setAttribute("headerRowCount",this.headerRowCount),this.headerRowDxfId&&t.setAttribute("headerRowDxfId",this.headerRowDxfId),this.headerRowBorderDxfId&&t.setAttribute("headerRowBorderDxfId",this.headerRowBorderDxfId),!this.ref)throw"Needs at least a reference range";return this.autoFilter||this.addAutoFilter(this.ref[0],this.ref[1]),t.appendChild(this.exportAutoFilter(e)),t.appendChild(this.exportTableColumns(e)),t.appendChild(this.exportTableStyleInfo(e)),e},exportTableColumns:function(e){var t=e.createElement("tableColumns");t.setAttribute("count",this.tableColumns.length);for(var r=this.tableColumns,n=0,i=r.length;n<i;n++){var o=r[n],a=e.createElement("tableColumn");a.setAttribute("id",n+1),a.setAttribute("name",o.name),t.appendChild(a),o.totalsRowFunction&&a.setAttribute("totalsRowFunction",o.totalsRowFunction),o.totalsRowLabel&&a.setAttribute("totalsRowLabel",o.totalsRowLabel)}return t},exportAutoFilter:function(e){var t=e.createElement("autoFilter"),r=this.autoFilter[0],e=this.autoFilter[1];return t.setAttribute("ref",i.positionToLetterRef(r[0],r[1])+":"+i.positionToLetterRef(e[0],e[1]-this.totalsRowCount)),t},exportTableStyleInfo:function(e){var t=this.styleInfo,e=e.createElement("tableStyleInfo");return e.setAttribute("name",t.themeStyle),e.setAttribute("showFirstColumn",t.showFirstColumn?"1":"0"),e.setAttribute("showLastColumn",t.showLastColumn?"1":"0"),e.setAttribute("showColumnStripes",t.showColumnStripes?"1":"0"),e.setAttribute("showRowStripes",t.showRowStripes?"1":"0"),e},addAutoFilter:function(e,t){this.autoFilter=[e,t]}}),e}),O("Excel/Worksheet",["underscore","./util","./RelationshipManager"],function(h,k,t){"use strict";function e(e){this.relations=null,this.columnFormats=[],this.data=[],this.mergedCells=[],this.columns=[],this._headers=[],this._footers=[],this._tables=[],this._drawings=[],this._rowInstructions={},this.initialize(e)}return h.extend(e.prototype,{initialize:function(e){e=e||{},this.name=e.name,this.id=h.uniqueId("Worksheet"),this._timezoneOffset=60*(new Date).getTimezoneOffset()*1e3,e.columns&&this.setColumns(e.columns),this.relations=new t},exportData:function(){return{relations:this.relations.exportData(),columnFormats:this.columnFormats,data:this.data,columns:this.columns,mergedCells:this.mergedCells,_headers:this._headers,_footers:this._footers,_tables:this._tables,_rowInstructions:this._rowInstructions,name:this.name,id:this.id}},importData:function(e){this.relations.importData(e.relations),delete e.relations,h.extend(this,e)},setSharedStringCollection:function(e){this.sharedStrings=e},addTable:function(e){this._tables.push(e),this.relations.addRelation(e,"table")},addDrawings:function(e){this._drawings.push(e),this.relations.addRelation(e,"drawingRelationship")},setRowInstructions:function(e,t){this._rowInstructions[e]=t},setHeader:function(e){if(!h.isArray(e))throw"Invalid argument type - setHeader expects an array of three instructions";this._headers=e},setFooter:function(e){if(!h.isArray(e))throw"Invalid argument type - setFooter expects an array of three instructions";this._footers=e},compilePageDetailPackage:function(e){return e=e||"",["&L",this.compilePageDetailPiece(e[0]||""),"&C",this.compilePageDetailPiece(e[1]||""),"&R",this.compilePageDetailPiece(e[2]||"")].join("")},compilePageDetailPiece:function(e){if(h.isString(e))return'&"-,Regular"'.concat(e);if(h.isObject(e)&&!h.isArray(e)){var t,r="";return e.font||e.bold?(t=e.bold?"Bold":"Regular",r+='&"'+(e.font||"-"),r+=","+t+'"'):r+='&"-,Regular"',e.underline&&(r+="&U"),e.fontSize&&(r+="&"+e.fontSize),r+=e.text}if(h.isArray(e)){var n=this;return h.reduce(e,function(e,t){return e.concat(n.compilePageDetailPiece(t))},"")}},exportHeader:function(e){var t=e.createElement("oddHeader");return t.appendChild(e.createTextNode(this.compilePageDetailPackage(this._headers))),t},exportFooter:function(e){var t=e.createElement("oddFooter");return t.appendChild(e.createTextNode(this.compilePageDetailPackage(this._footers))),t},_buildCache:function(e){var t=e.createElement("c"),r=e.createElement("v");r.appendChild(e.createTextNode("--temp--")),t.appendChild(r);var n=e.createElement("c"),i=e.createElement("f");i.appendChild(e.createTextNode("--temp--")),n.appendChild(i);r=e.createElement("c");r.setAttribute("t","s");i=e.createElement("v");return i.appendChild(e.createTextNode("--temp--")),r.appendChild(i),{number:t,date:t,string:r,formula:n}},collectSharedStrings:function(){for(var e=this.data,t={},r=0,n=e.length;r<n;r++)for(var i=e[r],o=i.length,a=0;a<o;a++){var s=i[a],l=s&&s.metadata||{};s&&"object"==typeof s&&(s=s.value),l.type||"number"==typeof s&&(l.type="number"),"text"!==l.type&&l.type||void 0===t[s]&&(t[s]=!0)}return h.keys(t)},toXML:function(){var e=this.data,t=this.columns||[],r=k.createXmlDoc(k.schemas.spreadsheetml,"worksheet"),n=r.documentElement;n.setAttribute("xmlns:r",k.schemas.relationships),n.setAttribute("xmlns:mc",k.schemas.markupCompat),this.exportSheetProperties(r,n);var i,o=0,a=k.createElement(r,"sheetData"),s=this._buildCache(r),l=0;for(C=e.length;l<C;l++){for(var h,d=e[l],u=d.length,o=o<u?u:o,c=r.createElement("row"),p=0;p<u;p++){t[p]=t[p]||{};var f,m,g=d[p],y=g&&g.metadata||{};switch(g&&"object"==typeof g&&(g=g.value),y.type||("string"==typeof g?g&&!isNaN(+g)&&(y.type="number"):"number"==typeof g&&(y.type="number")),y.type){case"number":(f=s.number.cloneNode(!0)).firstChild.firstChild.nodeValue=g;break;case"date":(f=s.date.cloneNode(!0)).firstChild.firstChild.nodeValue=25569+(g-this._timezoneOffset)/864e5;break;case"formula":(f=s.formula.cloneNode(!0)).firstChild.firstChild.nodeValue=g;break;case"text":default:if(void 0===y.style)continue;m=void 0===this.sharedStrings.strings[g]?this.sharedStrings.addString(g):this.sharedStrings.strings[g],(f=s.string.cloneNode(!0)).firstChild.firstChild.nodeValue=m}y.style&&f.setAttribute("s",y.style),f.setAttribute("r",k.positionToLetterRef(p+1,l+1)),c.appendChild(f)}c.setAttribute("r",l+1),this._rowInstructions[l]&&(void 0!==(h=this._rowInstructions[l]).height&&(c.setAttribute("customHeight","1"),c.setAttribute("ht",h.height)),void 0!==h.style&&(c.setAttribute("customFormat","1"),c.setAttribute("s",h.style))),a.appendChild(c),d=null}if(0!==o?n.appendChild(k.createElement(r,"dimension",[["ref",k.positionToLetterRef(1,1)+":"+k.positionToLetterRef(o,e.length)]])):n.appendChild(k.createElement(r,"dimension",[["ref",k.positionToLetterRef(1,1)]])),this.exportSheetViews(r,n),this.exportSheetFormatPr(r,n),this.columns.length&&n.appendChild(this.exportColumns(r)),n.appendChild(a),0<this.mergedCells.length){for(var b=r.createElement("mergeCells"),x=0,C=this.mergedCells.length;x<C;x++){var v=r.createElement("mergeCell");v.setAttribute("ref",this.mergedCells[x][0]+":"+this.mergedCells[x][1]),b.appendChild(v)}n.appendChild(b)}if(this.exportPrintOptions(r,n),this.exportPageSettings(r,n),this.exportColBreak(r,n),this.exportRowBreak(r,n),(0<this._headers.length||0<this._footers.length)&&(i=r.createElement("headerFooter"),0<this._headers.length&&i.appendChild(this.exportHeader(r)),0<this._footers.length&&i.appendChild(this.exportFooter(r)),n.appendChild(i)),0<this._tables.length){var w=r.createElement("tableParts");for(w.setAttribute("count",this._tables.length),x=0,C=this._tables.length;x<C;x++){var S=r.createElement("tablePart");S.setAttribute("r:id",this.relations.getRelationshipId(this._tables[x])),w.appendChild(S)}n.appendChild(w)}for(x=0,C=this._drawings.length;x<C;x++){var E=r.createElement("drawing");E.setAttribute("r:id",this.relations.getRelationshipId(this._drawings[x])),n.appendChild(E)}return e=null,r},exportColumns:function(e){for(var t=k.createElement(e,"cols"),r=0,n=this.columns.length;r<n;r++){var i=this.columns[r],o=k.createElement(e,"col",[["min",i.min||r+1],["max",i.max||r+1]]);i.hidden&&o.setAttribute("hidden",1),i.bestFit&&o.setAttribute("bestFit",1),(i.customWidth||i.width)&&o.setAttribute("customWidth",1),i.width?o.setAttribute("width",i.width):(i=this._defaultColWidth,o.setAttribute("width",i||9.140625)),t.appendChild(o)}return t},exportPageSettings:function(e,t){var r=[];this._orientation&&(r.push(["orientation",this._orientation]),this._paperSize=this._paperSize||"9",r.push(["paperSize",this._paperSize]),"horizontal"===this._pageFit?r.push(["fitToHeight","0"]):"vertical"===this._pageFit&&r.push(["fitToWidth","0"]),t.appendChild(k.createElement(e,"pageSetup",r)))},exportSheetProperties:function(e,t){var r=!1;(r="paper"!==this._pageFit)&&t.appendChild(k.createElements(e,{name:"sheetPr",childs:[{name:"pageSetUpPr",attrs:[["fitToPage",r]]}]}))},exportPrintOptions:function(e,t){(this._horizontalCentered||this._verticalCentered)&&t.appendChild(k.createElements(e,{name:"printOptions",attrs:[["horizontalCentered",this._horizontalCentered],["verticalCentered",this._verticalCentered]]}))},exportSheetViews:function(e,t){t.appendChild(k.createElements(e,{name:"sheetViews",childs:[{name:"sheetView",attrs:[["workbookViewId","0"],["showGridLines",this._showGridLines?1:0],["view",this._sheetView||"normal"],["zoomScale",this._zoomScale||100]]}]}))},exportSheetFormatPr:function(e,t){var r=[];this._defaultColWidth&&r.push(["defaultColWidth",this._defaultColWidth]),this._defaultRowHeight&&r.push(["defaultRowHeight",this._defaultRowHeight]),(this._defaultColWidth||this._defaultRowHeight)&&r.push(["customHeight","1"]),r.length&&t.appendChild(k.createElements(e,{name:"sheetFormatPr",attrs:r}))},exportColBreak:function(e,t){if(0<this._colBreakCount){for(var r=[],n=0,i=this._colBreakCount;n<i;n++)r.push({name:"brk",attrs:[["id",200*(n+1)+""],["max","1048575"],["man","1"]]});t.appendChild(k.createElements(e,{name:"colBreaks",attrs:[["count",this._colBreakCount],["manualBreakCount",this._colBreakCount]],childs:r}))}},exportRowBreak:function(e,t){if(0<this._rowBreakCount){for(var r=[],n=0,i=this._rowBreakCount;n<i;n++)r.push({name:"brk",attrs:[["id",300*(n+1)+""],["max","16383"],["man","1"]]});t.appendChild(k.createElements(e,{name:"rowBreaks",attrs:[["count",this._rowBreakCount],["manualBreakCount",this._rowBreakCount]],childs:r}))}},setExportType:function(e){this._exportType=e},setPageOrientation:function(e){this._orientation=e},setPaperSize:function(e){this._paperSize=e},setPageFit:function(e){this._pageFit=e},setFitToPage:function(e){this._fitToPage=e},setPrintOptions:function(e){(e=e||{}).horizontalCentered=e.horizontalCentered||!1,e.verticalCentered=e.verticalCentered||!1,this._horizontalCentered=e.horizontalCentered,this._verticalCentered=e.verticalCentered},setFormatPr:function(e){(e=e||{}).defaultColWidth=e.defaultColWidth||8.5,e.defaultRowHeight=e.defaultRowHeight||16.5,"cell"===e.exportType&&(this._defaultColWidth=this.pixelToCol(e.cellSize),this._defaultRowHeight=this.pixelToRow(e.cellSize))},setColBreak:function(e){(e=e||{}).colBreakCount=e.colBreakCount||0,this._colBreakCount=e.colBreakCount},setRowBreak:function(e){(e=e||{}).rowBreakCount=e.rowBreakCount||0,this._rowBreakCount=e.rowBreakCount},setGridLines:function(e){this._showGridLines=e},setSheetView:function(e){this._sheetView=e},setZoomScale:function(e){e=e||1,400<(e=(e=Math.floor(100*e))<10?10:e)&&(e=400),this._zoomScale=e},setColumns:function(e){this.columns=e},setData:function(e){this.data=e},mergeCells:function(e,t){this.mergedCells.push([e,t])},pixelToCol:function(e){return e<13?.076*e*1.6:.125*e},pixelToRow:function(e){return.75*e},setColumnFormats:function(e){this.columnFormats=e}}),e}),O("Excel/Workbook",["require","underscore","./util","./StyleSheet","./Worksheet","./SharedStrings","./RelationshipManager","./Paths","./XMLDOM"],function(t,n,s,e,r,i,o,u,a){"use strict";function l(e){this.worksheets=[],this.tables=[],this.drawings=[],this.media={},this.initialize(e)}return n.extend(l.prototype,{initialize:function(){this.id=n.uniqueId("Workbook"),this.styleSheet=new e,this.sharedStrings=new i,this.relations=new o,this.relations.addRelation(this.styleSheet,"stylesheet"),this.relations.addRelation(this.sharedStrings,"sharedStrings")},createWorksheet:function(e){return e=e||{},n.defaults(e,{name:"Sheet ".concat(this.worksheets.length+1)}),new r(e)},getStyleSheet:function(){return this.styleSheet},addTable:function(e){this.tables.push(e)},addDrawings:function(e){this.drawings.push(e)},addMedia:function(e,t,r,n){var i=t.split("."),i=i[i.length-1];if(!n)switch(i.toLowerCase()){case"jpeg":case"jpg":n="image/jpeg";break;case"png":n="image/png";break;case"gif":n="image/gif";break;default:n=null}return this.media[t]||(this.media[t]={id:t,data:r,fileName:t,contentType:n,extension:i}),this.media[t]},addWorksheet:function(e){this.relations.addRelation(e,"worksheet"),e.setSharedStringCollection(this.sharedStrings),this.worksheets.push(e)},createContentTypes:function(){var e,t,r=s.createXmlDoc(s.schemas.contentTypes,"Types"),n=r.documentElement;n.appendChild(s.createElement(r,"Default",[["Extension","rels"],["ContentType","application/vnd.openxmlformats-package.relationships+xml"]])),n.appendChild(s.createElement(r,"Default",[["Extension","xml"],["ContentType","application/xml"]]));var i,o,a={};for(i in this.media)this.media.hasOwnProperty(i)&&(a[this.media[i].extension]=this.media[i].contentType);for(o in a)a.hasOwnProperty(o)&&n.appendChild(s.createElement(r,"Default",[["Extension",o],["ContentType",a[o]]]));for(n.appendChild(s.createElement(r,"Override",[["PartName","/xl/workbook.xml"],["ContentType","application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml"]])),n.appendChild(s.createElement(r,"Override",[["PartName","/xl/sharedStrings.xml"],["ContentType","application/vnd.openxmlformats-officedocument.spreadsheetml.sharedStrings+xml"]])),n.appendChild(s.createElement(r,"Override",[["PartName","/xl/styles.xml"],["ContentType","application/vnd.openxmlformats-officedocument.spreadsheetml.styles+xml"]])),e=0,t=this.worksheets.length;e<t;e++)n.appendChild(s.createElement(r,"Override",[["PartName","/xl/worksheets/sheet"+(e+1)+".xml"],["ContentType","application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml"]]));for(e=0,t=this.tables.length;e<t;e++)n.appendChild(s.createElement(r,"Override",[["PartName","/xl/tables/table"+(e+1)+".xml"],["ContentType","application/vnd.openxmlformats-officedocument.spreadsheetml.table+xml"]]));for(e=0,t=this.drawings.length;e<t;e++)n.appendChild(s.createElement(r,"Override",[["PartName","/xl/drawings/drawing"+(e+1)+".xml"],["ContentType","application/vnd.openxmlformats-officedocument.drawing+xml"]]));return r},toXML:function(){var e=s.createXmlDoc(s.schemas.spreadsheetml,"workbook"),t=e.documentElement;t.setAttribute("xmlns:r",s.schemas.relationships);for(var r=s.createElement(e,"sheets"),n=0,i=this.worksheets.length;n<i;n++){var o=e.createElement("sheet");null!=window.console&&31<this.worksheets[n].name.length&&window.console.log('Microsoft Excel requires work sheet names to be less than 32 characters long, work sheet name "'+this.worksheets[n].name+'" is '+this.worksheets[n].name.length+" characters long"),o.setAttribute("name",this.worksheets[n].name),o.setAttribute("sheetId",n+1),o.setAttribute("r:id",this.relations.getRelationshipId(this.worksheets[n])),r.appendChild(o)}return t.appendChild(r),e},createWorkbookRelationship:function(){var e=s.createXmlDoc(s.schemas.relationshipPackage,"Relationships");return e.documentElement.appendChild(s.createElement(e,"Relationship",[["Id","rId1"],["Type",s.schemas.officeDocument],["Target","xl/workbook.xml"]])),e},_generateCorePaths:function(e){var t,r,n,i;for(u[this.styleSheet.id]="styles.xml",u[this.sharedStrings.id]="sharedStrings.xml",u[this.id]="/xl/workbook.xml",t=0,r=this.tables.length;t<r;t++)e["/xl/tables/table"+(t+1)+".xml"]=this.tables[t].toXML(),u[this.tables[t].id]="/xl/tables/table"+(t+1)+".xml";for(n in this.media)this.media.hasOwnProperty(n)&&(i=this.media[n],e["/xl/media/"+n]=i.data,u[n]="/xl/media/"+n);for(t=0,r=this.drawings.length;t<r;t++)e["/xl/drawings/drawing"+(t+1)+".xml"]=this.drawings[t].toXML(),u[this.drawings[t].id]="/xl/drawings/drawing"+(t+1)+".xml",e["/xl/drawings/_rels/drawing"+(t+1)+".xml.rels"]=this.drawings[t].relations.toXML()},_prepareFilesForPackaging:function(r){n.extend(r,{"/[Content_Types].xml":this.createContentTypes(),"/_rels/.rels":this.createWorkbookRelationship(),"/xl/styles.xml":this.styleSheet.toXML(),"/xl/workbook.xml":this.toXML(),"/xl/sharedStrings.xml":this.sharedStrings.toXML(),"/xl/_rels/workbook.xml.rels":this.relations.toXML()}),n.each(r,function(e,t){-1===t.indexOf(".xml")&&-1===t.indexOf(".rels")||(r[t]=e instanceof a?e.toString():e.xml||(new window.XMLSerializer).serializeToString(e),r[t]='<?xml version="1.0" encoding="UTF-8" standalone="yes"?>\n'+r[t])})},generateFilesAsync:function(r){var e=r.requireJsPath,n=this;if(!(e=!r.requireJsPath?document.getElementById("requirejs")?document.getElementById("requirejs").src:"":e))throw"Please add 'requirejs' to the script that includes requirejs, or specify the path as an argument";var i={},o=this.worksheets.length,a=this.worksheets.length,s=[],t={status:"Not Started",terminate:function(){for(var e=0;e<s.length;e++)s[e].terminate()}};this._generateCorePaths(i);for(var l=function(t){return{error:function(){for(var e=0;e<s.length;e++)s[e].terminate();r.error.apply(this,arguments)},stringsCollected:function(){!function(){if(0==--a)for(var e=0;e<s.length;e++)s[e].postMessage({instruction:"export",sharedStrings:n.sharedStrings.exportData()})}()},finished:function(e){i["/xl/worksheets/sheet"+(t+1)+".xml"]={xml:e},u[n.worksheets[t].id]="worksheets/sheet"+(t+1)+".xml",i["/xl/worksheets/_rels/sheet"+(t+1)+".xml.rels"]=n.worksheets[t].relations.toXML(),function(){if(0==--o){n._prepareFilesForPackaging(i);for(var e=0;e<s.length;e++)s[e].terminate();r.success(i)}}()}}},h=0,d=this.worksheets.length;h<d;h++)s.push(this._createWorker(e,h,l(h)));return t},_createWorker:function(e,r,n){var i=new window.Worker(t.toUrl("./WorksheetExportWorker.js")),o=this;return i.addEventListener("error",n.error),i.addEventListener("message",function(e){switch(e.data.status){case"ready":i.postMessage({instruction:"start",data:o.worksheets[r].exportData()});break;case"sharedStrings":for(var t=0;t<e.data.data.length;t++)o.sharedStrings.addString(e.data.data[t]);n.stringsCollected();break;case"finished":n.finished(e.data.data)}},!1),i.postMessage({instruction:"setup",config:{paths:{underscore:t.toUrl("underscore").slice(0,-3)},shim:{underscore:{exports:"_"}}},requireJsPath:e}),i},generateFiles:function(){var e={};this._generateCorePaths(e);for(var t=0,r=this.worksheets.length;t<r;t++)e["/xl/worksheets/sheet"+(t+1)+".xml"]=this.worksheets[t].toXML(),u[this.worksheets[t].id]="worksheets/sheet"+(t+1)+".xml",e["/xl/worksheets/_rels/sheet"+(t+1)+".xml.rels"]=this.worksheets[t].relations.toXML();return this._prepareFilesForPackaging(e),e}}),l}),onmessage=function(e){if(e.data&&e.data.ziplib){importScripts(e.data.ziplib);var t=new JSZip,r=e.data.files;for(i in r){var n=r[i],i=i.substr(1);t.file(i,n,{base64:!1})}postMessage({base64:!!e.data.base64}),postMessage({status:"done",data:t.generate({base64:!!e.data.base64})})}},O("Excel/ZipWorker",function(){}),O("Softin/util",["underscore"],function(e){var o={getCornerInfo:function(e){var t,r="roundRect";return{corner:"object"==typeof e?(t=e.type,"top"!==e.type&&"bottom"!==e.type||(r="round2SameRect"),e.value):e,cornerType:t,presetType:r}},_ids:{},getMediaId:function(e){var t;return e=(e=encodeURI(encodeURIComponent(e))).replace(/[^a-z0-9]/gi,"_"),this._ids[e]?t=this._ids[e]:(t=this.generateGUID()+".png",this._ids[e]=t),t},generateGUID:function(){var r=(new Date).getTime();return"xxxxxxxxxxxxxxxxyxxxxxxxxxxxxxxx".replace(/[xy]/g,function(e){var t=(r+16*Math.random())%16|0;return r=Math.floor(r/16),("x"===e?t:3&t|8).toString(16)})},_hexColors:{},getHexColor:function(e){var t,r,n;if(void 0!==(n=o._hexColors[e]))return n;if(!e||"transparent"===e.toLowerCase())return"transparent";i=window,(r=(t=document).createElement("div")).style.color=e;var i=i.getComputedStyle(t.body.appendChild(r)).color.match(/\d+/g).map(function(e){return parseInt(e,10)});return t.body.removeChild(r),n=3<=i.length&&((1<<24)+(i[0]<<16)+(i[1]<<8)+i[2]).toString(16).substr(1),o._hexColors[e]=n},getFullPath:function(e){var t;return/^data:image/.test(e)?e:((t=window.document.createElement("div")).innerHTML="<a></a>",t.firstChild.href=e,t.innerHTML=t.innerHTML,t.firstChild.href)},charToNum:function(e){for(var t=0,r=0,n=1;r<n;r++,n++)e==numToChar(r)&&(n=t=r);return t},numToChar:function(e){var t=(e-1)%26,t=o.chr(65+t),e=parseInt((e-1)/26);return 0<e?o.numToChar(e)+t:t},chr:function(e){return 65535<e?(e-=65536,String.fromCharCode(55296+(e>>10),56320+(1023&e))):String.fromCharCode(e)},isUndefined:function(e){return void 0===e}};return o}),O("Softin/ImageLoader",["underscore","Softin/util"],function(e,d){function t(e){e=e||{},this.name="ImageLoader",this.unloadedImages=[],this.unloadedUrls=[],this.loadEachTargets=[],this.loadedImages={},this.imageLoadEachCount=e.imageLoadEachCount||1e3,this.imageLoadEachDelay=e.imageLoadEachDelay||200,this.timeout=6e4,this.delay=200,this.crossOrigin=e.crossOrigin||"Anonymous",this.defaultImage=e.defaultImage||"img/default.png",this.useSquareImage=void 0!==e.useSquareImage&&e.useSquareImage,this.limit=e.limit||0,this.imgInterval=null}return e.extend(t.prototype,{name:function(){return this.type+this.name},createExtractor:function(e,t){var r=new Image,n=this;try{r.crossOrigin=n.crossOrigin,r.onerror=function(){r._origin=this.src,r.src=n.defaultImage,t&&t()},r.src=e}catch(e){}return r},resize:function(e,t){var r=e.width,n=e.height,i=Math.max(e.height,e.width);return t<i&&(e.height===i?r=(n=t)/e.height*r:n=(r=t)/e.width*n),{width:r,height:n}},setSquareImage:function(e,t,r){var n,i,o,a;t.width!==t.height&&(i=t.width,o=t.height,n=Math.max(i,o),t.width=n,t.height=n,r.fillStyle="white",r.fillRect(0,0,n,n),o<i?(a=(i-o)/2,r.drawImage(e,0,a,i,o)):(a=(o-i)/2,r.drawImage(e,a,0,i,o)))},loadEach:function(e){var t,r,n,l=this;if((l.loadEachTargets.length=0)===l.unloadedUrls.length)return clearInterval(l.imgInterval),l.imgInterval=null,void(l.callback&&l.callback());for(n=l.unloadedUrls.length>l.imageLoadEachCount?l.imageLoadEachCount:l.unloadedUrls.length,l.loadEachTargets=l.unloadedUrls.splice(0,n),t=0;t<n;t++)r=l.loadEachTargets[t],l.unloadedImages.push(l.createExtractor(r));l.imgInterval=setInterval(function(){for(var t=[],e=0,r=l.unloadedImages.length;e<r;e++){var n=l.unloadedImages[e];if(n.complete&&n.src!==l.defaultImage&&0===n.width&&0===n.height)t.push(n);else if(n.complete||void 0===n.complete){var i,o,a=document.createElement("CANVAS"),s=a.getContext("2d");l.limit?(o=l.resize.call(l,n,l.limit),a.height=o.height,a.width=o.width):(a.height=n.height,a.width=n.width),l.useSquareImage&&a.width!==a.height?l.setSquareImage(n,a,s):s.drawImage(n,0,0,a.width,a.height);try{i=a.toDataURL("image/png"),n._origin?l.loadedImages[d.getMediaId(n._origin,"")]=i:l.loadedImages[d.getMediaId(n.src,"")]=i,a=n=null}catch(e){n._origin?a=n=null:(n._origin=n.src,n.src=l.defaultImage,t.push(n))}}else t.push(n)}0===(l.unloadedImages=t).length&&(clearInterval(l.imgInterval),l.imgInterval=null,l.loadEach())},l.imageLoadEachDelay)},load:function(e,t,r){var n,i,o,a,s,l=this;for(l.loadedImages={},l.unloadedUrls.length=0,l.callback=r;l.unloadedImages.pop(););for(n=0,i=e.length;n<i;n++)s=e[n],o=d.getMediaId(s,""),/^data:image/.test(s)?l.loadedImages[o]=s:t&&(a=t[o])?l.loadedImages[o]=a:-1===l.unloadedUrls.indexOf(s)&&l.unloadedUrls.push(s);l.loadEach()},load2:function(e,l){var t,r,n,h=this;for(h.loadedImages={};h.unloadedImages.pop(););for(t=0,r=e.length;t<r;t++)n=e[t],/^data:image/.test(n)?h.loadedImages[d.getMediaId(n,"")]=n:h.unloadedImages.push(h.createExtractor(n));if(0===h.unloadedImages.length)return clearInterval(h.imgInterval),h.imgInterval=null,void l();h.imgInterval=setInterval(function(){for(var t=[],e=0,r=h.unloadedImages.length;e<r;e++){var n=h.unloadedImages[e];if(n.complete&&n.src!==h.defaultImage&&0===n.width&&0===n.height)t.push(n);else if(n.complete||void 0===n.complete){var i,o,a=document.createElement("CANVAS"),s=a.getContext("2d");h.limit?(o=h.resize.call(h,n,h.limit),a.height=o.height,a.width=o.width):(a.height=n.height,a.width=n.width),h.useSquareImage&&a.width!==a.height?h.setSquareImage(n,a,s):s.drawImage(n,0,0,a.width,a.height);try{i=a.toDataURL("image/png"),n._origin?h.loadedImages[d.getMediaId(n._origin,"")]=i:h.loadedImages[d.getMediaId(n.src,"")]=i,a=n=null}catch(e){n._origin?a=n=null:(n._origin=n.src,n.src=h.defaultImage,t.push(n))}}else t.push(n)}0===t.length&&(clearInterval(h.imgInterval),h.imgInterval=null,l()),h.unloadedImages=t},h.delay)}}),t}),O("Softin/LinkDecoratorParser",["underscore"],function(e){function t(e){}return e.extend(t.prototype,{parsePoints:function(e,t){var r,n;t.flipV=!1,t.flipH=!1,r=t.firstX>=t.lastX,n=t.firstY>=t.lastY,"Top"===e.FromPort&&"Right"===e.ToPort?r&&n&&(e.rotation=108e5,t.x=t.lastX,t.y=t.lastY,t.width=t.right-t.left,t.height=t.bottom-t.top):"Top"===e.FromPort&&"Left"===e.ToPort?r&&n||r||n&&(e.rotation=0,t.flipV=!0,t.x=t.firstX,t.y=t.lastY,t.width=t.right-t.left,t.height=t.bottom-t.top):"Left"===e.FromPort&&"Right"===e.ToPort?r&&n?(e.rotation=108e5,t.x=t.lastX,t.y=t.lastY,t.width=t.right-t.left,t.height=t.bottom-t.top):r&&(e.rotation=0,t.flipH=!0,t.x=t.lastX,t.y=t.firstY,t.width=t.right-t.left,t.height=t.bottom-t.top):"Right"===e.FromPort&&"Left"===e.ToPort?r&&n||r||(n?(e.rotation=0,t.flipV=!0,t.x=t.firstX,t.y=t.lastY):(e.rotation=0,t.x=t.firstX,t.y=t.firstY),t.width=t.right-t.left,t.height=t.bottom-t.top):"Top"===e.FromPort&&"Bottom"===e.ToPort?r&&n?(e.rotation=162e5,t.flipV=!0,t.x=t.lastX,t.y=t.lastY,t.width=t.right-t.left,t.height=t.bottom-t.top):r||n&&(e.rotation=162e5,t.x=t.firstX,t.y=t.lastY,t.width=t.right-t.left,t.height=t.bottom-t.top):"Bottom"===e.FromPort&&"Left"===e.ToPort?r&&n||r||n&&(e.rotation=0,t.flipV=!0,t.x=t.firstX,t.y=t.lastY,t.width=t.right-t.left,t.height=t.bottom-t.top):"Bottom"===e.FromPort&&"Top"===e.ToPort?(t.flipV=!1,t.flipH=!1,r&&n?(e.rotation=54e5,t.flipH=!0,t.x=t.firstX,t.y=t.firstY,t.width=t.lastX-t.firstX,t.height=t.bottom-t.top):r?(e.rotation=54e5,t.x=t.lastX,t.y=t.firstY,t.width=t.firstX-t.lastX,t.height=t.bottom-t.top):n?(e.rotation=162e5,t.x=t.firstX,t.y=t.lastY,t.width=t.lastX-t.firstX,t.height=t.top-t.bottom):(e.rotation=54e5,t.flipV=!0,t.x=t.firstX,t.y=t.firstY,t.width=t.lastX-t.firstX,t.height=t.bottom-t.top)):(t.flipH=!t.flipH,t.x=t.flipH?t.firstX:t.lastX,t.y=t.firstY,t.width=t.flipH?t.lastX-t.firstX:t.firstX-t.lastX,t.height=t.bottom-t.top)},parse:function(e,t){this.parsePoints(e,t)}}),t}),O("Softin/Parser",["underscore","../Excel/util"],function(e,t){function r(e){e=e||{},this.type=e.type+""||"",this.name="Parser"}return e.extend(r.prototype,{name:function(){return this.type+this.name}}),r}),O("Softin/Property/NodeProperty",["underscore","../util","../../Excel/Positioning"],function(e,n,t){return{Opacity:{name:"Opacity",converter:function(e){return e=1e5*parseFloat(e)}},Background:{name:"Background",converter:function(e){if("string"==typeof e)return n.getHexColor(e);if(void 0===e)return e;for(var t=0,r=e.colorStops.length;t<r;t++)e.colorStops[t].value=n.getHexColor(e.colorStops[t].value);return e}},BorderBrush:{name:"BorderBrush",converter:function(e){if("string"==typeof e)return n.getHexColor(e);if(void 0===e)return e;for(var t=0,r=e.colorStops.length;t<r;t++)e.colorStops[t].value=n.getHexColor(e.colorStops[t].value);return e}},BorderThickness:{name:"BorderThickness",converter:function(e){return e=e||0,t.pixelsToEMUs(parseFloat(e))}},CornerRadius:{name:"CornerRadius",converter:function(e){var t,r;return e?(t=(e=(e+="").split(/\s/)).reduce(function(e,t){e=parseFloat(e),t=parseFloat(t);return t<e?e:t}),1<e.length?(tl=parseFloat(e[0])===t?t:0,tr=parseFloat(e[1])===t?t:0,br=parseFloat(e[2])===t?t:0,bl=parseFloat(e[3])===t?t:0,(0<tl||0<tr)&&0===bl&&0===br?r="top":(0<bl||0<br)&&0===tl&&0===tr&&(r="bottom"),{type:r,value:t}):t):0}},DashStyle:{name:"DashStyle",converter:function(e){return"dash-dot"===e?"dashDot":e||"solid"}},height:{name:"height",converter:function(e){return t.pixelsToEMUs(parseFloat(e))}},Location:{name:"Location",converter:function(e){e=e.split(" ");return{x:t.pixelsToEMUs(parseFloat(e[0])),y:t.pixelsToEMUs(parseFloat(e[1]))}}},Name:"Name",NodeID:"NodeID",Stretch:"Stretch",Type:"Type",units:"units",IsShadowed:"IsShadowed",width:{name:"width",converter:function(e){return t.pixelsToEMUs(parseFloat(e))}}}}),O("Softin/Property/UnitProperty",["underscore","../util","../../Excel/Positioning"],function(e,n,t){return{Opacity:{name:"Opacity",converter:function(e){return e=1e5*parseFloat(e)}},Background:{name:"Background",converter:function(e){if("string"==typeof e)return n.getHexColor(e);if(void 0===e)return e;for(var t=0,r=e.colorStops.length;t<r;t++)e.colorStops[t].value=n.getHexColor(e.colorStops[t].value);return e}},BorderBrush:{name:"BorderBrush",converter:function(e){if("string"==typeof e)return n.getHexColor(e);if(void 0===e)return e;for(var t=0,r=e.colorStops.length;t<r;t++)e.colorStops[t].value=n.getHexColor(e.colorStops[t].value);return e}},BorderThickness:{name:"BorderThickness",converter:function(e){return e=e||0,t.pixelsToEMUs(parseFloat(e))}},DashStyle:{name:"DashStyle",converter:function(e){return"dash-dot"===e?"dashDot":e||"solid"}},CornerRadius:{name:"CornerRadius",converter:function(e){var t,r;return e?(t=(e=(e+="").split(/\s/)).reduce(function(e,t){e=parseFloat(e),t=parseFloat(t);return t<e?e:t}),1<e.length?(tl=parseFloat(e[0])===t?t:0,tr=parseFloat(e[1])===t?t:0,br=parseFloat(e[2])===t?t:0,bl=parseFloat(e[3])===t?t:0,(0<tl||0<tr)&&0===bl&&0===br?r="top":(0<bl||0<br)&&0===tl&&0===tr&&(r="bottom"),{type:r,value:t}):t):0}},height:{name:"height",converter:function(e){return t.pixelsToEMUs(parseFloat(e))}},HorizontalAlignment:{name:"HorizontalAlignment",converter:function(e){return{center:"ctr",left:"l",right:"r"}[e]}},Position:{name:"Position",converter:function(e){e=e.split(" ");return{x:t.pixelsToEMUs(parseFloat(e[0])),y:t.pixelsToEMUs(parseFloat(e[1]))}}},Type:"Type",value:"value",VerticalAlignment:{name:"VerticalAlignment",converter:function(e){return{center:"ctr",top:"t",bottom:"b"}[e]}},width:{name:"width",converter:function(e){return t.pixelsToEMUs(parseFloat(e))}},PaddingTop:{name:"PaddingTop",converter:function(e){return t.pixelsToEMUs(parseFloat(e))||0}},PaddingRight:{name:"PaddingRight",converter:function(e){return t.pixelsToEMUs(parseFloat(e))||0}},PaddingBottom:{name:"PaddingBottom",converter:function(e){return t.pixelsToEMUs(parseFloat(e))||0}},PaddingLeft:{name:"PaddingLeft",converter:function(e){return t.pixelsToEMUs(parseFloat(e))||0}}}}),O("Softin/Property/TextProperty",["underscore","../util","./UnitProperty","../../Excel/Positioning"],function(e,n,t,r){return e.extend({MaxLines:"MaxLines",ForceWrap:"ForceWrap",FitText:"FitText",FitTextValue:"FitTextValue",AllowPadForFitText:"AllowPadForFitText",FitTextScale:{name:"FitTextScale",converter:function(e){return e=e||1,parseFloat(e)}},SpacingTop:{name:"SpacingTop",converter:function(e){return e=(e=72*parseFloat(e)/96)<1?0:e,e*=100}},SpacingBottom:{name:"SpacingBottom",converter:function(e){return e=(e=72*parseFloat(e)/96)<1?0:e,e*=100}},FontBold:{name:"FontBold",converter:function(e){return"bold"===e?1:0}},FontFamily:"FontFamily",FontSize:{name:"FontSize",converter:function(e){return e=100*(e=(e=72*parseFloat(e)/96)<1?1:e)||1100}},Foreground:{name:"Foreground",converter:function(e){if("string"==typeof e)return(e=n.getHexColor(e))&&"transparent"!==e?e:"000000";if(void 0===e)return e;for(var t=0,r=e.colorStops.length;t<r;t++)e.colorStops[t].value=n.getHexColor(e.colorStops[t].value);return e}}},t)}),O("Softin/Property/ImageProperty",["underscore","./UnitProperty"],function(e,t){return e.extend({imageStretch:"imageStretch",fillRectWRatio:"fillRectWRatio",fillRectHRatio:"fillRectHRatio"},t)}),O("Softin/Property/LinkProperty",["underscore","../util","../../Excel/Positioning"],function(e,t,m){var g={IsNotOrthogonal:"IsNotOrthogonal",IsLinkDecorator:"IsLinkDecorator",From:"From",FromPort:"FromPort",FromWidth:{name:"FromWidth",converter:function(e){return m.pixelsToEMUs(parseFloat(e))}},FromHeight:{name:"FromHeight",converter:function(e){return m.pixelsToEMUs(parseFloat(e))}},LinkColor:{name:"LinkColor",converter:function(e){return t.getHexColor(e)}},LinkBorder:{name:"LinkBorder",converter:function(e){return m.pixelsToEMUs(parseFloat(e))}},LinkCorner:"LinkCorner",LinkDashStyle:{name:"LinkDashStyle",converter:function(e){return e=(e="dash"===(e="dash-dot"===(e="dot"===e?"sysDot":e)?"sysDashDot":e)?"sysDash":e)||"solid"}},x:null,y:null,width:null,height:null,flipH:null,flipV:null,direction:null,adjust:"adjust",adjust2:"adjust2",adjust3:"adjust3",curve:"curve",Points:{name:"Points",converter:function(e){for(var t,r,n,i,o,a=null,s=null,l=null,h=null,d=[],u=[],c=e.split(" "),p=0,f=c.length;p<f;p+=2)u.push({x:c[p],y:c[p+1]}),t=m.pixelsToEMUs(parseFloat(c[p])),r=m.pixelsToEMUs(parseFloat(c[p+1])),0===p&&(n=t,i=r),a=null===a?t:Math.min(a,t),s=null===s?r:Math.min(s,r),l=null===l?t:Math.max(l,t),h=null===h?r:Math.max(h,r),r={x:t,y:r},d.push(r);return o=d[d.length-1].x,e=d[d.length-1].y,g.firstX=n,g.firstY=i,g.lastX=o,g.lastY=e,g.left=a,g.right=l,g.top=s,g.bottom=h,d}},To:"To",ToWidth:{name:"ToWidth",converter:function(e){return m.pixelsToEMUs(parseFloat(e))}},ToHeight:{name:"ToHeight",converter:function(e){return m.pixelsToEMUs(parseFloat(e))}},ToPort:"ToPort"};return g}),O("Softin/OrgParser",["underscore","./Parser","./LinkDecoratorParser","./ImageLoader","../Excel/Positioning","./Property/NodeProperty","./Property/UnitProperty","./Property/TextProperty","./Property/ImageProperty","./Property/LinkProperty","Softin/util"],function(e,t,r,n,a,s,i,o,l,h,d){function u(e){this.option=e||{},this.imageLoader=new n(e),this.linkDecoratorParser=new r}u.prototype=new t({type:"org"});var c=[],p={TextBlock:o,Image:l,Unit:i};return e.extend(t.prototype,{clear:function(){},parse:function(e,t){for(var r,n,i,o,a=this,s=e.nodes,l=e.links;c.pop(););for(i=0,o=s.length;i<o;i++)r=s[i],a.parseNode(r);for(i=0,o=l.length;i<o;i++)n=l[i],a.parseLink(n);a.imageLoader.load(c,e.imageData,function(){e.images=a.imageLoader.loadedImages,t(e)})},parseNode:function(e){var t,r,n,i;for(n in s)s[n]&&(i=s[n].converter)&&(e["_"+n]=e[n],e[n]=i(e[n]));for(t=0,r=e.units.length;t<r;t++){var o=e.units[t];this.parseUnit(o)}e.CornerRadius&&this.adjustRadius(e)},parseUnit:function(e){var t,r,n;if(e.hasOwnProperty("units"))for(t=0,r=e.units.length;t<r;t++){var i=e.units[t];this.parseUnit(i)}for(key in n=p[e.Type]||p.Unit)n[key]&&(conv=n[key].converter)&&(e["_"+key]=e[key],e[key]=conv(e[key]));e.CornerRadius&&this.adjustRadius(e),"Image"===e.Type&&(e.value=e.value||d.getFullPath(this.option.defaultImage),c.push(e.value))},parseLink:function(e){var t,r;for(t in h)h[t]&&(r=h[t].converter)&&(e[t]=r(e[t]),"Points"===t&&this.parsePoints(e,t,h))},adjustRadius:function(e){var t=e.width>e.height?e.height:e.width,r="object"==typeof e.CornerRadius;cornerRadius=r?e.CornerRadius.value:e.CornerRadius,cornerRadius=a.pixelsToEMUs(cornerRadius),value=cornerRadius>t?5e4:cornerRadius/t*5e4,value=2*Math.round(value),r?e.CornerRadius.value=value:e.CornerRadius=value},getOrthogonalCount:function(e){for(var t,r=0,n=1/0,i=1/0,o=0,a=e.length;o<a;o++)i=(n=(n===1/0&&i===1/0||(n!==e[o].x?(t&&"V"===t&&r++,t="H"):i!==e[o].y&&(t&&"H"===t&&r++,t="V")),e[o].x),e[o].y);return r},parsePoints:function(e,t,r){var n=!1,i=!1,o=e.direction,t=e[t];n=void 0!==(n=e.IsNotOrthogonal)&&n,i=void 0!==(i=e.IsLinkDecorator)&&i,r.flipH=r.firstX>=r.lastX,r.flipV=r.firstY>r.lastY,i?this.linkDecoratorParser.parse(e,r):n?(r.x=r.flipH?r.lastX:r.firstX,r.y=r.flipV?r.lastY:r.firstY,r.width=r.right-r.left,r.height=r.bottom-r.top):(r.flipH=!r.flipH,"down"===o||"up"===o?(r.x=r.flipH?r.firstX:r.lastX,r.y=r.firstY,r.width=r.flipH?r.lastX-r.firstX:r.firstX-r.lastX,r.height=r.bottom-r.top):"left"===o||"leftCenter"===o?(r.x=r.lastX,r.y=r.flipV?r.lastY:r.firstY,r.width=r.firstX-r.lastX,r.height=r.bottom-r.top):"right"!==o&&"rightCenter"!==o||(r.x=r.firstX,r.y=r.flipV?r.lastY:r.firstY,r.width=r.lastX-r.firstX,r.height=r.bottom-r.top)),8===t.length&&0===r.width&&(t[0].x===t[1].x&&t[1].x===t[2].x&&t[2].x===t[3].x&&t[3].x===t[4].x&&t[4].x===t[5].x&&t[5].x===t[6].x&&t[6].x===t[7].x||(r.width=a.pixelsToEMUs(1),r.x-=a.pixelsToEMUs(1))),e.x=r.x,e.y=r.y,e.width=r.width,e.height=r.height,e.flipH=r.flipH,e.flipV=r.flipV}}),u}),O("Softin/util",["underscore"],function(e){var o={getCornerInfo:function(e){var t,r="roundRect";return{corner:"object"==typeof e?(t=e.type,"top"!==e.type&&"bottom"!==e.type||(r="round2SameRect"),e.value):e,cornerType:t,presetType:r}},_ids:{},getMediaId:function(e){var t;return e=(e=encodeURI(encodeURIComponent(e))).replace(/[^a-z0-9]/gi,"_"),this._ids[e]?t=this._ids[e]:(t=this.generateGUID()+".png",this._ids[e]=t),t},generateGUID:function(){var r=(new Date).getTime();return"xxxxxxxxxxxxxxxxyxxxxxxxxxxxxxxx".replace(/[xy]/g,function(e){var t=(r+16*Math.random())%16|0;return r=Math.floor(r/16),("x"===e?t:3&t|8).toString(16)})},_hexColors:{},getHexColor:function(e){var t,r,n;if(void 0!==(n=o._hexColors[e]))return n;if(!e||"transparent"===e.toLowerCase())return"transparent";i=window,(r=(t=document).createElement("div")).style.color=e;var i=i.getComputedStyle(t.body.appendChild(r)).color.match(/\d+/g).map(function(e){return parseInt(e,10)});return t.body.removeChild(r),n=3<=i.length&&((1<<24)+(i[0]<<16)+(i[1]<<8)+i[2]).toString(16).substr(1),o._hexColors[e]=n},getFullPath:function(e){var t;return/^data:image/.test(e)?e:((t=window.document.createElement("div")).innerHTML="<a></a>",t.firstChild.href=e,t.innerHTML=t.innerHTML,t.firstChild.href)},charToNum:function(e){for(var t=0,r=0,n=1;r<n;r++,n++)e==numToChar(r)&&(n=t=r);return t},numToChar:function(e){var t=(e-1)%26,t=o.chr(65+t),e=parseInt((e-1)/26);return 0<e?o.numToChar(e)+t:t},chr:function(e){return 65535<e?(e-=65536,String.fromCharCode(55296+(e>>10),56320+(1023&e))):String.fromCharCode(e)},isUndefined:function(e){return void 0===e}};return o}),O("Softin/Util",function(){}),t=function(){return function n(i,o,a){function s(r,e){if(!o[r]){if(!i[r]){var t="function"==typeof h&&h;if(!e&&t)return t(r,!0);if(l)return l(r,!0);throw new Error("Cannot find module '"+r+"'")}t=o[r]={exports:{}};i[r][0].call(t.exports,function(e){var t=i[r][1][e];return s(t||e)},t,t.exports,n,i,o,a)}return o[r].exports}for(var l="function"==typeof h&&h,e=0;e<a.length;e++)s(a[e]);return s}({1:[function(e,t,r){"use strict";var d="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";r.encode=function(e,t){for(var r,n,i,o,a,s,l="",h=0;h<e.length;)i=(s=e.charCodeAt(h++))>>2,o=(3&s)<<4|(r=e.charCodeAt(h++))>>4,a=(15&r)<<2|(n=e.charCodeAt(h++))>>6,s=63&n,isNaN(r)?a=s=64:isNaN(n)&&(s=64),l=l+d.charAt(i)+d.charAt(o)+d.charAt(a)+d.charAt(s);return l},r.decode=function(e,t){var r,n,i,o,a,s="",l=0;for(e=e.replace(/[^A-Za-z0-9\+\/\=]/g,"");l<e.length;)r=d.indexOf(e.charAt(l++))<<2|(i=d.indexOf(e.charAt(l++)))>>4,n=(15&i)<<4|(o=d.indexOf(e.charAt(l++)))>>2,i=(3&o)<<6|(a=d.indexOf(e.charAt(l++))),s+=String.fromCharCode(r),64!=o&&(s+=String.fromCharCode(n)),64!=a&&(s+=String.fromCharCode(i));return s}},{}],2:[function(e,t,r){"use strict";function n(){this.compressedSize=0,this.uncompressedSize=0,this.crc32=0,this.compressionMethod=null,this.compressedContent=null}n.prototype={getContent:function(){return null},getCompressedContent:function(){return null}},t.exports=n},{}],3:[function(e,t,r){"use strict";r.STORE={magic:"\0\0",compress:function(e){return e},uncompress:function(e){return e},compressInputType:null,uncompressInputType:null},r.DEFLATE=e("./flate")},{"./flate":6}],4:[function(e,t,r){"use strict";var n=e("./utils");function i(e){this.data=null,this.length=0,this.index=0}i.prototype={checkOffset:function(e){this.checkIndex(this.index+e)},checkIndex:function(e){if(this.length<e||e<0)throw new Error("End of data reached (data length = "+this.length+", asked index = "+e+"). Corrupted zip ?")},setIndex:function(e){this.checkIndex(e),this.index=e},skip:function(e){this.setIndex(this.index+e)},byteAt:function(e){},readInt:function(e){var t,r=0;for(this.checkOffset(e),t=this.index+e-1;t>=this.index;t--)r=(r<<8)+this.byteAt(t);return this.index+=e,r},readString:function(e){return n.transformTo("string",this.readData(e))},readData:function(e){},lastIndexOfSignature:function(e){},readDate:function(){var e=this.readInt(4);return new Date(1980+(e>>25&127),(e>>21&15)-1,e>>16&31,e>>11&31,e>>5&63,(31&e)<<1)}},t.exports=i},{"./utils":14}],5:[function(e,t,r){"use strict";r.base64=!1,r.binary=!1,r.dir=!1,r.date=null,r.compression=null},{}],6:[function(e,t,r){"use strict";var n="undefined"!=typeof Uint8Array&&"undefined"!=typeof Uint16Array&&"undefined"!=typeof Uint32Array,i=e("zlibjs/bin/rawdeflate.min").Zlib,o=e("zlibjs/bin/rawinflate.min").Zlib;r.uncompressInputType=n?"uint8array":"array",r.compressInputType=n?"uint8array":"array",r.magic="\b\0",r.compress=function(e){return new i.RawDeflate(e).compress()},r.uncompress=function(e){return new o.RawInflate(e).decompress()}},{"zlibjs/bin/rawdeflate.min":19,"zlibjs/bin/rawinflate.min":20}],7:[function(e,t,r){"use strict";function n(e,t){this.files={},this.root="",e&&this.load(e,t),this.clone=function(){var e,t=new n;for(e in this)"function"!=typeof this[e]&&(t[e]=this[e]);return t}}(n.prototype=e("./object")).load=e("./load"),n.support=e("./support"),n.defaults=e("./defaults"),n.utils=e("./utils"),n.base64=e("./base64"),n.compressions=e("./compressions"),t.exports=n},{"./base64":1,"./compressions":3,"./defaults":5,"./load":8,"./object":9,"./support":12,"./utils":14}],8:[function(e,t,r){"use strict";var o=e("./base64"),a=e("./zipEntries");t.exports=function(e,t){var r,n,i;for((t=t||{}).base64&&(e=o.decode(e)),r=new a(e,t).files,n=0;n<r.length;n++)i=r[n],this.file(i.fileName,i.decompressed,{binary:!0,optimizedBinaryString:!0,date:i.date,dir:i.dir});return this}},{"./base64":1,"./zipEntries":15}],9:[function(e,t,r){"use strict";var a,l,h=e("./support"),p=e("./utils"),f=e("./signature"),o=e("./defaults"),m=e("./base64"),g=e("./compressions"),s=e("./compressedObject"),d=e("./nodeBuffer");h.uint8array&&"function"==typeof TextEncoder&&"function"==typeof TextDecoder&&(a=new TextEncoder("utf-8"),l=new TextDecoder("utf-8"));function n(e){var t;return e._data instanceof s&&(e._data=e._data.getContent(),e.options.binary=!0,e.options.base64=!1,"uint8array"===p.getTypeOf(e._data)&&(t=e._data,e._data=new Uint8Array(t.length),0!==t.length&&e._data.set(t,0))),e._data}function i(e){var t=n(e);if("string"!==p.getTypeOf(t))return t;if(!e.options.binary){if(a)return a.encode(t);if(h.nodebuffer)return d(t,"utf-8")}return e.asBinary()}function u(e){var t=n(this);return null==t?"":(this.options.base64&&(t=m.decode(t)),t=e&&this.options.binary?T.utf8decode(t):p.transformTo("string",t),t=!e&&!this.options.binary?T.utf8encode(t):t)}function c(e,t,r){this.name=e,this._data=t,this.options=r}c.prototype={asText:function(){return u.call(this,!0)},asBinary:function(){return u.call(this,!1)},asNodeBuffer:function(){var e=i(this);return p.transformTo("nodebuffer",e)},asUint8Array:function(){var e=i(this);return p.transformTo("uint8array",e)},asArrayBuffer:function(){return this.asUint8Array().buffer}};function y(e,t){for(var r="",n=0;n<t;n++)r+=String.fromCharCode(255&e),e>>>=8;return r}function b(){for(var e,t={},r=0;r<arguments.length;r++)for(e in arguments[r])arguments[r].hasOwnProperty(e)&&void 0===t[e]&&(t[e]=arguments[r][e]);return t}function x(e,t,r){var n=S(e),i=p.getTypeOf(t);if(n&&E.call(this,n),!0!==(n=(n=r)||{}).base64||null!==n.binary&&void 0!==n.binary||(n.binary=!0),(n=b(n,o)).date=n.date||new Date,null!==n.compression&&(n.compression=n.compression.toUpperCase()),(r=n).dir||null==t)r.base64=!1,r.binary=!1,t=null;else if("string"===i)r.binary&&!r.base64&&!0!==r.optimizedBinaryString&&(t=p.string2binary(t));else{if(r.base64=!1,r.binary=!0,!(i||t instanceof s))throw new Error("The data of '"+e+"' is in an unsupported format !");"arraybuffer"===i&&(t=p.transformTo("uint8array",t))}return r=new c(e,t,r),this.files[e]=r}function C(e,t){var r,n=new s;return e._data instanceof s?(n.uncompressedSize=e._data.uncompressedSize,n.crc32=e._data.crc32,0===n.uncompressedSize||e.options.dir?(t=g.STORE,n.compressedContent="",n.crc32=0):e._data.compressionMethod===t.magic?n.compressedContent=e._data.getCompressedContent():(r=e._data.getContent(),n.compressedContent=t.compress(p.transformTo(t.compressInputType,r)))):((r=i(e))&&0!==r.length&&!e.options.dir||(t=g.STORE,r=""),n.uncompressedSize=r.length,n.crc32=this.crc32(r),n.compressedContent=t.compress(p.transformTo(t.compressInputType,r))),n.compressedSize=n.compressedContent.length,n.compressionMethod=t.magic,n}function v(e,t,r,n){r.compressedContent;var i,o=this.utf8encode(t.name),a=o!==t.name,s=t.options,l="",h=s.date.getHours();h<<=6,h|=s.date.getMinutes(),h<<=5,h|=s.date.getSeconds()/2,i=s.date.getFullYear()-1980,i<<=4,i|=s.date.getMonth()+1,i<<=5,i|=s.date.getDate(),a&&(d=y(1,1)+y(this.crc32(o),4)+o,l+="up"+y(d.length,2)+d);var d="";return d+="\n\0",d+=a?"\0\b":"\0\0",d+=r.compressionMethod,d+=y(h,2),d+=y(i,2),d+=y(r.crc32,4),d+=y(r.compressedSize,4),d+=y(r.uncompressedSize,4),d+=y(o.length,2),d+=y(l.length,2),{fileRecord:f.LOCAL_FILE_HEADER+d+o+l,dirRecord:f.CENTRAL_FILE_HEADER+"\0"+d+"\0\0\0\0\0\0"+(!0===t.options.dir?"\0\0\0":"\0\0\0\0")+y(n,4)+o+l,compressedObject:r}}function w(){this.data=[]}var S=function(e){var t=(e="/"==e.slice(-1)?e.substring(0,e.length-1):e).lastIndexOf("/");return 0<t?e.substring(0,t):""},E=function(e){return"/"!=e.slice(-1)&&(e+="/"),this.files[e]||x.call(this,e,null,{dir:!0}),this.files[e]};w.prototype={append:function(e){e=p.transformTo("string",e),this.data.push(e)},finalize:function(){return this.data.join("")}};function k(e){this.data=new Uint8Array(e),this.index=0}k.prototype={append:function(e){0!==e.length&&(e=p.transformTo("uint8array",e),this.data.set(e,this.index),this.index+=e.length)},finalize:function(){return this.data}};var T={load:function(e,t){throw new Error("Load method is not defined. Is the file jszip-load.js included ?")},filter:function(e){var t,r,n,i=[];for(t in this.files)this.files.hasOwnProperty(t)&&(r=this.files[t],n=new c(r.name,r._data,b(r.options)),r=t.slice(this.root.length,t.length),t.slice(0,this.root.length)===this.root&&e(r,n)&&i.push(n));return i},file:function(r,e,t){if(1!==arguments.length)return r=this.root+r,x.call(this,r,e,t),this;if(p.isRegExp(r)){var n=r;return this.filter(function(e,t){return!t.options.dir&&n.test(e)})}return this.filter(function(e,t){return!t.options.dir&&e===r})[0]||null},folder:function(r){if(!r)return this;if(p.isRegExp(r))return this.filter(function(e,t){return t.options.dir&&r.test(e)});var e=this.root+r,t=E.call(this,e),e=this.clone();return e.root=t.name,e},remove:function(r){r=this.root+r;var e=this.files[r];if(e||("/"!=r.slice(-1)&&(r+="/"),e=this.files[r]),e)if(e.options.dir)for(var t=this.filter(function(e,t){return t.name.slice(0,r.length)===r}),n=0;n<t.length;n++)delete this.files[t[n].name];else delete this.files[r];return this},generate:function(e){e=b(e||{},{base64:!0,compression:"STORE",type:"base64"}),p.checkSupport(e.type);var t,r=[],n=0,i=0;for(t in this.files)if(this.files.hasOwnProperty(t)){var o=this.files[t],a=o.options.compression||e.compression.toUpperCase(),s=g[a];if(!s)throw new Error(a+" is not a valid compression method !");s=C.call(this,o,s),o=v.call(this,t,o,s,n);n+=o.fileRecord.length+s.compressedSize,i+=o.dirRecord.length,r.push(o)}for(var l=f.CENTRAL_DIRECTORY_END+"\0\0\0\0"+y(r.length,2)+y(r.length,2)+y(i,4)+y(n,4)+"\0\0",h=e.type.toLowerCase(),d=new("uint8array"===h||"arraybuffer"===h||"blob"===h||"nodebuffer"===h?k:w)(n+i+l.length),u=0;u<r.length;u++)d.append(r[u].fileRecord),d.append(r[u].compressedObject.compressedContent);for(u=0;u<r.length;u++)d.append(r[u].dirRecord);d.append(l);var c=d.finalize();switch(e.type.toLowerCase()){case"uint8array":case"arraybuffer":case"nodebuffer":return p.transformTo(e.type.toLowerCase(),c);case"blob":return p.arrayBuffer2Blob(p.transformTo("arraybuffer",c));case"base64":return e.base64?m.encode(c):c;default:return c}},crc32:function(e,t){if(void 0===e||!e.length)return 0;var r="string"!==p.getTypeOf(e),n=[0,1996959894,3993919788,2567524794,124634137,1886057615,3915621685,2657392035,249268274,2044508324,3772115230,2547177864,162941995,2125561021,3887607047,2428444049,498536548,1789927666,4089016648,2227061214,450548861,1843258603,4107580753,2211677639,325883990,1684777152,4251122042,2321926636,335633487,1661365465,4195302755,2366115317,997073096,1281953886,3579855332,2724688242,1006888145,1258607687,3524101629,2768942443,901097722,1119000684,3686517206,2898065728,853044451,1172266101,3705015759,2882616665,651767980,1373503546,3369554304,3218104598,565507253,1454621731,3485111705,3099436303,671266974,1594198024,3322730930,2970347812,795835527,1483230225,3244367275,3060149565,1994146192,31158534,2563907772,4023717930,1907459465,112637215,2680153253,3904427059,2013776290,251722036,2517215374,3775830040,2137656763,141376813,2439277719,3865271297,1802195444,476864866,2238001368,4066508878,1812370925,453092731,2181625025,4111451223,1706088902,314042704,2344532202,4240017532,1658658271,366619977,2362670323,4224994405,1303535960,984961486,2747007092,3569037538,1256170817,1037604311,2765210733,3554079995,1131014506,879679996,2909243462,3663771856,1141124467,855842277,2852801631,3708648649,1342533948,654459306,3188396048,3373015174,1466479909,544179635,3110523913,3462522015,1591671054,702138776,2966460450,3352799412,1504918807,783551873,3082640443,3233442989,3988292384,2596254646,62317068,1957810842,3939845945,2647816111,81470997,1943803523,3814918930,2489596804,225274430,2053790376,3826175755,2466906013,167816743,2097651377,4027552580,2265490386,503444072,1762050814,4150417245,2154129355,426522225,1852507879,4275313526,2312317920,282753626,1742555852,4189708143,2394877945,397917763,1622183637,3604390888,2714866558,953729732,1340076626,3518719985,2797360999,1068828381,1219638859,3624741850,2936675148,906185462,1090812512,3747672003,2825379669,829329135,1181335161,3412177804,3160834842,628085408,1382605366,3423369109,3138078467,570562233,1426400815,3317316542,2998733608,733239954,1555261956,3268935591,3050360625,752459403,1541320221,2607071920,3965973030,1969922972,40735498,2617837225,3943577151,1913087877,83908371,2512341634,3803740692,2075208622,213261112,2463272603,3855990285,2094854071,198958881,2262029012,4057260610,1759359992,534414190,2176718541,4139329115,1873836001,414664567,2282248934,4279200368,1711684554,285281116,2405801727,4167216745,1634467795,376229701,2685067896,3608007406,1308918612,956543938,2808555105,3495958263,1231636301,1047427035,2932959818,3654703836,1088359270,936918e3,2847714899,3736837829,1202900863,817233897,3183342108,3401237130,1404277552,615818150,3134207493,3453421203,1423857449,601450431,3009837614,3294710456,1567103746,711928724,3020668471,3272380065,1510334235,755167117];void 0===t&&(t=0);t^=-1;for(var i=0,o=e.length;i<o;i++)t=t>>>8^n[255&(t^(r?e[i]:e.charCodeAt(i)))];return-1^t},utf8encode:function(e){if(a){var t=a.encode(e);return p.transformTo("string",t)}if(h.nodebuffer)return p.transformTo("string",d(e,"utf-8"));for(var r=[],n=0,i=0;i<e.length;i++){var o=e.charCodeAt(i);o<128?r[n++]=String.fromCharCode(o):(127<o&&o<2048?r[n++]=String.fromCharCode(o>>6|192):(r[n++]=String.fromCharCode(o>>12|224),r[n++]=String.fromCharCode(o>>6&63|128)),r[n++]=String.fromCharCode(63&o|128))}return r.join("")},utf8decode:function(e){var t,r,n=[],i=0,o="string"!==p.getTypeOf(e),a=0,s=0;if(l)return l.decode(p.transformTo("uint8array",e));if(h.nodebuffer)return p.transformTo("nodebuffer",e).toString("utf-8");for(;a<e.length;)(t=o?e[a]:e.charCodeAt(a))<128?(n[i++]=String.fromCharCode(t),a++):191<t&&t<224?(s=o?e[a+1]:e.charCodeAt(a+1),n[i++]=String.fromCharCode((31&t)<<6|63&s),a+=2):(s=o?e[a+1]:e.charCodeAt(a+1),r=o?e[a+2]:e.charCodeAt(a+2),n[i++]=String.fromCharCode((15&t)<<12|(63&s)<<6|63&r),a+=3);return n.join("")}};t.exports=T},{"./base64":1,"./compressedObject":2,"./compressions":3,"./defaults":5,"./nodeBuffer":17,"./signature":10,"./support":12,"./utils":14}],10:[function(e,t,r){"use strict";r.LOCAL_FILE_HEADER="PK",r.CENTRAL_FILE_HEADER="PK",r.CENTRAL_DIRECTORY_END="PK",r.ZIP64_CENTRAL_DIRECTORY_LOCATOR="PK",r.ZIP64_CENTRAL_DIRECTORY_END="PK",r.DATA_DESCRIPTOR="PK\b"},{}],11:[function(e,t,r){"use strict";var n=e("./dataReader"),i=e("./utils");function o(e,t){this.data=e,t||(this.data=i.string2binary(this.data)),this.length=this.data.length,this.index=0}(o.prototype=new n).byteAt=function(e){return this.data.charCodeAt(e)},o.prototype.lastIndexOfSignature=function(e){return this.data.lastIndexOf(e)},o.prototype.readData=function(e){this.checkOffset(e);var t=this.data.slice(this.index,this.index+e);return this.index+=e,t},t.exports=o},{"./dataReader":4,"./utils":14}],12:[function(e,t,r){e=e("__browserify_process");if(r.base64=!0,r.array=!0,r.string=!0,r.arraybuffer="undefined"!=typeof ArrayBuffer&&"undefined"!=typeof Uint8Array,r.nodebuffer=!e.browser,r.uint8array="undefined"!=typeof Uint8Array,"undefined"==typeof ArrayBuffer)r.blob=!1;else{var n=new ArrayBuffer(0);try{r.blob=0===new Blob([n],{type:"application/zip"}).size}catch(e){try{var i=new(window.BlobBuilder||window.WebKitBlobBuilder||window.MozBlobBuilder||window.MSBlobBuilder);i.append(n),r.blob=0===i.getBlob("application/zip").size}catch(e){r.blob=!1}}}},{__browserify_process:18}],13:[function(e,t,r){"use strict";e=e("./dataReader");function n(e){e&&(this.data=e,this.length=this.data.length,this.index=0)}(n.prototype=new e).byteAt=function(e){return this.data[e]},n.prototype.lastIndexOfSignature=function(e){for(var t=e.charCodeAt(0),r=e.charCodeAt(1),n=e.charCodeAt(2),i=e.charCodeAt(3),o=this.length-4;0<=o;--o)if(this.data[o]===t&&this.data[o+1]===r&&this.data[o+2]===n&&this.data[o+3]===i)return o;return-1},n.prototype.readData=function(e){this.checkOffset(e);var t=this.data.subarray(this.index,this.index+e);return this.index+=e,t},t.exports=n},{"./dataReader":4}],14:[function(e,t,h){"use strict";var r=e("./support"),n=e("./compressions"),d=e("./nodeBuffer");function i(e){return e}function o(e,t){for(var r=0;r<e.length;++r)t[r]=255&e.charCodeAt(r);return t}function a(e){var t=65536,r=[],n=e.length,i=h.getTypeOf(e),o=0,a=!0;try{switch(i){case"uint8array":String.fromCharCode.apply(null,new Uint8Array(0));break;case"nodebuffer":String.fromCharCode.apply(null,d(0))}}catch(e){a=!1}if(!a){for(var s="",l=0;l<e.length;l++)s+=String.fromCharCode(e[l]);return s}for(;o<n&&1<t;)try{"array"===i||"nodebuffer"===i?r.push(String.fromCharCode.apply(null,e.slice(o,Math.min(o+t,n)))):r.push(String.fromCharCode.apply(null,e.subarray(o,Math.min(o+t,n)))),o+=t}catch(e){t=Math.floor(t/2)}return r.join("")}function s(e,t){for(var r=0;r<e.length;r++)t[r]=e[r];return t}h.string2binary=function(e){for(var t="",r=0;r<e.length;r++)t+=String.fromCharCode(255&e.charCodeAt(r));return t},h.string2Uint8Array=function(e){return h.transformTo("uint8array",e)},h.uint8Array2String=function(e){return h.transformTo("string",e)},h.string2Blob=function(e){e=h.transformTo("arraybuffer",e);return h.arrayBuffer2Blob(e)},h.arrayBuffer2Blob=function(t){h.checkSupport("blob");try{return new Blob([t],{type:"application/zip"})}catch(e){try{var r=new(window.BlobBuilder||window.WebKitBlobBuilder||window.MozBlobBuilder||window.MSBlobBuilder);return r.append(t),r.getBlob("application/zip")}catch(e){throw new Error("Bug : can't construct the Blob.")}}};var l={};l.string={string:i,array:function(e){return o(e,new Array(e.length))},arraybuffer:function(e){return l.string.uint8array(e).buffer},uint8array:function(e){return o(e,new Uint8Array(e.length))},nodebuffer:function(e){return o(e,d(e.length))}},l.array={string:a,array:i,arraybuffer:function(e){return new Uint8Array(e).buffer},uint8array:function(e){return new Uint8Array(e)},nodebuffer:function(e){return d(e)}},l.arraybuffer={string:function(e){return a(new Uint8Array(e))},array:function(e){return s(new Uint8Array(e),new Array(e.byteLength))},arraybuffer:i,uint8array:function(e){return new Uint8Array(e)},nodebuffer:function(e){return d(new Uint8Array(e))}},l.uint8array={string:a,array:function(e){return s(e,new Array(e.length))},arraybuffer:function(e){return e.buffer},uint8array:i,nodebuffer:function(e){return d(e)}},l.nodebuffer={string:a,array:function(e){return s(e,new Array(e.length))},arraybuffer:function(e){return l.nodebuffer.uint8array(e).buffer},uint8array:function(e){return s(e,new Uint8Array(e.length))},nodebuffer:i},h.transformTo=function(e,t){if(t=t||"",!e)return t;h.checkSupport(e);var r=h.getTypeOf(t);return l[r][e](t)},h.getTypeOf=function(e){return"string"==typeof e?"string":"[object Array]"===Object.prototype.toString.call(e)?"array":r.nodebuffer&&d.test(e)?"nodebuffer":r.uint8array&&e instanceof Uint8Array?"uint8array":r.arraybuffer&&e instanceof ArrayBuffer?"arraybuffer":void 0},h.checkSupport=function(e){if(!r[e.toLowerCase()])throw new Error(e+" is not supported by this browser")},h.MAX_VALUE_16BITS=65535,h.MAX_VALUE_32BITS=-1,h.pretty=function(e){for(var t,r="",n=0;n<(e||"").length;n++)r+="\\x"+((t=e.charCodeAt(n))<16?"0":"")+t.toString(16).toUpperCase();return r},h.findCompression=function(e){for(var t in n)if(n.hasOwnProperty(t)&&n[t].magic===e)return n[t];return null},h.isRegExp=function(e){return"[object RegExp]"===Object.prototype.toString.call(e)}},{"./compressions":3,"./nodeBuffer":17,"./support":12}],15:[function(e,t,r){"use strict";var n=e("./stringReader"),i=e("./nodeBufferReader"),o=e("./uint8ArrayReader"),a=e("./utils"),s=e("./signature"),l=e("./zipEntry"),h=e("./support");function d(e,t){this.files=[],this.loadOptions=t,e&&this.load(e)}d.prototype={checkSignature:function(e){var t=this.reader.readString(4);if(t!==e)throw new Error("Corrupted zip or bug : unexpected signature ("+a.pretty(t)+", expected "+a.pretty(e)+")")},readBlockEndOfCentral:function(){this.diskNumber=this.reader.readInt(2),this.diskWithCentralDirStart=this.reader.readInt(2),this.centralDirRecordsOnThisDisk=this.reader.readInt(2),this.centralDirRecords=this.reader.readInt(2),this.centralDirSize=this.reader.readInt(4),this.centralDirOffset=this.reader.readInt(4),this.zipCommentLength=this.reader.readInt(2),this.zipComment=this.reader.readString(this.zipCommentLength)},readBlockZip64EndOfCentral:function(){this.zip64EndOfCentralSize=this.reader.readInt(8),this.versionMadeBy=this.reader.readString(2),this.versionNeeded=this.reader.readInt(2),this.diskNumber=this.reader.readInt(4),this.diskWithCentralDirStart=this.reader.readInt(4),this.centralDirRecordsOnThisDisk=this.reader.readInt(8),this.centralDirRecords=this.reader.readInt(8),this.centralDirSize=this.reader.readInt(8),this.centralDirOffset=this.reader.readInt(8),this.zip64ExtensibleData={};for(var e,t,r,n=this.zip64EndOfCentralSize-44;0<n;)e=this.reader.readInt(2),t=this.reader.readInt(4),r=this.reader.readString(t),this.zip64ExtensibleData[e]={id:e,length:t,value:r}},readBlockZip64EndOfCentralLocator:function(){if(this.diskWithZip64CentralDirStart=this.reader.readInt(4),this.relativeOffsetEndOfZip64CentralDir=this.reader.readInt(8),this.disksCount=this.reader.readInt(4),1<this.disksCount)throw new Error("Multi-volumes zip are not supported")},readLocalFiles:function(){for(var e,t=0;t<this.files.length;t++)e=this.files[t],this.reader.setIndex(e.localHeaderOffset),this.checkSignature(s.LOCAL_FILE_HEADER),e.readLocalPart(this.reader),e.handleUTF8()},readCentralDir:function(){var e;for(this.reader.setIndex(this.centralDirOffset);this.reader.readString(4)===s.CENTRAL_FILE_HEADER;)(e=new l({zip64:this.zip64},this.loadOptions)).readCentralPart(this.reader),this.files.push(e)},readEndOfCentral:function(){var e=this.reader.lastIndexOfSignature(s.CENTRAL_DIRECTORY_END);if(-1===e)throw new Error("Corrupted zip : can't find end of central directory");if(this.reader.setIndex(e),this.checkSignature(s.CENTRAL_DIRECTORY_END),this.readBlockEndOfCentral(),this.diskNumber===a.MAX_VALUE_16BITS||this.diskWithCentralDirStart===a.MAX_VALUE_16BITS||this.centralDirRecordsOnThisDisk===a.MAX_VALUE_16BITS||this.centralDirRecords===a.MAX_VALUE_16BITS||this.centralDirSize===a.MAX_VALUE_32BITS||this.centralDirOffset===a.MAX_VALUE_32BITS){if(this.zip64=!0,-1===(e=this.reader.lastIndexOfSignature(s.ZIP64_CENTRAL_DIRECTORY_LOCATOR)))throw new Error("Corrupted zip : can't find the ZIP64 end of central directory locator");this.reader.setIndex(e),this.checkSignature(s.ZIP64_CENTRAL_DIRECTORY_LOCATOR),this.readBlockZip64EndOfCentralLocator(),this.reader.setIndex(this.relativeOffsetEndOfZip64CentralDir),this.checkSignature(s.ZIP64_CENTRAL_DIRECTORY_END),this.readBlockZip64EndOfCentral()}},prepareReader:function(e){var t=a.getTypeOf(e);"string"!==t||h.uint8array?this.reader="nodebuffer"===t?new i(e):new o(a.transformTo("uint8array",e)):this.reader=new n(e,this.loadOptions.optimizedBinaryString)},load:function(e){this.prepareReader(e),this.readEndOfCentral(),this.readCentralDir(),this.readLocalFiles()}},t.exports=d},{"./nodeBufferReader":17,"./signature":10,"./stringReader":11,"./support":12,"./uint8ArrayReader":13,"./utils":14,"./zipEntry":16}],16:[function(e,t,r){"use strict";var n=e("./stringReader"),o=e("./utils"),i=e("./compressedObject"),a=e("./object");function s(e,t){this.options=e,this.loadOptions=t}s.prototype={isEncrypted:function(){return 1==(1&this.bitFlag)},useUTF8:function(){return 2048==(2048&this.bitFlag)},prepareCompressedContent:function(r,n,i){return function(){var e=r.index;r.setIndex(n);var t=r.readData(i);return r.setIndex(e),t}},prepareContent:function(e,t,r,n,i){return function(){var e=o.transformTo(n.uncompressInputType,this.getCompressedContent()),e=n.uncompress(e);if(e.length!==i)throw new Error("Bug : uncompressed data size mismatch");return e}},readLocalPart:function(e){var t;if(e.skip(22),this.fileNameLength=e.readInt(2),t=e.readInt(2),this.fileName=e.readString(this.fileNameLength),e.skip(t),-1==this.compressedSize||-1==this.uncompressedSize)throw new Error("Bug or corrupted zip : didn't get enough informations from the central directory (compressedSize == -1 || uncompressedSize == -1)");if(null===(t=o.findCompression(this.compressionMethod)))throw new Error("Corrupted zip : compression "+o.pretty(this.compressionMethod)+" unknown (inner file : "+this.fileName+")");if(this.decompressed=new i,this.decompressed.compressedSize=this.compressedSize,this.decompressed.uncompressedSize=this.uncompressedSize,this.decompressed.crc32=this.crc32,this.decompressed.compressionMethod=this.compressionMethod,this.decompressed.getCompressedContent=this.prepareCompressedContent(e,e.index,this.compressedSize,t),this.decompressed.getContent=this.prepareContent(e,e.index,this.compressedSize,t,this.uncompressedSize),this.loadOptions.checkCRC32&&(this.decompressed=o.transformTo("string",this.decompressed.getContent()),a.crc32(this.decompressed)!==this.crc32))throw new Error("Corrupted zip : CRC32 mismatch")},readCentralPart:function(e){if(this.versionMadeBy=e.readString(2),this.versionNeeded=e.readInt(2),this.bitFlag=e.readInt(2),this.compressionMethod=e.readString(2),this.date=e.readDate(),this.crc32=e.readInt(4),this.compressedSize=e.readInt(4),this.uncompressedSize=e.readInt(4),this.fileNameLength=e.readInt(2),this.extraFieldsLength=e.readInt(2),this.fileCommentLength=e.readInt(2),this.diskNumberStart=e.readInt(2),this.internalFileAttributes=e.readInt(2),this.externalFileAttributes=e.readInt(4),this.localHeaderOffset=e.readInt(4),this.isEncrypted())throw new Error("Encrypted zip are not supported");this.fileName=e.readString(this.fileNameLength),this.readExtraFields(e),this.parseZIP64ExtraField(e),this.fileComment=e.readString(this.fileCommentLength),this.dir=!!(16&this.externalFileAttributes)},parseZIP64ExtraField:function(e){var t;this.extraFields[1]&&(t=new n(this.extraFields[1].value),this.uncompressedSize===o.MAX_VALUE_32BITS&&(this.uncompressedSize=t.readInt(8)),this.compressedSize===o.MAX_VALUE_32BITS&&(this.compressedSize=t.readInt(8)),this.localHeaderOffset===o.MAX_VALUE_32BITS&&(this.localHeaderOffset=t.readInt(8)),this.diskNumberStart===o.MAX_VALUE_32BITS&&(this.diskNumberStart=t.readInt(4)))},readExtraFields:function(e){var t,r,n,i=e.index;for(this.extraFields=this.extraFields||{};e.index<i+this.extraFieldsLength;)t=e.readInt(2),r=e.readInt(2),n=e.readString(r),this.extraFields[t]={id:t,length:r,value:n}},handleUTF8:function(){var e;this.useUTF8()?(this.fileName=a.utf8decode(this.fileName),this.fileComment=a.utf8decode(this.fileComment)):null!==(e=this.findExtraFieldUnicodePath())&&(this.fileName=e)},findExtraFieldUnicodePath:function(){var e=this.extraFields[28789];if(e){var t=new n(e.value);return 1!==t.readInt(1)?null:a.crc32(this.fileName)!==t.readInt(4)?null:a.utf8decode(t.readString(e.length-5))}return null}},t.exports=s},{"./compressedObject":2,"./object":9,"./stringReader":11,"./utils":14}],17:[function(e,t,r){},{}],18:[function(e,t,r){t=t.exports={};t.nextTick=function(){var e="undefined"!=typeof window&&window.setImmediate,t="undefined"!=typeof window&&window.postMessage&&window.addEventListener;if(e)return function(e){return window.setImmediate(e)};if(t){var r=[];return window.addEventListener("message",function(e){var t=e.source;t!==window&&null!==t||"process-tick"!==e.data||(e.stopPropagation(),0<r.length&&r.shift()())},!0),function(e){r.push(e),window.postMessage("process-tick","*")}}return function(e){setTimeout(e,0)}}(),t.title="browser",t.browser=!0,t.env={},t.argv=[],t.binding=function(e){throw new Error("process.binding is not supported")},t.cwd=function(){return"/"},t.chdir=function(e){throw new Error("process.chdir is not supported")}},{}],19:[function(e,t,r){!function(){"use strict";var ee=void 0,te=!0,o=this;function e(e,t){var r,n=e.split("."),i=o;n[0]in i||!i.execScript||i.execScript("var "+n[0]);for(;n.length&&(r=n.shift());)n.length||t===ee?i=i[r]||(i[r]={}):i[r]=t}var re="undefined"!=typeof Uint8Array&&"undefined"!=typeof Uint16Array&&"undefined"!=typeof Uint32Array&&"undefined"!=typeof DataView;function ne(e,t){if(this.index="number"==typeof t?t:0,this.d=0,this.buffer=e instanceof(re?Uint8Array:Array)?e:new(re?Uint8Array:Array)(32768),2*this.buffer.length<=this.index)throw Error("invalid index");this.buffer.length<=this.index&&l(this)}function l(e){var t,r=e.buffer,n=r.length,i=new(re?Uint8Array:Array)(n<<1);if(re)i.set(r);else for(t=0;t<n;++t)i[t]=r[t];return e.buffer=i}ne.prototype.a=function(e,t,r){var n,i=this.buffer,o=this.index,a=this.d,s=i[o];if(r&&1<t&&(e=8<t?(h[255&e]<<24|h[e>>>8&255]<<16|h[e>>>16&255]<<8|h[e>>>24&255])>>32-t:h[e]>>8-t),t+a<8)s=s<<t|e,a+=t;else for(n=0;n<t;++n)s=s<<1|e>>t-n-1&1,8==++a&&(a=0,i[o++]=h[s],s=0,o===i.length&&(i=l(this)));i[o]=s,this.buffer=i,this.d=a,this.index=o},ne.prototype.finish=function(){var e=this.buffer,t=this.index;return 0<this.d&&(e[t]<<=8-this.d,e[t]=h[e[t]],t++),re?e.subarray(0,t):(e.length=t,e)};for(var t=new(re?Uint8Array:Array)(256),r=0;r<256;++r){for(var n=a=r,i=7,a=a>>>1;a;a>>>=1)n<<=1,n|=1&a,--i;t[r]=(n<<i&255)>>>0}var h=t;function d(e){this.buffer=new(re?Uint16Array:Array)(2*e),this.length=0}function s(e,t){this.e=ie,this.f=0,this.input=re&&e instanceof Array?new Uint8Array(e):e,this.c=0,t&&(t.lazy&&(this.f=t.lazy),"number"==typeof t.compressionType&&(this.e=t.compressionType),t.outputBuffer&&(this.b=re&&t.outputBuffer instanceof Array?new Uint8Array(t.outputBuffer):t.outputBuffer),"number"==typeof t.outputIndex&&(this.c=t.outputIndex)),this.b||(this.b=new(re?Uint8Array:Array)(32768))}d.prototype.getParent=function(e){return 2*((e-2)/4|0)},d.prototype.push=function(e,t){var r,n,i=this.buffer,o=this.length;for(i[this.length++]=t,i[this.length++]=e;0<o&&(r=this.getParent(o),i[o]>i[r]);)n=i[o],i[o]=i[r],i[r]=n,n=i[o+1],i[o+1]=i[r+1],i[r+1]=n,o=r;return this.length},d.prototype.pop=function(){var e,t,r,n=this.buffer,i=n[0],o=n[1];for(this.length-=2,n[0]=n[this.length],n[1]=n[this.length+1],r=0;!((t=2*r+2)>=this.length)&&(t+2<this.length&&n[t+2]>n[t]&&(t+=2),n[t]>n[r]);)e=n[r],n[r]=n[t],n[t]=e,e=n[r+1],n[r+1]=n[t+1],n[t+1]=e,r=t;return{index:o,value:i,length:this.length}};for(var ie=2,oe=[],u=0;u<288;u++)switch(te){case u<=143:oe.push([u+48,8]);break;case u<=255:oe.push([u-144+400,9]);break;case u<=279:oe.push([u-256,7]);break;case u<=287:oe.push([u-280+192,8]);break;default:throw"invalid literal: "+u}function x(e,t){this.length=e,this.g=t}s.prototype.h=function(){var e,t,r,n=this.input;switch(this.e){case 0:for(t=0,r=n.length;t<r;){var i,o,a,s=h=re?n.subarray(t,t+65535):n.slice(t,t+65535),l=(t+=h.length)===r,h=ee,d=ee,u=this.b,c=this.c;if(re){for(u=new Uint8Array(this.b.buffer);u.length<=c+s.length+5;)u=new Uint8Array(u.length<<1);u.set(this.b)}if(i=l?1:0,u[c++]=0|i,h=65536+~(o=s.length)&65535,u[c++]=255&o,u[c++]=o>>>8&255,u[c++]=255&h,u[c++]=h>>>8&255,re)u.set(s,c),c+=s.length,u=u.subarray(0,c);else{for(d=0,a=s.length;d<a;++d)u[c++]=s[d];u.length=c}this.c=c,this.b=u}break;case 1:var p=new ne(re?new Uint8Array(this.b.buffer):this.b,this.c);p.a(1,1,te),p.a(1,2,te);for(var f,m=ae(this,n),g=0,y=m.length;g<y;g++)if(f=m[g],ne.prototype.a.apply(p,oe[f]),256<f)p.a(m[++g],m[++g],te),p.a(m[++g],5),p.a(m[++g],m[++g],te);else if(256===f)break;this.b=p.finish(),this.c=this.b.length;break;case ie:var b,x,C,v,w,S,E,k,T,I,A,P,F=new ne(re?new Uint8Array(this.b.buffer):this.b,this.c),R=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],D=Array(19),L=ie;for(F.a(1,1,te),F.a(L,2,te),b=ae(this,n),q=le(w=se(this.j,15)),L=le(S=se(this.i,7)),x=286;257<x&&0===w[x-1];x--);for(C=30;1<C&&0===S[C-1];C--);for(var B,_,M,O,N,z=x,U=C,X=new(re?Uint32Array:Array)(z+U),j=new(re?Uint32Array:Array)(316),W=new(re?Uint8Array:Array)(19),H=B=0;H<z;H++)X[B++]=w[H];for(H=0;H<U;H++)X[B++]=S[H];if(!re)for(H=0,M=W.length;H<M;++H)W[H]=0;for(H=O=0,M=X.length;H<M;H+=B){for(B=1;H+B<M&&X[H+B]===X[H];++B);if(_=B,0===X[H])if(_<3)for(;0<_--;)W[j[O++]=0]++;else for(;0<_;)(N=_-3<(N=_<138?_:138)&&N<_?_-3:N)<=10?(j[O++]=17,j[O++]=N-3,W[17]++):(j[O++]=18,j[O++]=N-11,W[18]++),_-=N;else if(j[O++]=X[H],W[X[H]]++,--_<3)for(;0<_--;)j[O++]=X[H],W[X[H]]++;else for(;0<_;)_-3<(N=_<6?_:6)&&N<_&&(N=_-3),j[O++]=16,j[O++]=N-3,W[16]++,_-=N}for(e=re?j.subarray(0,O):j.slice(0,O),E=se(W,7),A=0;A<19;A++)D[A]=E[R[A]];for(v=19;4<v&&0===D[v-1];v--);for(k=le(E),F.a(x-257,5,te),F.a(C-1,5,te),F.a(v-4,4,te),A=0;A<v;A++)F.a(D[A],3,te);for(A=0,P=e.length;A<P;A++)if(T=e[A],F.a(k[T],E[T],te),16<=T){switch(A++,T){case 16:I=2;break;case 17:I=3;break;case 18:I=7;break;default:throw"invalid code: "+T}F.a(e[A],I,te)}for(var V,Y,q=[q,w],L=[L,S],G=q[0],Z=q[1],J=L[0],K=L[1],Q=0,$=b.length;Q<$;++Q)if(V=b[Q],F.a(G[V],Z[V],te),256<V)F.a(b[++Q],b[++Q],te),Y=b[++Q],F.a(J[Y],K[Y],te),F.a(b[++Q],b[++Q],te);else if(256===V)break;this.b=F.finish(),this.c=this.b.length;break;default:throw"invalid compression type"}return this.b};var c=function(){for(var e,t=[],r=3;r<=258;r++)e=function(e){switch(te){case 3===e:return[257,e-3,0];case 4===e:return[258,e-4,0];case 5===e:return[259,e-5,0];case 6===e:return[260,e-6,0];case 7===e:return[261,e-7,0];case 8===e:return[262,e-8,0];case 9===e:return[263,e-9,0];case 10===e:return[264,e-10,0];case e<=12:return[265,e-11,1];case e<=14:return[266,e-13,1];case e<=16:return[267,e-15,1];case e<=18:return[268,e-17,1];case e<=22:return[269,e-19,2];case e<=26:return[270,e-23,2];case e<=30:return[271,e-27,2];case e<=34:return[272,e-31,2];case e<=42:return[273,e-35,3];case e<=50:return[274,e-43,3];case e<=58:return[275,e-51,3];case e<=66:return[276,e-59,3];case e<=82:return[277,e-67,4];case e<=98:return[278,e-83,4];case e<=114:return[279,e-99,4];case e<=130:return[280,e-115,4];case e<=162:return[281,e-131,5];case e<=194:return[282,e-163,5];case e<=226:return[283,e-195,5];case e<=257:return[284,e-227,5];case 258===e:return[285,e-258,0];default:throw"invalid length: "+e}}(r),t[r]=e[2]<<24|e[1]<<16|e[0];return t}(),C=re?new Uint32Array(c):c;function ae(e,t){function r(e,t){var r,n,i,o=e.g,a=[],s=0,l=C[e.length];switch(a[s++]=65535&l,a[s++]=l>>16&255,a[s++]=l>>24,te){case 1===o:r=[0,o-1,0];break;case 2===o:r=[1,o-2,0];break;case 3===o:r=[2,o-3,0];break;case 4===o:r=[3,o-4,0];break;case o<=6:r=[4,o-5,1];break;case o<=8:r=[5,o-7,1];break;case o<=12:r=[6,o-9,2];break;case o<=16:r=[7,o-13,2];break;case o<=24:r=[8,o-17,3];break;case o<=32:r=[9,o-25,3];break;case o<=48:r=[10,o-33,4];break;case o<=64:r=[11,o-49,4];break;case o<=96:r=[12,o-65,5];break;case o<=128:r=[13,o-97,5];break;case o<=192:r=[14,o-129,6];break;case o<=256:r=[15,o-193,6];break;case o<=384:r=[16,o-257,7];break;case o<=512:r=[17,o-385,7];break;case o<=768:r=[18,o-513,8];break;case o<=1024:r=[19,o-769,8];break;case o<=1536:r=[20,o-1025,9];break;case o<=2048:r=[21,o-1537,9];break;case o<=3072:r=[22,o-2049,10];break;case o<=4096:r=[23,o-3073,10];break;case o<=6144:r=[24,o-4097,11];break;case o<=8192:r=[25,o-6145,11];break;case o<=12288:r=[26,o-8193,12];break;case o<=16384:r=[27,o-12289,12];break;case o<=24576:r=[28,o-16385,13];break;case o<=32768:r=[29,o-24577,13];break;default:throw"invalid distance"}for(l=r,a[s++]=l[0],a[+s]=l[1],a[5]=l[2],n=0,i=a.length;n<i;++n)p[f++]=a[n];g[a[0]]++,y[a[3]]++,m=e.length+t-1,d=null}var n,i,o,a,s,l,h,d,u,c={},p=re?new Uint16Array(2*t.length):[],f=0,m=0,g=new(re?Uint32Array:Array)(286),y=new(re?Uint32Array:Array)(30),b=e.f;if(!re){for(o=0;o<=285;)g[o++]=0;for(o=0;o<=29;)y[o++]=0}for(g[256]=1,n=0,i=t.length;n<i;++n){for(o=s=0,a=3;o<a&&n+o!==i;++o)s=s<<8|t[n+o];if(c[s]===ee&&(c[s]=[]),l=c[s],!(0<m--)){for(;0<l.length&&32768<n-l[0];)l.shift();if(i<=n+3){for(d&&r(d,-1),o=0,a=i-n;o<a;++o)u=t[n+o],p[f++]=u,++g[u];break}0<l.length?(h=function(e,t,r){var n,i,o,a,s,l,h=0,d=e.length;a=0,l=r.length;e:for(;a<l;a++){if(n=r[l-a-1],(o=3)<h){for(s=h;3<s;s--)if(e[n+s-1]!==e[t+s-1])continue e;o=h}for(;o<258&&t+o<d&&e[n+o]===e[t+o];)++o;if(h<o&&(i=n,h=o),258===o)break}return new x(h,t-i)}(t,n,l),d?d.length<h.length?(u=t[n-1],p[f++]=u,++g[u],r(h,0)):r(d,-1):h.length<b?d=h:r(h,0)):d?r(d,-1):(u=t[n],p[f++]=u,++g[u])}l.push(n)}return p[f++]=256,g[256]++,e.j=g,e.i=y,re?p.subarray(0,f):p}function se(e,t){var r,n,i,o,a,s=e.length,l=new d(572),h=new(re?Uint8Array:Array)(s);if(!re)for(o=0;o<s;o++)h[o]=0;for(o=0;o<s;++o)0<e[o]&&l.push(o,e[o]);if(r=Array(l.length/2),n=new(re?Uint32Array:Array)(l.length/2),1===r.length)return h[l.pop().index]=1,h;for(o=0,a=l.length/2;o<a;++o)r[o]=l.pop(),n[o]=r[o].value;for(i=function(e,n,t){var r,i,o,a,s,l=new(re?Uint16Array:Array)(t),h=new(re?Uint8Array:Array)(t),d=new(re?Uint8Array:Array)(n),u=Array(t),c=Array(t),p=Array(t),f=(1<<t)-n,m=1<<t-1;for(l[t-1]=n,i=0;i<t;++i)f<m?h[i]=0:(h[i]=1,f-=m),f<<=1,l[t-2-i]=(l[t-1-i]/2|0)+n;for(l[0]=h[0],u[0]=Array(l[0]),c[0]=Array(l[0]),i=1;i<t;++i)l[i]>2*l[i-1]+h[i]&&(l[i]=2*l[i-1]+h[i]),u[i]=Array(l[i]),c[i]=Array(l[i]);for(r=0;r<n;++r)d[r]=t;for(o=0;o<l[t-1];++o)u[t-1][o]=e[o],c[t-1][o]=o;for(r=0;r<t;++r)p[r]=0;for(1===h[t-1]&&(--d[0],++p[t-1]),i=t-2;0<=i;--i){for(a=r=0,s=p[i+1],o=0;o<l[i];o++)(a=u[i+1][s]+u[i+1][s+1])>e[r]?(u[i][o]=a,c[i][o]=n,s+=2):(u[i][o]=e[r],c[i][o]=r,++r);p[i]=0,1===h[i]&&function e(t){var r=c[t][p[t]];r===n?(e(t+1),e(t+1)):--d[r],++p[t]}(i)}return d}(n,n.length,t),o=0,a=r.length;o<a;++o)h[r[o].index]=i[o];return h}function le(e){for(var t,r,n=new(re?Uint16Array:Array)(e.length),i=[],o=[],a=0,s=0,l=e.length;s<l;s++)i[e[s]]=1+(0|i[e[s]]);for(s=1,l=16;s<=l;s++)o[s]=a,a+=0|i[s],a<<=1;for(s=0,l=e.length;s<l;s++)for(a=o[e[s]],o[e[s]]+=1,t=n[s]=0,r=e[s];t<r;t++)n[s]=n[s]<<1|1&a,a>>>=1;return n}e("Zlib.RawDeflate",s),e("Zlib.RawDeflate.prototype.compress",s.prototype.h);var p,f,m,g,y={NONE:0,FIXED:1,DYNAMIC:ie};if(Object.keys)p=Object.keys(y);else for(f in p=[],m=0,y)p[m++]=f;for(m=0,g=p.length;m<g;++m)e("Zlib.RawDeflate.CompressionType."+(f=p[m]),y[f])}.call(this)},{}],20:[function(e,t,r){!function(){"use strict";var o=this;function e(e,t){var r,n=e.split("."),i=o;n[0]in i||!i.execScript||i.execScript("var "+n[0]);for(;n.length&&(r=n.shift());)n.length||void 0===t?i=i[r]||(i[r]={}):i[r]=t}var p="undefined"!=typeof Uint8Array&&"undefined"!=typeof Uint16Array&&"undefined"!=typeof Uint32Array&&"undefined"!=typeof DataView;function d(e){for(var t,r,n,i,o,a,s,l,h=e.length,d=0,u=Number.POSITIVE_INFINITY,c=0;c<h;++c)e[c]>d&&(d=e[c]),e[c]<u&&(u=e[c]);for(t=1<<d,r=new(p?Uint32Array:Array)(t),n=1,i=0,o=2;n<=d;){for(c=0;c<h;++c)if(e[c]===n){for(s=i,l=a=0;l<n;++l)a=a<<1|1&s,s>>=1;for(l=a;l<t;l+=o)r[l]=n<<16|c;++i}++n,i<<=1,o<<=1}return[r,d,u]}function t(e,t){switch(this.g=[],this.h=32768,this.c=this.f=this.d=this.k=0,this.input=p?new Uint8Array(e):e,this.l=!1,this.i=1,this.p=!1,t?(t.index&&(this.d=t.index),t.bufferSize&&(this.h=t.bufferSize),t.bufferType&&(this.i=t.bufferType),t.resize&&(this.p=t.resize)):t={},this.i){case 0:this.a=32768,this.b=new(p?Uint8Array:Array)(32768+this.h+258);break;case 1:this.a=0,this.b=new(p?Uint8Array:Array)(this.h),this.e=this.u,this.m=this.r,this.j=this.s;break;default:throw Error("invalid inflate mode")}}t.prototype.t=function(){for(;!this.l;){var e=x(this,3);switch(1&e&&(this.l=!0),e>>>=1){case 0:var t=this.input,r=this.d,n=this.b,i=this.a,o=t.length,a=void 0,s=n.length,l=void 0;if(this.c=this.f=0,o<=r+1)throw Error("invalid uncompressed block header: LEN");if(a=t[r++]|t[r++]<<8,o<=r+1)throw Error("invalid uncompressed block header: NLEN");if(a===~(t[r++]|t[r++]<<8))throw Error("invalid uncompressed block header: length verify");if(r+a>t.length)throw Error("input buffer is broken");switch(this.i){case 0:for(;i+a>n.length;){if(a-=l=s-i,p)n.set(t.subarray(r,r+l),i),i+=l,r+=l;else for(;l--;)n[i++]=t[r++];this.a=i,n=this.e(),i=this.a}break;case 1:for(;i+a>n.length;)n=this.e({o:2});break;default:throw Error("invalid inflate mode")}if(p)n.set(t.subarray(r,r+a),i),i+=a,r+=a;else for(;a--;)n[i++]=t[r++];this.d=r,this.a=i,this.b=n;break;case 1:this.j(g,b);break;case 2:!function(e){function t(e,t,r){for(var n,i,o,a=0;a<e;)switch(n=C(this,t),n){case 16:for(o=3+x(this,2);o--;)r[a++]=i;break;case 17:for(o=3+x(this,3);o--;)r[a++]=0;i=0;break;case 18:for(o=11+x(this,7);o--;)r[a++]=0;i=0;break;default:i=r[a++]=n}return r}var r,n,i,o,a=x(e,5)+257,s=x(e,5)+1,l=x(e,4)+4,h=new(p?Uint8Array:Array)(u.length);for(o=0;o<l;++o)h[u[o]]=x(e,3);if(!p)for(o=l,l=h.length;o<l;++o)h[u[o]]=0;r=d(h),n=new(p?Uint8Array:Array)(a),i=new(p?Uint8Array:Array)(s),e.j(d(t.call(e,a,r,n)),d(t.call(e,s,r,i)))}(this);break;default:throw Error("unknown BTYPE: "+e)}}return this.m()};for(var r=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],u=p?new Uint16Array(r):r,r=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258,258,258],h=p?new Uint16Array(r):r,r=[0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0,0,0],c=p?new Uint8Array(r):r,r=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577],f=p?new Uint16Array(r):r,r=[0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13],m=p?new Uint8Array(r):r,n=new(p?Uint8Array:Array)(288),i=0,a=n.length;i<a;++i)n[i]=i<=143?8:i<=255?9:i<=279?7:8;for(var g=d(n),s=new(p?Uint8Array:Array)(30),l=0,y=s.length;l<y;++l)s[l]=5;var b=d(s);function x(e,t){for(var r,n=e.f,i=e.c,o=e.input,a=e.d,s=o.length;i<t;){if(s<=a)throw Error("input buffer is broken");n|=o[a++]<<i,i+=8}return r=n&(1<<t)-1,e.f=n>>>t,e.c=i-t,e.d=a,r}function C(e,t){for(var r=e.f,n=e.c,i=e.input,o=e.d,a=i.length,s=t[0],l=t[1];n<l&&!(a<=o);)r|=i[o++]<<n,n+=8;return s=(t=s[r&(1<<l)-1])>>>16,e.f=r>>s,e.c=n-s,e.d=o,65535&t}t.prototype.j=function(e,t){var r=this.b,n=this.a;this.n=e;for(var i,o,a,s,l=r.length-258;256!==(i=C(this,e));)if(i<256)l<=n&&(this.a=n,r=this.e(),n=this.a),r[n++]=i;else for(s=h[o=i-257],0<c[o]&&(s+=x(this,c[o])),i=C(this,t),a=f[i],0<m[i]&&(a+=x(this,m[i])),l<=n&&(this.a=n,r=this.e(),n=this.a);s--;)r[n]=r[n++-a];for(;8<=this.c;)this.c-=8,this.d--;this.a=n},t.prototype.s=function(e,t){var r=this.b,n=this.a;this.n=e;for(var i,o,a,s,l=r.length;256!==(i=C(this,e));)if(i<256)l<=n&&(l=(r=this.e()).length),r[n++]=i;else for(s=h[o=i-257],0<c[o]&&(s+=x(this,c[o])),i=C(this,t),a=f[i],0<m[i]&&(a+=x(this,m[i])),l<n+s&&(l=(r=this.e()).length);s--;)r[n]=r[n++-a];for(;8<=this.c;)this.c-=8,this.d--;this.a=n},t.prototype.e=function(){var e,t,r=new(p?Uint8Array:Array)(this.a-32768),n=this.a-32768,i=this.b;if(p)r.set(i.subarray(32768,r.length));else for(e=0,t=r.length;e<t;++e)r[e]=i[e+32768];if(this.g.push(r),this.k+=r.length,p)i.set(i.subarray(n,32768+n));else for(e=0;e<32768;++e)i[e]=i[n+e];return this.a=32768,i},t.prototype.u=function(e){var t,r=this.input.length/this.d+1|0,n=this.input,i=this.b;return e&&("number"==typeof e.o&&(r=e.o),"number"==typeof e.q&&(r+=e.q)),r=r<2?(n=(n.length-this.d)/this.n[2]/2*258|0)<i.length?i.length+n:i.length<<1:i.length*r,p?(t=new Uint8Array(r)).set(i):t=i,this.b=t},t.prototype.m=function(){var e,t,r,n,i,o=0,a=this.b,s=this.g,l=new(p?Uint8Array:Array)(this.k+(this.a-32768));if(0===s.length)return p?this.b.subarray(32768,this.a):this.b.slice(32768,this.a);for(t=0,r=s.length;t<r;++t)for(n=0,i=(e=s[t]).length;n<i;++n)l[o++]=e[n];for(t=32768,r=this.a;t<r;++t)l[o++]=a[t];return this.g=[],this.buffer=l},t.prototype.r=function(){var e,t=this.a;return p?this.p?(e=new Uint8Array(t)).set(this.b.subarray(0,t)):e=this.b.subarray(0,t):(this.b.length>t&&(this.b.length=t),e=this.b),this.buffer=e},e("Zlib.RawInflate",t),e("Zlib.RawInflate.prototype.decompress",t.prototype.t);var v,w,S,E,k={ADAPTIVE:1,BLOCK:0};if(Object.keys)v=Object.keys(k);else for(w in v=[],S=0,k)v[S++]=w;for(S=0,E=v.length;S<E;++S)e("Zlib.RawInflate.BufferType."+(w=v[S]),k[w])}.call(this)},{}]},{},[7])(7)},"object"==typeof exports?module.exports=t():O.amd?O("JSZip",t):"undefined"!=typeof window?window.JSZip=t():"undefined"!=typeof global?global.JSZip=t():"undefined"!=typeof self&&(self.JSZip=t()),O("excel-builder",["require","underscore","./Excel/Workbook","JSZip"],function(n,o,e,a){return{createWorkbook:function(){return new e},createFileAsync:function(e,r){e.generateFilesAsync({success:function(e){var t=new Worker(n.toUrl("./Excel/ZipWorker.js"));t.addEventListener("message",function(e,t){"done"==e.data.status&&r.success(e.data.data)}),t.postMessage({files:e,ziplib:n.toUrl("JSZip"),base64:!r||!1!==r.base64})},error:function(){r.error()}})},createFile:function(e,t){var r,n=new a,i=e.generateFiles();for(r in o.each(i,function(e,t){-1!==(t=t.substr(1)).indexOf(".xml")||-1!==t.indexOf(".rel")?n.file(t,e,{base64:!1}):n.file(t,e,{base64:!0,binary:!0}),t=e=null}),i)i[r]=null,delete i[r];return n.generate(o.defaults(t||{},{type:"blob"}))}}}),O("Softin/XML/CellUnitBuilder",["underscore","../util","../../Excel/Positioning","../../excel-builder","../../Excel/Workbook"],function(e,t,r,n,i){function o(e){e=e||{},this.workbook=e.workbook||null,this.worksheet=e.worksheet||null,this.stylesheet=e.stylesheet||null,this.cellBuilder=e.cellBuilder||null,this.cellNodeBuilder=e.cellNodeBuilder||null}return e.extend(o.prototype,{build:function(e,t,r){var n=this,i=(n.cellBuilder,"List"===e.Type||"Grid"===e.Type),o=e.cellInfo;"TextBlock"!==e.Type||n.intersect(r,e)||n.worksheet.mergeCells(o.cellPosS,o.cellPosE),n.cellBuilder.setCellInfo({value:e.value,type:"unit",fontSize:i?"":e.FontSize/100,fontName:e.FontFamily,fontBold:e.FontBold,fontColor:e.Foreground,backgroundColor:e.Background,borderStyle:"solid"===e.DashStyle?"thin":"dotted",borderColor:e.BorderBrush,borderWidth:e.BorderThickness,verticalAlign:e.VerticalAlignment,horizontalAlign:e.HorizontalAlignment,fitText:e.FitText,fitTextScale:e.FitTextScale},o.unitX,o.unitY,o.unitW,o.unitH),i&&n.buildUnits(e,t,r)},buildUnits:function(e,t){var r,n,i,o=e.units;if(o&&o.length)for(r=0,n=o.length;r<n;r++)i=o[r],this.build(i,t,o)},intersect:function(e,t){for(var r,n=0,i=e.length;n<i;n++)if(r=e[n],(t.cellInfo.cellPosS!==r.cellInfo.cellPosS||t.cellInfo.cellPosE!==r.cellInfo.cellPosE)&&t.cellInfo.unitX<=r.cellInfo.unitX&&t.cellInfo.unitY<=r.cellInfo.unitY&&t.cellInfo.unitX+t.cellInfo.unitW>=r.cellInfo.unitX+r.cellInfo.unitW&&t.cellInfo.unitY+t.cellInfo.unitH>=r.cellInfo.unitY+r.cellInfo.unitH)return!0;return!1}}),o}),O("Softin/XML/CellNodeBuilder",["underscore","../util","../../Excel/Positioning","../../excel-builder","../../Excel/Workbook","./CellUnitBuilder"],function(e,t,r,n,i,o){function a(e){e=e||{},this.workbook=e.workbook||null,this.worksheet=e.worksheet||null,this.stylesheet=e.stylesheet||null,this.cellBuilder=e.cellBuilder||null,this.cellUnitBuilder=new o({workbook:this.workbook,stylesheet:this.stylesheet,worksheet:this.worksheet,cellBuilder:this.cellBuilder,cellNodeBuilder:this})}return e.extend(a.prototype,{build:function(e,t){var r;this.cellBuilder;this.buildUnits(e,{nodeX:e.Location.x,nodeY:e.Location.y}),r=e.cellInfo,this.cellBuilder.setCellInfo({type:"node",backgroundColor:e.Background,borderStyle:"solid"===e.DashStyle?"thin":"dotted",borderColor:e.BorderBrush,borderWidth:e.BorderThickness,verticalAlign:e.VerticalAlignment,horizontalAlign:e.HorizontalAlignment,fitText:e.FitText,fitTextScale:e.FitTextScale},r.nodeX,r.nodeY,r.nodeW,r.nodeH)},buildUnits:function(e,t){var r,n,i,o=e.units;if(o&&o.length)for(r=0,n=o.length;r<n;r++)i=o[r],this.cellUnitBuilder.build(i,t,o)}}),a}),O("Softin/XML/CellLinkBuilder",["underscore","../util","../../Excel/Positioning","../../excel-builder","../../Excel/Workbook"],function(e,t,r,n,i){function o(e){e=e||{},this.workbook=e.workbook||null,this.worksheet=e.worksheet||null,this.stylesheet=e.stylesheet||null,this.cellBuilder=e.cellBuilder||null}return e.extend(o.prototype,{getLineDirection:function(e,t){var r="",n=t.x-e.x,e=t.y-e.y;return 0==n&&0==e||(0<n?r="right":n<0?r="left":0<e?r="down":e<0&&(r="top")),r},getLineBorder:function(e){var t="left";return"down"===e?t="left":"left"!==e&&"right"!==e||(t="top"),t},getLines:function(e){for(var t,r,n,i=[],o=0,a=e.length;o<a;o++)t=e[o],(r=e[o+1])&&(r={pointS:t,pointE:r,direction:r=this.getLineDirection(t,r),border:this.getLineBorder(r)},i.length&&(n=i[i.length-1]).direction===r.direction&&(r.pointS=n.pointS,i.pop()),i.push(r));return i},build:function(e,t){this.cellBuilder;e.borderWidth=e.LinkBorder,e.type="link",this.drawLine(e,e.cellInfo.points)},drawLine:function(e,t){for(var r,n=this.getLines(t),i=0,o=n.length;i<o;i++)r=n[i],this.cellBuilder._drawLine(e,r)}}),o}),O("Softin/XML/CellBuilder",["underscore","../util","../../Excel/Positioning","../../excel-builder","../../Excel/Workbook","./CellNodeBuilder","./CellLinkBuilder"],function(e,o,t,r,n,i,a){function s(e){this.CELL_SIZE=4,this.SHEET_DATA_GAP=3,this.STYLE_PROP={fontBold:0,fontColor:1,fontName:2,fontSize:3,backgroundColor:4,verticalAlign:5,horizontalAlign:6,fitText:7,fitTextScale:8,borderTopStyle:9,borderTopColor:10,borderRightStyle:11,borderRightColor:12,borderBottomStyle:13,borderBottomColor:14,borderLeftStyle:15,borderLeftColor:16},e=e||{},this.workbook=e.workbook||null,this.worksheet=e.worksheet||null,this.stylesheet=e.stylesheet||null,this.lineMap={},this.styleMap={},this.valueMap={},this.cellInfoMap={},this.styleTargets=[],this.styleTargetsMap={},this.cellNodeBuilder=new i({workbook:this.workbook,stylesheet:this.stylesheet,worksheet:this.worksheet,cellBuilder:this}),this.cellLinkBuilder=new a({workbook:this.workbook,stylesheet:this.stylesheet,worksheet:this.worksheet,cellBuilder:this})}return e.extend(s.prototype,{build:function(e,t){var r=this;r.CELL_SIZE=t.cellSize||4,r.styleTargets.length=r.stylesheet.masterCellFormats.length,r.getCellMatrix(e),r.setStyle(),r.setSheetData(e)},parseNum:function(e){return Math.round(t.emusToPixels(e)/this.CELL_SIZE)},parseNum2:function(e){return t.emusToPixels(e)/this.CELL_SIZE},getStylekey:function(e,t,r){var n,i=[];return r?(n=r.data,r=r.border,i.push(o.isUndefined(e.fontBold)?n.fontBold||"":e.fontBold!==n.fontBold?e.fontBold:""),i.push(o.isUndefined(e.fontColor)?n.fontColor||"":e.fontColor!==n.fontColor?e.fontColor:""),i.push(o.isUndefined(e.fontName)?n.fontName||"":e.fontName!==n.fontName?e.fontName:""),i.push(o.isUndefined(e.fontSize)?n.fontSize||"":e.fontSize!==n.fontSize?e.fontSize:""),i.push("transparent"===e.backgroundColor?n.backgroundColor||"":e.backgroundColor||n.backgroundColor||""),i.push(e.verticalAlign||n.verticalAlign||""),i.push(e.horizontalAlign||n.horizontalAlign||""),i.push(e.fitText||n.fitText||""),i.push(e.fitTextScale||n.fitTextScale||""),0<e.borderWidth?(i.push(t.top?t.top.borderStyle||r.top.borderStyle||"":r.top&&r.top.borderStyle||""),i.push(t.top?t.top.borderColor||r.top.borderColor||"":r.top&&r.top.borderColor||""),i.push(t.right?t.right.borderStyle||r.right.borderStyle||"":r.right&&r.right.borderStyle||""),i.push(t.right?t.right.borderColor||r.right.borderColor||"":r.right&&r.right.borderColor||""),i.push(t.bottom?t.bottom.borderStyle||r.bottom.borderStyle||"":r.bottom&&r.bottom.borderStyle||""),i.push(t.bottom?t.bottom.borderColor||r.bottom.borderColor||"":r.bottom&&r.bottom.borderColor||""),i.push(t.left?t.left.borderStyle||r.left.borderStyle||"":r.left&&r.left.borderStyle||""),i.push(t.left?t.left.borderColor||r.left.borderColor||"":r.left&&r.left.borderColor||"")):(i.push(r.top&&r.top.borderStyle||""),i.push(r.top&&r.top.borderColor||""),i.push(r.right&&r.right.borderStyle||""),i.push(r.right&&r.right.borderColor||""),i.push(r.bottom&&r.bottom.borderStyle||""),i.push(r.bottom&&r.bottom.borderColor||""),i.push(r.left&&r.left.borderStyle||""),i.push(r.left&&r.left.borderColor||""))):(i.push(e.fontBold||""),i.push(e.fontColor||""),i.push(e.fontName||""),i.push(e.fontSize||""),i.push(e.backgroundColor||""),i.push(e.verticalAlign||""),i.push(e.horizontalAlign||""),i.push(e.fitText||""),i.push(e.fitTextScale||""),0<e.borderWidth?(i.push(t.top&&t.top.borderStyle||""),i.push(t.top&&t.top.borderColor||""),i.push(t.right&&t.right.borderStyle||""),i.push(t.right&&t.right.borderColor||""),i.push(t.bottom&&t.bottom.borderStyle||""),i.push(t.bottom&&t.bottom.borderColor||""),i.push(t.left&&t.left.borderStyle||""),i.push(t.left&&t.left.borderColor||"")):(i.push(""),i.push(""),i.push(""),i.push(""),i.push(""),i.push(""),i.push(""),i.push(""))),i.join("_")},findStyle:function(e,t,r){var n=-1,i=this;return styleProp=i.STYLE_PROP,styleKey=i.getStylekey(e,t,r),(n=i.styleTargetsMap[styleKey])||(n=i.styleTargets.length,i.styleTargetsMap[styleKey]=n,r=styleKey.split("_"),e={type:e.type,fontBold:r[styleProp.fontBold],fontColor:r[styleProp.fontColor],fontName:r[styleProp.fontName],fontSize:r[styleProp.fontSize],backgroundColor:r[styleProp.backgroundColor],verticalAlign:r[styleProp.verticalAlign],horizontalAlign:r[styleProp.horizontalAlign],fitText:r[styleProp.fitText],fitTextScale:r[styleProp.fitTextScale]},t={},(r[styleProp.borderTopStyle]||r[styleProp.borderTopColor])&&(t.top={borderStyle:r[styleProp.borderTopStyle],borderColor:r[styleProp.borderTopColor]}),(r[styleProp.borderRightStyle]||r[styleProp.borderRightColor])&&(t.right={borderStyle:r[styleProp.borderRightStyle],borderColor:r[styleProp.borderRightColor]}),(r[styleProp.borderBottomStyle]||r[styleProp.borderBottomColor])&&(t.bottom={borderStyle:r[styleProp.borderBottomStyle],borderColor:r[styleProp.borderBottomColor]}),(r[styleProp.borderLeftStyle]||r[styleProp.borderLeftColor])&&(t.left={borderStyle:r[styleProp.borderLeftStyle],borderColor:r[styleProp.borderLeftColor]}),i.styleTargets.push({data:e,border:t})),n},setCellBorderInfo:function(e,t,r,n,i,o,a,s){var l=i+a-1,a=o,s=o+s-1;r===i&&(e.left={borderStyle:t.borderStyle,borderColor:t.borderColor}),r===l&&(e.right={borderStyle:t.borderStyle,borderColor:t.borderColor}),n===a&&(e.top={borderStyle:t.borderStyle,borderColor:t.borderColor}),n===s&&(e.bottom={borderStyle:t.borderStyle,borderColor:t.borderColor})},getCellInfo:function(e,t,r){var e=this.cellInfoMap[e]||{},n=e.styleId?this.styleTargets[e.styleId]:n,n=this.findStyle(t,r,n);return e.styleId=n,e},setCellInfo:function(e,t,r,n,i){for(var o,a,s,l,h=t+n,d=r+i,u=t;u<h;u++)for(o=r;o<d;o++)a=u+"-"+o,l={},0<e.borderWidth&&this.setCellBorderInfo(l,e,u,o,t,r,n,i),s=this.getCellInfo(a,e,l),u===t&&o===r&&!s.value&&e.value&&(s.value=e.value),this.cellInfoMap[a]=s},_drawLine:function(e,t){var r,n,i,o,a,s,l,h,d,u,c,p=["top","right","bottom","left"],f=this;for("down"===t.direction?(a=t.pointE.y-t.pointS.y,i=t.pointS):"left"===t.direction?(a=t.pointS.x-t.pointE.x,i=t.pointE):"right"===t.direction&&(a=t.pointE.x-t.pointS.x,i=t.pointS),l="solid"===e.LinkDashStyle?"thin":"dotted",h=e.LinkColor,r=0,n=a;r<n;r++)if(borderName=t.border,"down"===t.direction?cellPos=i.x+"-"+(i.y+r):"left"!==t.direction&&"right"!==t.direction||(cellPos=i.x+r+"-"+i.y),s=f.cellInfoMap[cellPos]){if((u=f.styleTargets[s.styleId])&&"link"===u.data.type){if((d={})[borderName]={borderStyle:l,borderColor:h},u.border)for(o in p)p[o]!==borderName&&(c=u.border[p[o]])&&(d[p[o]]={borderStyle:c.borderStyle,borderColor:c.borderColor});s.styleId=f.findStyle(e,d,u),f.cellInfoMap[cellPos]=s}}else(d={})[borderName]={borderStyle:l,borderColor:h},f.cellInfoMap[cellPos]={styleId:f.findStyle(e,d)}},setBorderStyle:function(e,t){var r,n,i,o=["top","right","bottom","left"];if(t.border)for(e.border={},n=0,i=o.length;n<i;n++)r=o[n],t.border[r]&&(e.border[r]={style:t.border[r].borderStyle,color:t.border[r].borderColor})},setAlignmentStyle:function(e,t){var r={ctr:"center",r:"right",l:"left",t:"top",b:"bottom"};e.alignment={horizontal:r[t.horizontalAlign]||"center",vertical:r[t.verticalAlign]||"center"},t.fitText?(e.alignment.shrinkToFit=1)===t.fitTextScale&&(e.alignment.horizontal="distributed"):e.alignment.wrapText=1},setStyle:function(){for(var e,t,r=this,n=0,i=r.styleTargets.length;n<i;n++)(e=r.styleTargets[n])&&(t={},r.setAlignmentStyle(t,e.data),t.font={bold:isNaN(e.data.fontBold)?0:+e.data.fontBold,color:e.data.fontColor,size:e.data.fontSize,fontName:e.data.fontName},e.data.backgroundColor&&"transparent"!==e.data.backgroundColor&&(t.fill={type:"pattern",patternType:"solid",fgColor:e.data.backgroundColor}),r.setBorderStyle(t,e),r.stylesheet.createFormat(t))},getCellMatrix:function(e){for(var t,r,n=e.nodes,i=e.links,o=0,a=n.length;o<a;o++)t=n[o],this.cellNodeBuilder.build(t);for(o=n.length=0,a=i.length;o<a;o++)r=i[o],this.cellLinkBuilder.build(r);i.length=0},setSheetData:function(e){for(var t,r,n,i=[],o=[],a=0,s=0,l=this,h=e.diagram.rect,e=h.right-h.left,h=h.bottom-h.top,d=parseInt(h/l.CELL_SIZE)+l.SHEET_DATA_GAP,u=parseInt(e/l.CELL_SIZE)+l.SHEET_DATA_GAP,a=0,c=i.length=d;a<c;a++){for(s=0,n=(o=[]).length=u;s<n;s++)t={},r=s+1+"-"+(a+1),(r=l.cellInfoMap[r])&&(t.metadata={style:r.styleId},t.value=r.value||""),o[s]=t;i[a]=o}l.worksheet.setData(i),l.cellInfoMap={}}}),s}),O("Softin/XML/LinkBuilder",["underscore","../../Excel/Positioning","../../Excel/Drawings/Connector"],function(e,t,r){function n(e){e=e||{},this.from=e.from||null,this.to=e.to||null}return e.extend(n.prototype,{setRelations:function(e){this.relations=e},build:function(e,t){t=new r({isNotOrthogonal:e.IsNotOrthogonal,isLinkDecorator:e.IsLinkDecorator,from:t[e.From].shapeId,to:t[e.To].shapeId,fromPresetType:t[e.From].presetType,toPresetType:t[e.To].presetType,x:e.x,y:e.y,rotation:e.rotation,flipH:e.flipH,flipV:e.flipV,fill:e.LinkColor,fromPort:e.FromPort,toPort:e.ToPort,adjust:e.adjust,adjust2:e.adjust2,adjust3:e.adjust3,corner:e.LinkCorner,curve:e.curve,dash:e.LinkDashStyle,direction:e.direction,lnW:e.LinkBorder});return t.setTransform({offX:e.x,offY:e.y,extCx:e.width,extCy:e.height}),t.createAnchor("absoluteAnchor",{x:e.x+("down"===e.direction?this._ConnectorGap:0),y:e.y+("down"!==e.direction?this._ConnectorGap:0),width:e.width,height:e.height}),t},_ConnectorGap:t.pixelsToEMUs(20)}),n}),O("Softin/XML/UnitBuilder",["underscore","../util","../../excel-builder","../../Excel/Workbook","../../Excel/Positioning","../../Excel/Drawings/Group","../../Excel/Drawings/Picture","../../Excel/Drawings/PictureShape","../../Excel/Drawings/LineShape","../../Excel/Drawings/Shape"],function(e,d,t,r,n,u,i,c,p,f){function m(e){e=e||{},this.workbook=e.workbook||null,this.relations=e.relations||null,this.node=e.node||null,this.parent=e.parent||null}return e.extend(m.prototype,{setRelations:function(e){this.relations=e},setRelationshipId:function(e){var t,r=e.getMediaData(),n=e.getMediaType();(t=this.relations.getRelationshipId(r))||(t=this.relations.addRelation(r,n)),e.setRelationshipId(t)},allowType:function(e){return-1!==["Line","TextBlock","Image","Grid","List"].indexOf(e)},build:function(e,t){var r,n,i,o,a,s,l=this;if(t)(n=new f(null,t)).setTransform({offX:l.node.width/2,offY:l.node.height/2,extCx:36e3,extCy:36e3}),s=d.getCornerInfo(e.CornerRadius),n.setProps({backgroundColor:d.getHexColor("transparent"),borderColor:d.getHexColor("transparent"),borderWidth:19050,corner:5e4,dash:"solid"}),l.setRelationshipId(n);else if("TextBlock"===e.Type)(n=new f).setTransform({offX:e.Position.x,offY:e.Position.y,extCx:e.width,extCy:e.height}),s=d.getCornerInfo(e.CornerRadius),n.setProps({backgroundColor:e.Background,text:e.value,horizontalAlign:e.HorizontalAlignment,verticalAlign:e.VerticalAlignment,paddingTop:e.PaddingTop,paddingLeft:e.PaddingLeft,paddingRight:e.PaddingRight,paddingBottom:e.PaddingBottom,forceWrap:e.ForceWrap,fitText:e.FitText,allowPadForFitText:e.AllowPadForFitText,fitTextValue:e.FitTextValue,fitTextScale:e.FitTextScale,spacingTop:e.SpacingTop,spacingBottom:e.SpacingBottom,maxLines:e.MaxLines,fontFamily:e.FontFamily,fontSize:e.FontSize,fontBold:e.FontBold,fontColor:e.Foreground,corner:s.corner,cornerType:s.cornerType,presetType:s.presetType,dash:e.DashStyle,borderColor:e.BorderBrush,borderWidth:e.BorderThickness,opacity:e.Opacity}),l.setRelationshipId(n);else if("Line"===e.Type)(n=new p).setTransform({offX:e.Position.x,offY:e.Position.y,extCx:e.width,extCy:e.height}),n.setProps({borderColor:e.BorderBrush,borderWidth:e.BorderThickness,dash:e.DashStyle}),l.setRelationshipId(n);else if("Image"===e.Type)n=new c,i=l.workbook.media[d.getMediaId(e.value)],n.setMedia(i),n.setTransform({offX:e.Position.x,offY:e.Position.y,extCx:0<e.fillRectWRatio?Math.round(e.width*(e.fillRectWRatio/100)):e.width,extCy:0<e.fillRectHRatio?Math.round(e.height*(e.fillRectHRatio/100)):e.height}),s=d.getCornerInfo(e.CornerRadius),n.setProps({backgroundColor:e.Background,text:e.value,horizontalAlign:e.HorizontalAlignment,verticalAlign:e.VerticalAlignment,imageStretch:e.imageStretch,fillRectWRatio:e.fillRectWRatio,fillRectHRatio:e.fillRectHRatio,unitW:e.width,unitH:e.height,paddingTop:e.PaddingTop,paddingLeft:e.PaddingLeft,paddingRight:e.PaddingRight,paddingBottom:e.PaddingBottom,fontFamily:e.FontFamily,fontSize:e.FontSize,fontBold:e.FontBold,fontColor:e.Foreground,corner:s.corner,cornerType:s.cornerType,presetType:s.presetType,dash:e.DashStyle,borderColor:e.BorderBrush,borderWidth:e.BorderThickness,opacity:e.Opacity}),l.setRelationshipId(n);else if("Grid"===e.Type||"List"===e.Type){if(r=new u,(i=new f).setTransform({offX:e.Position.x,offY:e.Position.y,extCx:e.width,extCy:e.height}),s=d.getCornerInfo(e.CornerRadius),i.setProps({horizontalAlign:e.HorizontalAlignment,verticalAlign:e.VerticalAlignment,backgroundColor:e.Background,corner:s.corner,cornerType:s.cornerType,presetType:s.presetType,dash:e.DashStyle,borderColor:e.BorderBrush,borderWidth:e.BorderThickness}),r.addMember(i),e.units)for(o=0,a=e.units.length;o<a;o++){var h=new m({workbook:l.workbook,node:l.node});l.allowType(e.units[o].Type)&&(h.setRelations(l.relations),h=h.build(e.units[o]),r.addMember(h))}return l.setRelationshipId(i),r}return n}}),m}),O("Softin/XML/NodeBuilder",["underscore","../util","../../Excel/Positioning","../../Excel/Drawings/Group","../../Excel/Drawings/Shape","./UnitBuilder"],function(e,c,t,p,f,m){function r(e){e=e||{},this.workbook=e.workbook||null,this.relations=e.relations||null}return e.extend(r.prototype,{setRelations:function(e){this.relations=e},build:function(e,t,r){var n,i,o,a,s,l,h=this,d=new p({isShadowed:e.IsShadowed}),u=new f;for(u.setTransform({offX:0,offY:0,extCx:e.width,extCy:e.height}),a=c.getCornerInfo(e.CornerRadius),u.setProps({backgroundColor:e.Background,corner:a.corner,cornerType:a.cornerType,presetType:a.presetType,dash:e.DashStyle,borderColor:e.BorderBrush,borderWidth:e.BorderThickness}),d.addMember(u),n=0,i=e.units.length;n<i;n++)(s=new m({workbook:h.workbook,node:e})).allowType(e.units[n].Type)&&(s.setRelations(h.relations),o=null,(o=s.build(e.units[n]))&&d.addMember(o));return r&&((s=new m({workbook:h.workbook,node:e})).setRelations(h.relations),o=null,(o=s.build({},r))&&(l=o.shapeId,d.addMember(o))),d.createAnchor("absoluteAnchor",{x:e.Location.x+("down"===e.direction?h._GroupGap:0),y:e.Location.y+("down"!==e.direction?h._GroupGap:0),width:e.width,height:e.height}),t[e.NodeID]={shapeId:r?l:u.shapeId,presetType:u.props.presetType,group:d},d},_GroupGap:t.pixelsToEMUs(20)}),r}),O("Softin/XMLBuilder",["underscore","../Excel/util","../excel-builder","../Excel/Workbook","../Excel/Drawings","./XML/NodeBuilder","./XML/LinkBuilder","./XML/CellBuilder"],function(e,t,f,r,m,n,i,o){function a(e){0}return e.extend(a.prototype,{init:function(){this.workbook=new r,this.stylesheet=this.workbook.getStyleSheet(),this.worksheet=this.workbook.createWorksheet(),this.workbook.addWorksheet(this.worksheet),this.nodeBuilder=new n({workbook:this.workbook}),this.linkBuilder=new i,this.cellBuilder=new o({workbook:this.workbook,stylesheet:this.stylesheet,worksheet:this.worksheet})},clear:function(e){var t,r,n,i,o,a=this;for(t in a.workbook.media)(r=a.workbook.media[t]).contentType=null,r.data=null,r.fileName=null,r.id=null,r.rId=null,r=null,a.workbook.media[t]=null,delete a.workbook.media[t];if(e.images)for(t in e.images)e.images[t]=null,delete e.images[t];if(e.imageData)for(t in e.imageData)e.imageData[t]=null,delete e.imageData[t];if(e.nodes&&(e.nodes.length=0),e.links&&(e.links.length=0),a.workbook.drawings.length){if((o=a.workbook.drawings[0].drawings).length){for(n=0,i=o.length;n<i;n++)o[n]=null;o.length=0,o=null}var s,l=a.workbook.drawings[0].relations.relations;for(t in l)(s=l[t]).id=null,s.schema=null,s=null,l[t]=null,delete l[t]}},setImages:function(e){var t,r;for(r in e)t=e[r],e[r]="",this.workbook.addMedia("image",r,t.split(",")[1]),t=""},setSheetOptions:function(e){var t=this;t.worksheet.setExportType(e.exportType),t.worksheet.setPageOrientation(e.orientation),t.worksheet.setPaperSize(e.paperSize),t.worksheet.setPageFit(e.pageFit),t.worksheet.setPrintOptions({horizontalCentered:e.horizontalCentered,verticalCentered:e.verticalCentered}),t.worksheet.setGridLines(e.showGridLines),t.worksheet.setSheetView(e.sheetView),t.worksheet.setZoomScale(e.zoomScale),t.worksheet.setFormatPr(e),t.worksheet.setColBreak(e),t.worksheet.setRowBreak(e)},build:function(e,t){var r,n,i,o,a,s,l,h=[],d=[],u={},c=!1,p=this;if(p.init(),l=new m,p.nodeBuilder.setRelations(l.relations),r=e.nodes,n=e.links,nodeIds={},"cell"!==this.worksheet._exportType){for(p.setImages(e.images),n.length&&void 0!==n[0].IsNotOrthogonal&&!0===n[0].IsNotOrthogonal&&(c=!0),i=0,o=r.length;i<o;i++)h.push(p.nodeBuilder.build(e.nodes[i],nodeIds,c));for(i=0,o=n.length;i<o;i++)d.push(p.linkBuilder.build(e.links[i],nodeIds));for(i=0,o=d.length;i<o;i++)0===(s=d[i]).anchor.width&&(s.anchor.width=1,u[s.from]=s),l.addDrawing(s);for(i=0,o=h.length;i<o;i++)u[(a=h[i]).connectId]&&--a.anchor.x,l.addDrawing(a)}return p.setSheetOptions(t),"cell"===this.worksheet._exportType?p.cellBuilder.build(e,t):("cell&shape"===this.worksheet._exportType&&p.cellBuilder.build(e,t),p.worksheet.addDrawings(l),p.workbook.addDrawings(l)),t=f.createFile(p.workbook,{compression:t.deflate?"DEFLATE":"STORE"}),p.clear(e),t}}),a});var d=d||function(c){"use strict";if("undefined"==typeof navigator||!/MSIE [1-9]\./.test(navigator.userAgent)){var e=c.document,p=function(){return c.URL||c.webkitURL||c},f=e.createElementNS("http://www.w3.org/1999/xhtml","a"),m="download"in f,g=c.webkitRequestFileSystem,y=c.requestFileSystem||g||c.mozRequestFileSystem,b="application/octet-stream",x=0,C=function(e){function t(){"string"==typeof e?p().revokeObjectURL(e):e.remove()}c.chrome?t():setTimeout(t,500)},v=function(e,t,r){for(var n=(t=[].concat(t)).length;n--;){var i=e["on"+t[n]];if("function"==typeof i)try{i.call(e,r||e)}catch(e){!function(e){(c.setImmediate||c.setTimeout)(function(){throw e},0)}(e)}}},w=function(e){return/^\s*(?:text\/\S*|application\/xml|\S*\/\S*\+xml)\s*;.*charset\s*=\s*utf-8/i.test(e.type)?new Blob(["\ufeff",e],{type:e.type}):e},n=function(n,r,e){e||(n=w(n));function i(){v(h,"writestart progress write writeend".split(" "))}function o(){!d&&s||(s=p().createObjectURL(n)),l?l.location.href=s:null==c.open(s,"_blank")&&"undefined"!=typeof safari&&(c.location.href=s),h.readyState=h.DONE,i(),C(s)}function a(e){return function(){if(h.readyState!==h.DONE)return e.apply(this,arguments)}}var s,l,h=this,t=n.type,d=!1,u={create:!0,exclusive:!1};if(h.readyState=h.INIT,r=r||"download",m)return s=p().createObjectURL(n),f.href=s,f.download=r,void setTimeout(function(){var e,t;e=f,t=new MouseEvent("click"),e.dispatchEvent(t),i(),C(s),h.readyState=h.DONE});c.chrome&&t&&t!==b&&(e=n.slice||n.webkitSlice,n=e.call(n,0,n.size,b),d=!0),g&&"download"!==r&&(r+=".download"),t!==b&&!g||(l=c),y?(x+=n.size,y(c.TEMPORARY,x,a(function(e){e.root.getDirectory("saved",u,a(function(e){function t(){e.getFile(r,u,a(function(r){r.createWriter(a(function(t){t.onwriteend=function(e){l.location.href=r.toURL(),h.readyState=h.DONE,v(h,"writeend",e),C(r)},t.onerror=function(){var e=t.error;e.code!==e.ABORT_ERR&&o()},"writestart progress write abort".split(" ").forEach(function(e){t["on"+e]=h["on"+e]}),t.write(n),h.abort=function(){t.abort(),h.readyState=h.DONE},h.readyState=h.WRITING}),o)}),o)}e.getFile(r,{create:!1},a(function(e){e.remove(),t()}),a(function(e){(e.code===e.NOT_FOUND_ERR?t:o)()}))}),o)}),o)):o()},e=n.prototype;return"undefined"!=typeof navigator&&navigator.msSaveOrOpenBlob?function(e,t,r){return r||(e=w(e)),navigator.msSaveOrOpenBlob(e,t||"download")}:(e.abort=function(){this.readyState=this.DONE,v(this,"abort")},e.readyState=e.INIT=0,e.WRITING=1,e.DONE=2,e.error=e.onwritestart=e.onprogress=e.onwrite=e.onabort=e.onerror=e.onwriteend=null,function(e,t,r){return new n(e,t,r)})}}("undefined"!=typeof self&&self||"undefined"!=typeof window&&window||this.content);"undefined"!=typeof module&&module.exports?module.exports.saveAs=d:null!=O&&null!=O.amd&&O("FileSaver",[],function(){return d}),O("org2excel",["FileSaver","./Softin/util","./Softin/OrgParser","./Softin/XMLBuilder"],function(e,t,r,n){function i(e){this.parser=null,this.xmlBuilder=new n(e)}return _.extend(i.prototype,{version:"3.0.1.36-20220324-18",util:t,create:function(n){var i=this;n=n||{},this.parser=new r(n),i.parser.parse(n.data,function(e){var t=(t=n.prompt?prompt("  "):t)||(n.filename||"inorg"),r=i.xmlBuilder.build(e,n),e={filename:t+=".xlsx"};n.useBlob?e.blobData=r:d(r,t),n.callback&&n.callback(e)})}}),new i}),O("buildtools/index",["../Excel/Drawings","../Excel/Drawings/AbsoluteAnchor","../Excel/Drawings/Chart","../Excel/Drawings/Connector","../Excel/Drawings/Drawing","../Excel/Drawings/Group","../Excel/Drawings/LineShape","../Excel/Drawings/OneCellAnchor","../Excel/Drawings/Picture","../Excel/Drawings/PictureShape","../Excel/Drawings/Shape","../Excel/Drawings/TwoCellAnchor","../Excel/Paths","../Excel/Positioning","../Excel/RelationshipManager","../Excel/SharedStrings","../Excel/StyleSheet","../Excel/Table","../Excel/Workbook","../Excel/Worksheet","../Excel/XMLDOM","../Excel/ZipWorker","../Excel/util","../Softin/ImageLoader","../Softin/LinkDecoratorParser","../Softin/OrgParser","../Softin/Parser","../Softin/Property/ImageProperty","../Softin/Property/LinkProperty","../Softin/Property/NodeProperty","../Softin/Property/TextProperty","../Softin/Property/UnitProperty","../Softin/Util","../Softin/XML/CellBuilder","../Softin/XML/CellLinkBuilder","../Softin/XML/CellNodeBuilder","../Softin/XML/CellUnitBuilder","../Softin/XML/LinkBuilder","../Softin/XML/NodeBuilder","../Softin/XML/UnitBuilder","../Softin/XMLBuilder","../excel-builder","../org2excel"],function(){}),e.IBOrg2Excel=e.org2Excel=h("org2excel"),"function"==typeof window.define&&window.define.amd&&window.define("org2Excel",[],function(){return e.org2Excel})}(window);